{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/lib/db/indexed-db.ts"],"sourcesContent":["import { TrackMetadata, Playlist, ListeningEvent, DuplicateGroup } from '@/lib/types/music'\r\n\r\nconst DB_NAME = 'MusicLibraryDB'\r\nconst DB_VERSION = 1\r\n\r\nexport interface MusicDatabase extends IDBDatabase {\r\n  // Type-safe database interface\r\n}\r\n\r\nclass IndexedDBManager {\r\n  private db: IDBDatabase | null = null\r\n  private initPromise: Promise<void> | null = null\r\n\r\n  async initialize(): Promise<void> {\r\n    if (this.initPromise) {\r\n      return this.initPromise\r\n    }\r\n\r\n    this.initPromise = new Promise((resolve, reject) => {\r\n      const request = indexedDB.open(DB_NAME, DB_VERSION)\r\n\r\n      request.onerror = () => reject(request.error)\r\n      request.onsuccess = () => {\r\n        this.db = request.result\r\n        resolve()\r\n      }\r\n\r\n      request.onupgradeneeded = (event) => {\r\n        const db = (event.target as IDBOpenDBRequest).result\r\n\r\n        // Tracks store\r\n        if (!db.objectStoreNames.contains('tracks')) {\r\n          const tracksStore = db.createObjectStore('tracks', { keyPath: 'id' })\r\n          tracksStore.createIndex('artist', 'artist', { unique: false })\r\n          tracksStore.createIndex('album', 'album', { unique: false })\r\n          tracksStore.createIndex('genre', 'genre', { unique: false })\r\n          tracksStore.createIndex('year', 'year', { unique: false })\r\n          tracksStore.createIndex('fileHash', 'fileHash', { unique: false })\r\n          tracksStore.createIndex('dateAdded', 'dateAdded', { unique: false })\r\n          tracksStore.createIndex('playCount', 'playCount', { unique: false })\r\n        }\r\n\r\n        // Playlists store\r\n        if (!db.objectStoreNames.contains('playlists')) {\r\n          const playlistsStore = db.createObjectStore('playlists', { keyPath: 'id' })\r\n          playlistsStore.createIndex('type', 'type', { unique: false })\r\n          playlistsStore.createIndex('dateCreated', 'dateCreated', { unique: false })\r\n        }\r\n\r\n        // Listening events store\r\n        if (!db.objectStoreNames.contains('listeningEvents')) {\r\n          const eventsStore = db.createObjectStore('listeningEvents', { keyPath: 'id' })\r\n          eventsStore.createIndex('trackId', 'trackId', { unique: false })\r\n          eventsStore.createIndex('timestamp', 'timestamp', { unique: false })\r\n          eventsStore.createIndex('source', 'source', { unique: false })\r\n        }\r\n\r\n        // Duplicate groups store\r\n        if (!db.objectStoreNames.contains('duplicateGroups')) {\r\n          const duplicatesStore = db.createObjectStore('duplicateGroups', { keyPath: 'id' })\r\n          duplicatesStore.createIndex('resolved', 'resolved', { unique: false })\r\n          duplicatesStore.createIndex('duplicateType', 'duplicateType', { unique: false })\r\n        }\r\n\r\n        // Metadata cache store for search optimization\r\n        if (!db.objectStoreNames.contains('searchCache')) {\r\n          db.createObjectStore('searchCache', { keyPath: 'key' })\r\n        }\r\n      }\r\n    })\r\n\r\n    return this.initPromise\r\n  }\r\n\r\n  private ensureDB(): IDBDatabase {\r\n    if (!this.db) {\r\n      throw new Error('Database not initialized')\r\n    }\r\n    return this.db\r\n  }\r\n\r\n  // Tracks operations\r\n  async addTrack(track: TrackMetadata): Promise<void> {\r\n    const db = this.ensureDB()\r\n    const transaction = db.transaction(['tracks'], 'readwrite')\r\n    const store = transaction.objectStore('tracks')\r\n    \r\n    await new Promise<void>((resolve, reject) => {\r\n      const request = store.add(track)\r\n      request.onsuccess = () => resolve()\r\n      request.onerror = () => reject(request.error)\r\n    })\r\n  }\r\n\r\n  async updateTrack(track: TrackMetadata): Promise<void> {\r\n    const db = this.ensureDB()\r\n    const transaction = db.transaction(['tracks'], 'readwrite')\r\n    const store = transaction.objectStore('tracks')\r\n    \r\n    await new Promise<void>((resolve, reject) => {\r\n      const request = store.put(track)\r\n      request.onsuccess = () => resolve()\r\n      request.onerror = () => reject(request.error)\r\n    })\r\n  }\r\n\r\n  async getTrack(id: string): Promise<TrackMetadata | null> {\r\n    const db = this.ensureDB()\r\n    const transaction = db.transaction(['tracks'], 'readonly')\r\n    const store = transaction.objectStore('tracks')\r\n    \r\n    return new Promise((resolve, reject) => {\r\n      const request = store.get(id)\r\n      request.onsuccess = () => resolve(request.result || null)\r\n      request.onerror = () => reject(request.error)\r\n    })\r\n  }\r\n\r\n  async getAllTracks(): Promise<TrackMetadata[]> {\r\n    const db = this.ensureDB()\r\n    const transaction = db.transaction(['tracks'], 'readonly')\r\n    const store = transaction.objectStore('tracks')\r\n    \r\n    return new Promise((resolve, reject) => {\r\n      const request = store.getAll()\r\n      request.onsuccess = () => resolve(request.result)\r\n      request.onerror = () => reject(request.error)\r\n    })\r\n  }\r\n\r\n  async getTracksByIndex(indexName: string, value: any): Promise<TrackMetadata[]> {\r\n    const db = this.ensureDB()\r\n    const transaction = db.transaction(['tracks'], 'readonly')\r\n    const store = transaction.objectStore('tracks')\r\n    const index = store.index(indexName)\r\n    \r\n    return new Promise((resolve, reject) => {\r\n      const request = index.getAll(value)\r\n      request.onsuccess = () => resolve(request.result)\r\n      request.onerror = () => reject(request.error)\r\n    })\r\n  }\r\n\r\n  async deleteTrack(id: string): Promise<void> {\r\n    const db = this.ensureDB()\r\n    const transaction = db.transaction(['tracks'], 'readwrite')\r\n    const store = transaction.objectStore('tracks')\r\n    \r\n    await new Promise<void>((resolve, reject) => {\r\n      const request = store.delete(id)\r\n      request.onsuccess = () => resolve()\r\n      request.onerror = () => reject(request.error)\r\n    })\r\n  }\r\n\r\n  // Playlists operations\r\n  async addPlaylist(playlist: Playlist): Promise<void> {\r\n    const db = this.ensureDB()\r\n    const transaction = db.transaction(['playlists'], 'readwrite')\r\n    const store = transaction.objectStore('playlists')\r\n    \r\n    await new Promise<void>((resolve, reject) => {\r\n      const request = store.add(playlist)\r\n      request.onsuccess = () => resolve()\r\n      request.onerror = () => reject(request.error)\r\n    })\r\n  }\r\n\r\n  async updatePlaylist(playlist: Playlist): Promise<void> {\r\n    const db = this.ensureDB()\r\n    const transaction = db.transaction(['playlists'], 'readwrite')\r\n    const store = transaction.objectStore('playlists')\r\n    \r\n    await new Promise<void>((resolve, reject) => {\r\n      const request = store.put(playlist)\r\n      request.onsuccess = () => resolve()\r\n      request.onerror = () => reject(request.error)\r\n    })\r\n  }\r\n\r\n  async getAllPlaylists(): Promise<Playlist[]> {\r\n    const db = this.ensureDB()\r\n    const transaction = db.transaction(['playlists'], 'readonly')\r\n    const store = transaction.objectStore('playlists')\r\n    \r\n    return new Promise((resolve, reject) => {\r\n      const request = store.getAll()\r\n      request.onsuccess = () => resolve(request.result)\r\n      request.onerror = () => reject(request.error)\r\n    })\r\n  }\r\n\r\n  async deletePlaylist(id: string): Promise<void> {\r\n    const db = this.ensureDB()\r\n    const transaction = db.transaction(['playlists'], 'readwrite')\r\n    const store = transaction.objectStore('playlists')\r\n    \r\n    await new Promise<void>((resolve, reject) => {\r\n      const request = store.delete(id)\r\n      request.onsuccess = () => resolve()\r\n      request.onerror = () => reject(request.error)\r\n    })\r\n  }\r\n\r\n  // Listening events operations\r\n  async addListeningEvent(event: ListeningEvent): Promise<void> {\r\n    const db = this.ensureDB()\r\n    const transaction = db.transaction(['listeningEvents'], 'readwrite')\r\n    const store = transaction.objectStore('listeningEvents')\r\n    \r\n    await new Promise<void>((resolve, reject) => {\r\n      const request = store.add(event)\r\n      request.onsuccess = () => resolve()\r\n      request.onerror = () => reject(request.error)\r\n    })\r\n  }\r\n\r\n  async getListeningEvents(trackId?: string, limit?: number): Promise<ListeningEvent[]> {\r\n    const db = this.ensureDB()\r\n    const transaction = db.transaction(['listeningEvents'], 'readonly')\r\n    const store = transaction.objectStore('listeningEvents')\r\n    \r\n    return new Promise((resolve, reject) => {\r\n      let request: IDBRequest\r\n      \r\n      if (trackId) {\r\n        const index = store.index('trackId')\r\n        request = index.getAll(trackId)\r\n      } else {\r\n        request = store.getAll()\r\n      }\r\n      \r\n      request.onsuccess = () => {\r\n        let result = request.result\r\n        if (limit) {\r\n          result = result.slice(-limit) // Get most recent events\r\n        }\r\n        resolve(result)\r\n      }\r\n      request.onerror = () => reject(request.error)\r\n    })\r\n  }\r\n\r\n  // Duplicate groups operations\r\n  async addDuplicateGroup(group: DuplicateGroup): Promise<void> {\r\n    const db = this.ensureDB()\r\n    const transaction = db.transaction(['duplicateGroups'], 'readwrite')\r\n    const store = transaction.objectStore('duplicateGroups')\r\n    \r\n    await new Promise<void>((resolve, reject) => {\r\n      const request = store.add(group)\r\n      request.onsuccess = () => resolve()\r\n      request.onerror = () => reject(request.error)\r\n    })\r\n  }\r\n\r\n  async updateDuplicateGroup(group: DuplicateGroup): Promise<void> {\r\n    const db = this.ensureDB()\r\n    const transaction = db.transaction(['duplicateGroups'], 'readwrite')\r\n    const store = transaction.objectStore('duplicateGroups')\r\n    \r\n    await new Promise<void>((resolve, reject) => {\r\n      const request = store.put(group)\r\n      request.onsuccess = () => resolve()\r\n      request.onerror = () => reject(request.error)\r\n    })\r\n  }\r\n\r\n  async getAllDuplicateGroups(): Promise<DuplicateGroup[]> {\r\n    const db = this.ensureDB()\r\n    const transaction = db.transaction(['duplicateGroups'], 'readonly')\r\n    const store = transaction.objectStore('duplicateGroups')\r\n    \r\n    return new Promise((resolve, reject) => {\r\n      const request = store.getAll()\r\n      request.onsuccess = () => resolve(request.result)\r\n      request.onerror = () => reject(request.error)\r\n    })\r\n  }\r\n\r\n  // Cache operations for search optimization\r\n  async setCache(key: string, value: any): Promise<void> {\r\n    const db = this.ensureDB()\r\n    const transaction = db.transaction(['searchCache'], 'readwrite')\r\n    const store = transaction.objectStore('searchCache')\r\n    \r\n    await new Promise<void>((resolve, reject) => {\r\n      const request = store.put({ key, value, timestamp: Date.now() })\r\n      request.onsuccess = () => resolve()\r\n      request.onerror = () => reject(request.error)\r\n    })\r\n  }\r\n\r\n  async getCache(key: string): Promise<any> {\r\n    const db = this.ensureDB()\r\n    const transaction = db.transaction(['searchCache'], 'readonly')\r\n    const store = transaction.objectStore('searchCache')\r\n    \r\n    return new Promise((resolve, reject) => {\r\n      const request = store.get(key)\r\n      request.onsuccess = () => {\r\n        const result = request.result\r\n        if (result && Date.now() - result.timestamp < 300000) { // 5 minute cache\r\n          resolve(result.value)\r\n        } else {\r\n          resolve(null)\r\n        }\r\n      }\r\n      request.onerror = () => reject(request.error)\r\n    })\r\n  }\r\n}\r\n\r\nexport const dbManager = new IndexedDBManager()"],"names":[],"mappings":"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"}},
    {"offset": {"line": 350, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/lib/services/search-service.ts"],"sourcesContent":["import Fuse, { IFuseOptions } from 'fuse.js'\r\nimport { TrackMetadata, ViewState } from '@/lib/types/music'\r\n\r\nclass SearchService {\r\n  private fuse: Fuse<TrackMetadata> | null = null\r\n  private tracks: TrackMetadata[] = []\r\n\r\n  private fuseOptions: IFuseOptions<TrackMetadata> = {\r\n    keys: [\r\n      { name: 'title', weight: 0.3 },\r\n      { name: 'artist', weight: 0.25 },\r\n      { name: 'album', weight: 0.2 },\r\n      { name: 'genre', weight: 0.1 },\r\n      { name: 'customTags', weight: 0.1 },\r\n      { name: 'mood', weight: 0.05 },\r\n    ],\r\n    threshold: 0.4, // Lower = more strict matching\r\n    includeScore: true,\r\n    includeMatches: true,\r\n    minMatchCharLength: 2,\r\n  }\r\n\r\n  initialize(tracks: TrackMetadata[]): void {\r\n    this.tracks = tracks\r\n    this.fuse = new Fuse(tracks, this.fuseOptions)\r\n  }\r\n\r\n  addTracks(newTracks: TrackMetadata[]): void {\r\n    this.tracks = [...this.tracks, ...newTracks]\r\n    this.fuse = new Fuse(this.tracks, this.fuseOptions)\r\n  }\r\n\r\n  updateTrack(updatedTrack: TrackMetadata): void {\r\n    const index = this.tracks.findIndex(track => track.id === updatedTrack.id)\r\n    if (index !== -1) {\r\n      this.tracks[index] = updatedTrack\r\n      this.fuse = new Fuse(this.tracks, this.fuseOptions)\r\n    }\r\n  }\r\n\r\n  removeTrack(trackId: string): void {\r\n    this.tracks = this.tracks.filter(track => track.id !== trackId)\r\n    this.fuse = new Fuse(this.tracks, this.fuseOptions)\r\n  }\r\n\r\n  search(query: string, filters: ViewState['filters'] = {}): TrackMetadata[] {\r\n    if (!this.fuse) {\r\n      return []\r\n    }\r\n\r\n    let results: TrackMetadata[]\r\n\r\n    // Perform fuzzy search\r\n    if (query.trim()) {\r\n      const fuseResults = this.fuse.search(query)\r\n      results = fuseResults.map(result => result.item)\r\n    } else {\r\n      results = [...this.tracks]\r\n    }\r\n\r\n    // Apply filters\r\n    results = this.applyFilters(results, filters)\r\n\r\n    return results\r\n  }\r\n\r\n  private applyFilters(tracks: TrackMetadata[], filters: ViewState['filters']): TrackMetadata[] {\r\n    return tracks.filter(track => {\r\n      // Genre filter\r\n      if (filters.genre && track.genre !== filters.genre) {\r\n        return false\r\n      }\r\n\r\n      // Artist filter\r\n      if (filters.artist && track.artist !== filters.artist) {\r\n        return false\r\n      }\r\n\r\n      // Album filter\r\n      if (filters.album && track.album !== filters.album) {\r\n        return false\r\n      }\r\n\r\n      // Year filter\r\n      if (filters.year && track.year !== filters.year) {\r\n        return false\r\n      }\r\n\r\n      // Rating filter\r\n      if (filters.rating && track.rating !== filters.rating) {\r\n        return false\r\n      }\r\n\r\n      return true\r\n    })\r\n  }\r\n\r\n  // Advanced search with compound queries\r\n  advancedSearch(searchParams: {\r\n    title?: string\r\n    artist?: string\r\n    album?: string\r\n    genre?: string\r\n    yearRange?: [number, number]\r\n    ratingRange?: [number, number]\r\n    playCountRange?: [number, number]\r\n    customTags?: string[]\r\n    mood?: string\r\n  }): TrackMetadata[] {\r\n    return this.tracks.filter(track => {\r\n      // Title search\r\n      if (searchParams.title && !track.title.toLowerCase().includes(searchParams.title.toLowerCase())) {\r\n        return false\r\n      }\r\n\r\n      // Artist search\r\n      if (searchParams.artist && !track.artist.toLowerCase().includes(searchParams.artist.toLowerCase())) {\r\n        return false\r\n      }\r\n\r\n      // Album search\r\n      if (searchParams.album && !track.album.toLowerCase().includes(searchParams.album.toLowerCase())) {\r\n        return false\r\n      }\r\n\r\n      // Genre search\r\n      if (searchParams.genre && track.genre !== searchParams.genre) {\r\n        return false\r\n      }\r\n\r\n      // Year range\r\n      if (searchParams.yearRange && track.year) {\r\n        const [minYear, maxYear] = searchParams.yearRange\r\n        if (track.year < minYear || track.year > maxYear) {\r\n          return false\r\n        }\r\n      }\r\n\r\n      // Rating range\r\n      if (searchParams.ratingRange && track.rating) {\r\n        const [minRating, maxRating] = searchParams.ratingRange\r\n        if (track.rating < minRating || track.rating > maxRating) {\r\n          return false\r\n        }\r\n      }\r\n\r\n      // Play count range\r\n      if (searchParams.playCountRange) {\r\n        const [minCount, maxCount] = searchParams.playCountRange\r\n        if (track.playCount < minCount || track.playCount > maxCount) {\r\n          return false\r\n        }\r\n      }\r\n\r\n      // Custom tags\r\n      if (searchParams.customTags && searchParams.customTags.length > 0) {\r\n        const hasAllTags = searchParams.customTags.every(tag =>\r\n          track.customTags.some(trackTag => trackTag.toLowerCase().includes(tag.toLowerCase()))\r\n        )\r\n        if (!hasAllTags) {\r\n          return false\r\n        }\r\n      }\r\n\r\n      // Mood\r\n      if (searchParams.mood && track.mood !== searchParams.mood) {\r\n        return false\r\n      }\r\n\r\n      return true\r\n    })\r\n  }\r\n\r\n  // Get suggestions for autocomplete\r\n  getSuggestions(field: keyof TrackMetadata, query: string, limit = 10): string[] {\r\n    const values = new Set<string>()\r\n    \r\n    this.tracks.forEach(track => {\r\n      const value = track[field]\r\n      if (typeof value === 'string' && value.toLowerCase().includes(query.toLowerCase())) {\r\n        values.add(value)\r\n      } else if (Array.isArray(value)) {\r\n        value.forEach(item => {\r\n          if (typeof item === 'string' && item.toLowerCase().includes(query.toLowerCase())) {\r\n            values.add(item)\r\n          }\r\n        })\r\n      }\r\n    })\r\n\r\n    return Array.from(values).slice(0, limit).sort()\r\n  }\r\n\r\n  // Get unique values for filter dropdowns\r\n  getUniqueValues(field: keyof TrackMetadata): string[] {\r\n    const values = new Set<string>()\r\n    \r\n    this.tracks.forEach(track => {\r\n      const value = track[field]\r\n      if (typeof value === 'string' && value) {\r\n        values.add(value)\r\n      } else if (Array.isArray(value)) {\r\n        value.forEach(item => {\r\n          if (typeof item === 'string' && item) {\r\n            values.add(item)\r\n          }\r\n        })\r\n      }\r\n    })\r\n\r\n    return Array.from(values).sort()\r\n  }\r\n\r\n  // Search within specific playlist\r\n  searchInPlaylist(query: string, trackIds: string[]): TrackMetadata[] {\r\n    const playlistTracks = this.tracks.filter(track => trackIds.includes(track.id))\r\n    \r\n    if (!query.trim()) {\r\n      return playlistTracks\r\n    }\r\n\r\n    const playlistFuse = new Fuse(playlistTracks, this.fuseOptions)\r\n    const results = playlistFuse.search(query)\r\n    return results.map(result => result.item)\r\n  }\r\n}\r\n\r\nexport const searchService = new SearchService()"],"names":[],"mappings":"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"}},
    {"offset": {"line": 563, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/lib/services/duplicate-detection-service.ts"],"sourcesContent":["import { TrackMetadata, DuplicateGroup } from '@/lib/types/music'\r\n\r\nclass DuplicateDetectionService {\r\n  // Detect exact duplicates by file hash\r\n  private detectExactDuplicates(tracks: TrackMetadata[]): DuplicateGroup[] {\r\n    const hashGroups = new Map<string, TrackMetadata[]>()\r\n    \r\n    tracks.forEach(track => {\r\n      // Skip tracks without fileHash\r\n      if (!track.fileHash) return\r\n      \r\n      const existing = hashGroups.get(track.fileHash) || []\r\n      existing.push(track)\r\n      hashGroups.set(track.fileHash, existing)\r\n    })\r\n    \r\n    const duplicateGroups: DuplicateGroup[] = []\r\n    \r\n    hashGroups.forEach((groupTracks, hash) => {\r\n      if (groupTracks.length > 1) {\r\n        duplicateGroups.push({\r\n          id: crypto.randomUUID(),\r\n          trackIds: groupTracks.map(t => t.id),\r\n          similarityScore: 1.0,\r\n          duplicateType: 'exact',\r\n          resolved: false,\r\n        })\r\n      }\r\n    })\r\n    \r\n    return duplicateGroups\r\n  }\r\n\r\n  // Detect metadata-based duplicates\r\n  private detectMetadataDuplicates(tracks: TrackMetadata[]): DuplicateGroup[] {\r\n    const duplicateGroups: DuplicateGroup[] = []\r\n    const processed = new Set<string>()\r\n    \r\n    for (let i = 0; i < tracks.length; i++) {\r\n      if (processed.has(tracks[i].id)) continue\r\n      \r\n      const currentTrack = tracks[i]\r\n      const similarTracks = [currentTrack]\r\n      processed.add(currentTrack.id)\r\n      \r\n      for (let j = i + 1; j < tracks.length; j++) {\r\n        if (processed.has(tracks[j].id)) continue\r\n        \r\n        const compareTrack = tracks[j]\r\n        const similarity = this.calculateMetadataSimilarity(currentTrack, compareTrack)\r\n        \r\n        if (similarity >= 0.9) {\r\n          similarTracks.push(compareTrack)\r\n          processed.add(compareTrack.id)\r\n        }\r\n      }\r\n      \r\n      if (similarTracks.length > 1) {\r\n        duplicateGroups.push({\r\n          id: crypto.randomUUID(),\r\n          trackIds: similarTracks.map(t => t.id),\r\n          similarityScore: this.calculateGroupSimilarity(similarTracks),\r\n          duplicateType: 'metadata',\r\n          resolved: false,\r\n        })\r\n      }\r\n    }\r\n    \r\n    return duplicateGroups\r\n  }\r\n\r\n  // Detect duration-based duplicates (same duration, similar metadata)\r\n  private detectDurationDuplicates(tracks: TrackMetadata[]): DuplicateGroup[] {\r\n    const duplicateGroups: DuplicateGroup[] = []\r\n    const processed = new Set<string>()\r\n    \r\n    for (let i = 0; i < tracks.length; i++) {\r\n      if (processed.has(tracks[i].id)) continue\r\n      \r\n      const currentTrack = tracks[i]\r\n      const similarTracks = [currentTrack]\r\n      processed.add(currentTrack.id)\r\n      \r\n      for (let j = i + 1; j < tracks.length; j++) {\r\n        if (processed.has(tracks[j].id)) continue\r\n        \r\n        const compareTrack = tracks[j]\r\n        \r\n        // Check if durations are very close (within 2 seconds)\r\n        const durationDiff = Math.abs(currentTrack.duration - compareTrack.duration)\r\n        if (durationDiff <= 2) {\r\n          const metadataSimilarity = this.calculateMetadataSimilarity(currentTrack, compareTrack)\r\n          \r\n          if (metadataSimilarity >= 0.7) {\r\n            similarTracks.push(compareTrack)\r\n            processed.add(compareTrack.id)\r\n          }\r\n        }\r\n      }\r\n      \r\n      if (similarTracks.length > 1) {\r\n        duplicateGroups.push({\r\n          id: crypto.randomUUID(),\r\n          trackIds: similarTracks.map(t => t.id),\r\n          similarityScore: this.calculateGroupSimilarity(similarTracks),\r\n          duplicateType: 'duration',\r\n          resolved: false,\r\n        })\r\n      }\r\n    }\r\n    \r\n    return duplicateGroups\r\n  }\r\n\r\n  // Detect fuzzy duplicates using Levenshtein distance\r\n  private detectFuzzyDuplicates(tracks: TrackMetadata[]): DuplicateGroup[] {\r\n    const duplicateGroups: DuplicateGroup[] = []\r\n    const processed = new Set<string>()\r\n    \r\n    for (let i = 0; i < tracks.length; i++) {\r\n      if (processed.has(tracks[i].id)) continue\r\n      \r\n      const currentTrack = tracks[i]\r\n      const similarTracks = [currentTrack]\r\n      processed.add(currentTrack.id)\r\n      \r\n      for (let j = i + 1; j < tracks.length; j++) {\r\n        if (processed.has(tracks[j].id)) continue\r\n        \r\n        const compareTrack = tracks[j]\r\n        const similarity = this.calculateFuzzySimilarity(currentTrack, compareTrack)\r\n        \r\n        if (similarity >= 0.8) {\r\n          similarTracks.push(compareTrack)\r\n          processed.add(compareTrack.id)\r\n        }\r\n      }\r\n      \r\n      if (similarTracks.length > 1) {\r\n        duplicateGroups.push({\r\n          id: crypto.randomUUID(),\r\n          trackIds: similarTracks.map(t => t.id),\r\n          similarityScore: this.calculateGroupSimilarity(similarTracks),\r\n          duplicateType: 'fuzzy',\r\n          resolved: false,\r\n        })\r\n      }\r\n    }\r\n    \r\n    return duplicateGroups\r\n  }\r\n\r\n  // Calculate metadata similarity between two tracks\r\n  private calculateMetadataSimilarity(track1: TrackMetadata, track2: TrackMetadata): number {\r\n    let score = 0\r\n    let factors = 0\r\n    \r\n    // Title similarity (most important)\r\n    if (this.normalizeString(track1.title) === this.normalizeString(track2.title)) {\r\n      score += 0.4\r\n    }\r\n    factors += 0.4\r\n    \r\n    // Artist similarity\r\n    if (this.normalizeString(track1.artist) === this.normalizeString(track2.artist)) {\r\n      score += 0.3\r\n    }\r\n    factors += 0.3\r\n    \r\n    // Album similarity\r\n    if (this.normalizeString(track1.album) === this.normalizeString(track2.album)) {\r\n      score += 0.2\r\n    }\r\n    factors += 0.2\r\n    \r\n    // Duration similarity (within 5 seconds)\r\n    const durationDiff = Math.abs(track1.duration - track2.duration)\r\n    if (durationDiff <= 5) {\r\n      score += 0.1\r\n    }\r\n    factors += 0.1\r\n    \r\n    return factors > 0 ? score / factors : 0\r\n  }\r\n\r\n  // Calculate fuzzy similarity using Levenshtein distance\r\n  private calculateFuzzySimilarity(track1: TrackMetadata, track2: TrackMetadata): number {\r\n    const titleSim = this.levenshteinSimilarity(\r\n      this.normalizeString(track1.title),\r\n      this.normalizeString(track2.title)\r\n    )\r\n    \r\n    const artistSim = this.levenshteinSimilarity(\r\n      this.normalizeString(track1.artist),\r\n      this.normalizeString(track2.artist)\r\n    )\r\n    \r\n    const albumSim = this.levenshteinSimilarity(\r\n      this.normalizeString(track1.album),\r\n      this.normalizeString(track2.album)\r\n    )\r\n    \r\n    // Weighted average\r\n    return (titleSim * 0.5 + artistSim * 0.3 + albumSim * 0.2)\r\n  }\r\n\r\n  // Calculate overall similarity for a group of tracks\r\n  private calculateGroupSimilarity(tracks: TrackMetadata[]): number {\r\n    if (tracks.length < 2) return 1.0\r\n    \r\n    let totalSimilarity = 0\r\n    let comparisons = 0\r\n    \r\n    for (let i = 0; i < tracks.length; i++) {\r\n      for (let j = i + 1; j < tracks.length; j++) {\r\n        totalSimilarity += this.calculateMetadataSimilarity(tracks[i], tracks[j])\r\n        comparisons++\r\n      }\r\n    }\r\n    \r\n    return comparisons > 0 ? totalSimilarity / comparisons : 0\r\n  }\r\n\r\n  // Normalize string for comparison\r\n  private normalizeString(str: string): string {\r\n    return str\r\n      .toLowerCase()\r\n      .trim()\r\n      .replace(/[^\\w\\s]/g, '') // Remove special characters\r\n      .replace(/\\s+/g, ' ') // Normalize whitespace\r\n  }\r\n\r\n  // Calculate Levenshtein similarity (0-1 scale)\r\n  private levenshteinSimilarity(str1: string, str2: string): number {\r\n    const distance = this.levenshteinDistance(str1, str2)\r\n    const maxLength = Math.max(str1.length, str2.length)\r\n    return maxLength === 0 ? 1 : 1 - (distance / maxLength)\r\n  }\r\n\r\n  // Calculate Levenshtein distance\r\n  private levenshteinDistance(str1: string, str2: string): number {\r\n    const matrix = Array(str2.length + 1).fill(null).map(() => Array(str1.length + 1).fill(null))\r\n    \r\n    for (let i = 0; i <= str1.length; i++) {\r\n      matrix[0][i] = i\r\n    }\r\n    \r\n    for (let j = 0; j <= str2.length; j++) {\r\n      matrix[j][0] = j\r\n    }\r\n    \r\n    for (let j = 1; j <= str2.length; j++) {\r\n      for (let i = 1; i <= str1.length; i++) {\r\n        const indicator = str1[i - 1] === str2[j - 1] ? 0 : 1\r\n        matrix[j][i] = Math.min(\r\n          matrix[j][i - 1] + 1, // deletion\r\n          matrix[j - 1][i] + 1, // insertion\r\n          matrix[j - 1][i - 1] + indicator // substitution\r\n        )\r\n      }\r\n    }\r\n    \r\n    return matrix[str2.length][str1.length]\r\n  }\r\n\r\n  // Main duplicate detection method\r\n  async detectDuplicates(tracks: TrackMetadata[]): Promise<DuplicateGroup[]> {\r\n    // Safety check\r\n    if (!tracks || tracks.length === 0) {\r\n      return []\r\n    }\r\n    \r\n    const allDuplicates: DuplicateGroup[] = []\r\n    \r\n    try {\r\n      // Detect different types of duplicates\r\n      const exactDuplicates = this.detectExactDuplicates(tracks)\r\n      const metadataDuplicates = this.detectMetadataDuplicates(tracks)\r\n      const durationDuplicates = this.detectDurationDuplicates(tracks)\r\n      const fuzzyDuplicates = this.detectFuzzyDuplicates(tracks)\r\n      \r\n      allDuplicates.push(...exactDuplicates)\r\n      allDuplicates.push(...metadataDuplicates)\r\n      allDuplicates.push(...durationDuplicates)\r\n      allDuplicates.push(...fuzzyDuplicates)\r\n      \r\n      // Remove overlapping groups (prefer higher similarity scores)\r\n      return this.deduplicateGroups(allDuplicates)\r\n    } catch (error) {\r\n      console.error('Error during duplicate detection:', error)\r\n      return []\r\n    }\r\n  }\r\n\r\n  // Remove overlapping duplicate groups\r\n  private deduplicateGroups(groups: DuplicateGroup[]): DuplicateGroup[] {\r\n    const sortedGroups = groups.sort((a, b) => b.similarityScore - a.similarityScore)\r\n    const usedTrackIds = new Set<string>()\r\n    const finalGroups: DuplicateGroup[] = []\r\n    \r\n    for (const group of sortedGroups) {\r\n      const hasOverlap = group.trackIds.some(id => usedTrackIds.has(id))\r\n      \r\n      if (!hasOverlap) {\r\n        finalGroups.push(group)\r\n        group.trackIds.forEach(id => usedTrackIds.add(id))\r\n      }\r\n    }\r\n    \r\n    return finalGroups\r\n  }\r\n\r\n  // Get recommended action for a duplicate group\r\n  getRecommendedAction(group: DuplicateGroup, tracks: TrackMetadata[]): {\r\n    action: 'keep_highest_quality' | 'keep_most_played' | 'keep_newest' | 'manual_review'\r\n    recommendedTrackId?: string\r\n    reason: string\r\n  } {\r\n    // Safety checks\r\n    if (!group || !tracks || tracks.length === 0) {\r\n      return {\r\n        action: 'manual_review',\r\n        reason: 'Invalid group or tracks data'\r\n      }\r\n    }\r\n    \r\n    const groupTracks = tracks.filter(t => t && group.trackIds && group.trackIds.includes(t.id))\r\n    \r\n    if (groupTracks.length === 0) {\r\n      return {\r\n        action: 'manual_review',\r\n        reason: 'No valid tracks found in group'\r\n      }\r\n    }\r\n    \r\n    if (group.duplicateType === 'exact') {\r\n      // For exact duplicates, keep the highest quality version\r\n      const highestQuality = groupTracks.reduce((best, current) => {\r\n        const bestBitrate = best.bitrate || 0\r\n        const currentBitrate = current.bitrate || 0\r\n        return currentBitrate > bestBitrate ? current : best\r\n      })\r\n      \r\n      return {\r\n        action: 'keep_highest_quality',\r\n        recommendedTrackId: highestQuality.id,\r\n        reason: `Keep highest quality version (${highestQuality.bitrate || 'unknown'} kbps)`\r\n      }\r\n    }\r\n    \r\n    if (group.similarityScore >= 0.95) {\r\n      // For very similar tracks, keep the most played one\r\n      const mostPlayed = groupTracks.reduce((best, current) => \r\n        current.playCount > best.playCount ? current : best\r\n      )\r\n      \r\n      if (mostPlayed.playCount > 0) {\r\n        return {\r\n          action: 'keep_most_played',\r\n          recommendedTrackId: mostPlayed.id,\r\n          reason: `Keep most played version (${mostPlayed.playCount} plays)`\r\n        }\r\n      }\r\n      \r\n      // If no plays, keep the newest\r\n      const newest = groupTracks.reduce((best, current) => \r\n        current.dateAdded > best.dateAdded ? current : best\r\n      )\r\n      \r\n      return {\r\n        action: 'keep_newest',\r\n        recommendedTrackId: newest.id,\r\n        reason: 'Keep most recently added version'\r\n      }\r\n    }\r\n    \r\n    return {\r\n      action: 'manual_review',\r\n      reason: 'Similarity too low for automatic resolution'\r\n    }\r\n  }\r\n}\r\n\r\nexport const duplicateDetectionService = new DuplicateDetectionService()"],"names":[],"mappings":";;;;AAEA,MAAM;IACJ,uCAAuC;IAC/B,sBAAsB,MAAuB,EAAoB;QACvE,MAAM,aAAa,IAAI;QAEvB,OAAO,OAAO,CAAC,CAAA;YACb,+BAA+B;YAC/B,IAAI,CAAC,MAAM,QAAQ,EAAE;YAErB,MAAM,WAAW,WAAW,GAAG,CAAC,MAAM,QAAQ,KAAK,EAAE;YACrD,SAAS,IAAI,CAAC;YACd,WAAW,GAAG,CAAC,MAAM,QAAQ,EAAE;QACjC;QAEA,MAAM,kBAAoC,EAAE;QAE5C,WAAW,OAAO,CAAC,CAAC,aAAa;YAC/B,IAAI,YAAY,MAAM,GAAG,GAAG;gBAC1B,gBAAgB,IAAI,CAAC;oBACnB,IAAI,OAAO,UAAU;oBACrB,UAAU,YAAY,GAAG,CAAC,CAAA,IAAK,EAAE,EAAE;oBACnC,iBAAiB;oBACjB,eAAe;oBACf,UAAU;gBACZ;YACF;QACF;QAEA,OAAO;IACT;IAEA,mCAAmC;IAC3B,yBAAyB,MAAuB,EAAoB;QAC1E,MAAM,kBAAoC,EAAE;QAC5C,MAAM,YAAY,IAAI;QAEtB,IAAK,IAAI,IAAI,GAAG,IAAI,OAAO,MAAM,EAAE,IAAK;YACtC,IAAI,UAAU,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE,GAAG;YAEjC,MAAM,eAAe,MAAM,CAAC,EAAE;YAC9B,MAAM,gBAAgB;gBAAC;aAAa;YACpC,UAAU,GAAG,CAAC,aAAa,EAAE;YAE7B,IAAK,IAAI,IAAI,IAAI,GAAG,IAAI,OAAO,MAAM,EAAE,IAAK;gBAC1C,IAAI,UAAU,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE,GAAG;gBAEjC,MAAM,eAAe,MAAM,CAAC,EAAE;gBAC9B,MAAM,aAAa,IAAI,CAAC,2BAA2B,CAAC,cAAc;gBAElE,IAAI,cAAc,KAAK;oBACrB,cAAc,IAAI,CAAC;oBACnB,UAAU,GAAG,CAAC,aAAa,EAAE;gBAC/B;YACF;YAEA,IAAI,cAAc,MAAM,GAAG,GAAG;gBAC5B,gBAAgB,IAAI,CAAC;oBACnB,IAAI,OAAO,UAAU;oBACrB,UAAU,cAAc,GAAG,CAAC,CAAA,IAAK,EAAE,EAAE;oBACrC,iBAAiB,IAAI,CAAC,wBAAwB,CAAC;oBAC/C,eAAe;oBACf,UAAU;gBACZ;YACF;QACF;QAEA,OAAO;IACT;IAEA,qEAAqE;IAC7D,yBAAyB,MAAuB,EAAoB;QAC1E,MAAM,kBAAoC,EAAE;QAC5C,MAAM,YAAY,IAAI;QAEtB,IAAK,IAAI,IAAI,GAAG,IAAI,OAAO,MAAM,EAAE,IAAK;YACtC,IAAI,UAAU,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE,GAAG;YAEjC,MAAM,eAAe,MAAM,CAAC,EAAE;YAC9B,MAAM,gBAAgB;gBAAC;aAAa;YACpC,UAAU,GAAG,CAAC,aAAa,EAAE;YAE7B,IAAK,IAAI,IAAI,IAAI,GAAG,IAAI,OAAO,MAAM,EAAE,IAAK;gBAC1C,IAAI,UAAU,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE,GAAG;gBAEjC,MAAM,eAAe,MAAM,CAAC,EAAE;gBAE9B,uDAAuD;gBACvD,MAAM,eAAe,KAAK,GAAG,CAAC,aAAa,QAAQ,GAAG,aAAa,QAAQ;gBAC3E,IAAI,gBAAgB,GAAG;oBACrB,MAAM,qBAAqB,IAAI,CAAC,2BAA2B,CAAC,cAAc;oBAE1E,IAAI,sBAAsB,KAAK;wBAC7B,cAAc,IAAI,CAAC;wBACnB,UAAU,GAAG,CAAC,aAAa,EAAE;oBAC/B;gBACF;YACF;YAEA,IAAI,cAAc,MAAM,GAAG,GAAG;gBAC5B,gBAAgB,IAAI,CAAC;oBACnB,IAAI,OAAO,UAAU;oBACrB,UAAU,cAAc,GAAG,CAAC,CAAA,IAAK,EAAE,EAAE;oBACrC,iBAAiB,IAAI,CAAC,wBAAwB,CAAC;oBAC/C,eAAe;oBACf,UAAU;gBACZ;YACF;QACF;QAEA,OAAO;IACT;IAEA,qDAAqD;IAC7C,sBAAsB,MAAuB,EAAoB;QACvE,MAAM,kBAAoC,EAAE;QAC5C,MAAM,YAAY,IAAI;QAEtB,IAAK,IAAI,IAAI,GAAG,IAAI,OAAO,MAAM,EAAE,IAAK;YACtC,IAAI,UAAU,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE,GAAG;YAEjC,MAAM,eAAe,MAAM,CAAC,EAAE;YAC9B,MAAM,gBAAgB;gBAAC;aAAa;YACpC,UAAU,GAAG,CAAC,aAAa,EAAE;YAE7B,IAAK,IAAI,IAAI,IAAI,GAAG,IAAI,OAAO,MAAM,EAAE,IAAK;gBAC1C,IAAI,UAAU,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE,GAAG;gBAEjC,MAAM,eAAe,MAAM,CAAC,EAAE;gBAC9B,MAAM,aAAa,IAAI,CAAC,wBAAwB,CAAC,cAAc;gBAE/D,IAAI,cAAc,KAAK;oBACrB,cAAc,IAAI,CAAC;oBACnB,UAAU,GAAG,CAAC,aAAa,EAAE;gBAC/B;YACF;YAEA,IAAI,cAAc,MAAM,GAAG,GAAG;gBAC5B,gBAAgB,IAAI,CAAC;oBACnB,IAAI,OAAO,UAAU;oBACrB,UAAU,cAAc,GAAG,CAAC,CAAA,IAAK,EAAE,EAAE;oBACrC,iBAAiB,IAAI,CAAC,wBAAwB,CAAC;oBAC/C,eAAe;oBACf,UAAU;gBACZ;YACF;QACF;QAEA,OAAO;IACT;IAEA,mDAAmD;IAC3C,4BAA4B,MAAqB,EAAE,MAAqB,EAAU;QACxF,IAAI,QAAQ;QACZ,IAAI,UAAU;QAEd,oCAAoC;QACpC,IAAI,IAAI,CAAC,eAAe,CAAC,OAAO,KAAK,MAAM,IAAI,CAAC,eAAe,CAAC,OAAO,KAAK,GAAG;YAC7E,SAAS;QACX;QACA,WAAW;QAEX,oBAAoB;QACpB,IAAI,IAAI,CAAC,eAAe,CAAC,OAAO,MAAM,MAAM,IAAI,CAAC,eAAe,CAAC,OAAO,MAAM,GAAG;YAC/E,SAAS;QACX;QACA,WAAW;QAEX,mBAAmB;QACnB,IAAI,IAAI,CAAC,eAAe,CAAC,OAAO,KAAK,MAAM,IAAI,CAAC,eAAe,CAAC,OAAO,KAAK,GAAG;YAC7E,SAAS;QACX;QACA,WAAW;QAEX,yCAAyC;QACzC,MAAM,eAAe,KAAK,GAAG,CAAC,OAAO,QAAQ,GAAG,OAAO,QAAQ;QAC/D,IAAI,gBAAgB,GAAG;YACrB,SAAS;QACX;QACA,WAAW;QAEX,OAAO,UAAU,IAAI,QAAQ,UAAU;IACzC;IAEA,wDAAwD;IAChD,yBAAyB,MAAqB,EAAE,MAAqB,EAAU;QACrF,MAAM,WAAW,IAAI,CAAC,qBAAqB,CACzC,IAAI,CAAC,eAAe,CAAC,OAAO,KAAK,GACjC,IAAI,CAAC,eAAe,CAAC,OAAO,KAAK;QAGnC,MAAM,YAAY,IAAI,CAAC,qBAAqB,CAC1C,IAAI,CAAC,eAAe,CAAC,OAAO,MAAM,GAClC,IAAI,CAAC,eAAe,CAAC,OAAO,MAAM;QAGpC,MAAM,WAAW,IAAI,CAAC,qBAAqB,CACzC,IAAI,CAAC,eAAe,CAAC,OAAO,KAAK,GACjC,IAAI,CAAC,eAAe,CAAC,OAAO,KAAK;QAGnC,mBAAmB;QACnB,OAAQ,WAAW,MAAM,YAAY,MAAM,WAAW;IACxD;IAEA,qDAAqD;IAC7C,yBAAyB,MAAuB,EAAU;QAChE,IAAI,OAAO,MAAM,GAAG,GAAG,OAAO;QAE9B,IAAI,kBAAkB;QACtB,IAAI,cAAc;QAElB,IAAK,IAAI,IAAI,GAAG,IAAI,OAAO,MAAM,EAAE,IAAK;YACtC,IAAK,IAAI,IAAI,IAAI,GAAG,IAAI,OAAO,MAAM,EAAE,IAAK;gBAC1C,mBAAmB,IAAI,CAAC,2BAA2B,CAAC,MAAM,CAAC,EAAE,EAAE,MAAM,CAAC,EAAE;gBACxE;YACF;QACF;QAEA,OAAO,cAAc,IAAI,kBAAkB,cAAc;IAC3D;IAEA,kCAAkC;IAC1B,gBAAgB,GAAW,EAAU;QAC3C,OAAO,IACJ,WAAW,GACX,IAAI,GACJ,OAAO,CAAC,YAAY,IAAI,4BAA4B;SACpD,OAAO,CAAC,QAAQ,KAAK,uBAAuB;;IACjD;IAEA,+CAA+C;IACvC,sBAAsB,IAAY,EAAE,IAAY,EAAU;QAChE,MAAM,WAAW,IAAI,CAAC,mBAAmB,CAAC,MAAM;QAChD,MAAM,YAAY,KAAK,GAAG,CAAC,KAAK,MAAM,EAAE,KAAK,MAAM;QACnD,OAAO,cAAc,IAAI,IAAI,IAAK,WAAW;IAC/C;IAEA,iCAAiC;IACzB,oBAAoB,IAAY,EAAE,IAAY,EAAU;QAC9D,MAAM,SAAS,MAAM,KAAK,MAAM,GAAG,GAAG,IAAI,CAAC,MAAM,GAAG,CAAC,IAAM,MAAM,KAAK,MAAM,GAAG,GAAG,IAAI,CAAC;QAEvF,IAAK,IAAI,IAAI,GAAG,KAAK,KAAK,MAAM,EAAE,IAAK;YACrC,MAAM,CAAC,EAAE,CAAC,EAAE,GAAG;QACjB;QAEA,IAAK,IAAI,IAAI,GAAG,KAAK,KAAK,MAAM,EAAE,IAAK;YACrC,MAAM,CAAC,EAAE,CAAC,EAAE,GAAG;QACjB;QAEA,IAAK,IAAI,IAAI,GAAG,KAAK,KAAK,MAAM,EAAE,IAAK;YACrC,IAAK,IAAI,IAAI,GAAG,KAAK,KAAK,MAAM,EAAE,IAAK;gBACrC,MAAM,YAAY,IAAI,CAAC,IAAI,EAAE,KAAK,IAAI,CAAC,IAAI,EAAE,GAAG,IAAI;gBACpD,MAAM,CAAC,EAAE,CAAC,EAAE,GAAG,KAAK,GAAG,CACrB,MAAM,CAAC,EAAE,CAAC,IAAI,EAAE,GAAG,GACnB,MAAM,CAAC,IAAI,EAAE,CAAC,EAAE,GAAG,GACnB,MAAM,CAAC,IAAI,EAAE,CAAC,IAAI,EAAE,GAAG,UAAU,eAAe;;YAEpD;QACF;QAEA,OAAO,MAAM,CAAC,KAAK,MAAM,CAAC,CAAC,KAAK,MAAM,CAAC;IACzC;IAEA,kCAAkC;IAClC,MAAM,iBAAiB,MAAuB,EAA6B;QACzE,eAAe;QACf,IAAI,CAAC,UAAU,OAAO,MAAM,KAAK,GAAG;YAClC,OAAO,EAAE;QACX;QAEA,MAAM,gBAAkC,EAAE;QAE1C,IAAI;YACF,uCAAuC;YACvC,MAAM,kBAAkB,IAAI,CAAC,qBAAqB,CAAC;YACnD,MAAM,qBAAqB,IAAI,CAAC,wBAAwB,CAAC;YACzD,MAAM,qBAAqB,IAAI,CAAC,wBAAwB,CAAC;YACzD,MAAM,kBAAkB,IAAI,CAAC,qBAAqB,CAAC;YAEnD,cAAc,IAAI,IAAI;YACtB,cAAc,IAAI,IAAI;YACtB,cAAc,IAAI,IAAI;YACtB,cAAc,IAAI,IAAI;YAEtB,8DAA8D;YAC9D,OAAO,IAAI,CAAC,iBAAiB,CAAC;QAChC,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,qCAAqC;YACnD,OAAO,EAAE;QACX;IACF;IAEA,sCAAsC;IAC9B,kBAAkB,MAAwB,EAAoB;QACpE,MAAM,eAAe,OAAO,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,eAAe,GAAG,EAAE,eAAe;QAChF,MAAM,eAAe,IAAI;QACzB,MAAM,cAAgC,EAAE;QAExC,KAAK,MAAM,SAAS,aAAc;YAChC,MAAM,aAAa,MAAM,QAAQ,CAAC,IAAI,CAAC,CAAA,KAAM,aAAa,GAAG,CAAC;YAE9D,IAAI,CAAC,YAAY;gBACf,YAAY,IAAI,CAAC;gBACjB,MAAM,QAAQ,CAAC,OAAO,CAAC,CAAA,KAAM,aAAa,GAAG,CAAC;YAChD;QACF;QAEA,OAAO;IACT;IAEA,+CAA+C;IAC/C,qBAAqB,KAAqB,EAAE,MAAuB,EAIjE;QACA,gBAAgB;QAChB,IAAI,CAAC,SAAS,CAAC,UAAU,OAAO,MAAM,KAAK,GAAG;YAC5C,OAAO;gBACL,QAAQ;gBACR,QAAQ;YACV;QACF;QAEA,MAAM,cAAc,OAAO,MAAM,CAAC,CAAA,IAAK,KAAK,MAAM,QAAQ,IAAI,MAAM,QAAQ,CAAC,QAAQ,CAAC,EAAE,EAAE;QAE1F,IAAI,YAAY,MAAM,KAAK,GAAG;YAC5B,OAAO;gBACL,QAAQ;gBACR,QAAQ;YACV;QACF;QAEA,IAAI,MAAM,aAAa,KAAK,SAAS;YACnC,yDAAyD;YACzD,MAAM,iBAAiB,YAAY,MAAM,CAAC,CAAC,MAAM;gBAC/C,MAAM,cAAc,KAAK,OAAO,IAAI;gBACpC,MAAM,iBAAiB,QAAQ,OAAO,IAAI;gBAC1C,OAAO,iBAAiB,cAAc,UAAU;YAClD;YAEA,OAAO;gBACL,QAAQ;gBACR,oBAAoB,eAAe,EAAE;gBACrC,QAAQ,CAAC,8BAA8B,EAAE,eAAe,OAAO,IAAI,UAAU,MAAM,CAAC;YACtF;QACF;QAEA,IAAI,MAAM,eAAe,IAAI,MAAM;YACjC,oDAAoD;YACpD,MAAM,aAAa,YAAY,MAAM,CAAC,CAAC,MAAM,UAC3C,QAAQ,SAAS,GAAG,KAAK,SAAS,GAAG,UAAU;YAGjD,IAAI,WAAW,SAAS,GAAG,GAAG;gBAC5B,OAAO;oBACL,QAAQ;oBACR,oBAAoB,WAAW,EAAE;oBACjC,QAAQ,CAAC,0BAA0B,EAAE,WAAW,SAAS,CAAC,OAAO,CAAC;gBACpE;YACF;YAEA,+BAA+B;YAC/B,MAAM,SAAS,YAAY,MAAM,CAAC,CAAC,MAAM,UACvC,QAAQ,SAAS,GAAG,KAAK,SAAS,GAAG,UAAU;YAGjD,OAAO;gBACL,QAAQ;gBACR,oBAAoB,OAAO,EAAE;gBAC7B,QAAQ;YACV;QACF;QAEA,OAAO;YACL,QAAQ;YACR,QAAQ;QACV;IACF;AACF;AAEO,MAAM,4BAA4B,IAAI"}},
    {"offset": {"line": 869, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/lib/services/playlist-service.ts"],"sourcesContent":["import { TrackMetadata, Playlist, PlaylistRule } from '@/lib/types/music'\r\n\r\nclass PlaylistService {\r\n  // Create or update tag-based playlists automatically\r\n  async createTagBasedPlaylists(\r\n    allTracks: TrackMetadata[],\r\n    existingPlaylists: Playlist[]\r\n  ): Promise<Playlist[]> {\r\n    // Get all unique tags from tracks\r\n    const allTags = new Set<string>()\r\n    allTracks.forEach(track => {\r\n      track.customTags.forEach(tag => allTags.add(tag))\r\n    })\r\n\r\n    const tagBasedPlaylists: Playlist[] = []\r\n\r\n    // Create or update playlist for each tag\r\n    for (const tag of allTags) {\r\n      const playlistName = ` ${tag}`\r\n      \r\n      // Check if tag-based playlist already exists\r\n      let existingPlaylist = existingPlaylists.find(p => \r\n        p.name === playlistName && p.type === 'smart'\r\n      )\r\n\r\n      // Get tracks with this tag\r\n      const tracksWithTag = allTracks\r\n        .filter(track => track.customTags.includes(tag))\r\n        .map(track => track.id)\r\n\r\n      if (existingPlaylist) {\r\n        // Update existing playlist\r\n        const updatedPlaylist: Playlist = {\r\n          ...existingPlaylist,\r\n          trackIds: tracksWithTag,\r\n          dateModified: new Date(),\r\n          rules: [{\r\n            field: 'customTags',\r\n            operator: 'contains',\r\n            value: tag\r\n          }]\r\n        }\r\n        tagBasedPlaylists.push(updatedPlaylist)\r\n      } else {\r\n        // Create new tag-based playlist\r\n        const newPlaylist: Playlist = {\r\n          id: crypto.randomUUID(),\r\n          name: playlistName,\r\n          description: `Automatically generated playlist for tracks tagged with \"${tag}\"`,\r\n          type: 'smart',\r\n          rules: [{\r\n            field: 'customTags',\r\n            operator: 'contains',\r\n            value: tag\r\n          }],\r\n          trackIds: tracksWithTag,\r\n          dateCreated: new Date(),\r\n          dateModified: new Date(),\r\n          sortBy: 'dateAdded',\r\n          sortOrder: 'desc'\r\n        }\r\n        tagBasedPlaylists.push(newPlaylist)\r\n      }\r\n    }\r\n\r\n    return tagBasedPlaylists\r\n  }\r\n\r\n  // Clean up tag-based playlists that no longer have corresponding tags\r\n  cleanupOrphanedTagPlaylists(\r\n    allTracks: TrackMetadata[],\r\n    existingPlaylists: Playlist[]\r\n  ): string[] {\r\n    // Get all current tags\r\n    const currentTags = new Set<string>()\r\n    allTracks.forEach(track => {\r\n      track.customTags.forEach(tag => currentTags.add(tag))\r\n    })\r\n\r\n    // Find tag-based playlists that no longer have corresponding tags\r\n    const orphanedPlaylistIds: string[] = []\r\n    \r\n    existingPlaylists.forEach(playlist => {\r\n      if (this.isTagBasedPlaylist(playlist)) {\r\n        const tag = this.getTagFromPlaylist(playlist)\r\n        if (tag && !currentTags.has(tag)) {\r\n          orphanedPlaylistIds.push(playlist.id)\r\n        }\r\n      }\r\n    })\r\n\r\n    return orphanedPlaylistIds\r\n  }\r\n\r\n  // Check if a playlist is tag-based\r\n  isTagBasedPlaylist(playlist: Playlist): boolean {\r\n    return playlist.name.startsWith(' ') && playlist.type === 'smart'\r\n  }\r\n\r\n  // Get the tag name from a tag-based playlist\r\n  getTagFromPlaylist(playlist: Playlist): string | null {\r\n    if (this.isTagBasedPlaylist(playlist)) {\r\n      return playlist.name.substring(3).trim() // Remove \" \" prefix and trim whitespace\r\n    }\r\n    return null\r\n  }\r\n  // Evaluate smart playlist rules and return matching tracks\r\n  evaluateSmartPlaylist(playlist: Playlist, allTracks: TrackMetadata[]): string[] {\r\n    if (playlist.type !== 'smart' || playlist.rules.length === 0) {\r\n      return playlist.trackIds\r\n    }\r\n\r\n    let matchingTracks = allTracks\r\n\r\n    // Apply each rule (AND logic between rules)\r\n    for (const rule of playlist.rules) {\r\n      matchingTracks = this.applyRule(matchingTracks, rule)\r\n    }\r\n\r\n    // Sort tracks according to playlist settings\r\n    matchingTracks = this.sortTracks(matchingTracks, playlist.sortBy, playlist.sortOrder)\r\n\r\n    return matchingTracks.map(track => track.id)\r\n  }\r\n\r\n  // Apply a single rule to filter tracks\r\n  private applyRule(tracks: TrackMetadata[], rule: PlaylistRule): TrackMetadata[] {\r\n    return tracks.filter(track => {\r\n      const fieldValue = this.getFieldValue(track, rule.field)\r\n      return this.evaluateCondition(fieldValue, rule.operator, rule.value)\r\n    })\r\n  }\r\n\r\n  // Get field value from track\r\n  private getFieldValue(track: TrackMetadata, field: PlaylistRule['field']): any {\r\n    switch (field) {\r\n      case 'genre':\r\n        return track.genre || ''\r\n      case 'artist':\r\n        return track.artist\r\n      case 'album':\r\n        return track.album\r\n      case 'year':\r\n        return track.year || 0\r\n      case 'rating':\r\n        return track.rating || 0\r\n      case 'playCount':\r\n        return track.playCount\r\n      case 'dateAdded':\r\n        return track.dateAdded\r\n      case 'customTags':\r\n        return track.customTags\r\n      case 'mood':\r\n        return track.mood || ''\r\n      default:\r\n        return null\r\n    }\r\n  }\r\n\r\n  // Evaluate condition based on operator\r\n  private evaluateCondition(fieldValue: any, operator: PlaylistRule['operator'], ruleValue: any): boolean {\r\n    switch (operator) {\r\n      case 'equals':\r\n        return fieldValue === ruleValue\r\n      \r\n      case 'contains':\r\n        if (typeof fieldValue === 'string' && typeof ruleValue === 'string') {\r\n          return fieldValue.toLowerCase().includes(ruleValue.toLowerCase())\r\n        }\r\n        if (Array.isArray(fieldValue) && typeof ruleValue === 'string') {\r\n          return fieldValue.some(item => \r\n            typeof item === 'string' && item.toLowerCase().includes(ruleValue.toLowerCase())\r\n          )\r\n        }\r\n        return false\r\n      \r\n      case 'startsWith':\r\n        if (typeof fieldValue === 'string' && typeof ruleValue === 'string') {\r\n          return fieldValue.toLowerCase().startsWith(ruleValue.toLowerCase())\r\n        }\r\n        return false\r\n      \r\n      case 'endsWith':\r\n        if (typeof fieldValue === 'string' && typeof ruleValue === 'string') {\r\n          return fieldValue.toLowerCase().endsWith(ruleValue.toLowerCase())\r\n        }\r\n        return false\r\n      \r\n      case 'greaterThan':\r\n        if (typeof fieldValue === 'number' && typeof ruleValue === 'number') {\r\n          return fieldValue > ruleValue\r\n        }\r\n        if (fieldValue instanceof Date && typeof ruleValue === 'number') {\r\n          return fieldValue.getTime() > ruleValue\r\n        }\r\n        if (fieldValue instanceof Date && ruleValue instanceof Date) {\r\n          return fieldValue > ruleValue\r\n        }\r\n        return false\r\n      \r\n      case 'lessThan':\r\n        if (typeof fieldValue === 'number' && typeof ruleValue === 'number') {\r\n          return fieldValue < ruleValue\r\n        }\r\n        if (fieldValue instanceof Date && typeof ruleValue === 'number') {\r\n          return fieldValue.getTime() < ruleValue\r\n        }\r\n        if (fieldValue instanceof Date && ruleValue instanceof Date) {\r\n          return fieldValue < ruleValue\r\n        }\r\n        return false\r\n      \r\n      case 'between':\r\n        if (Array.isArray(ruleValue) && ruleValue.length === 2) {\r\n          const [min, max] = ruleValue\r\n          if (typeof fieldValue === 'number') {\r\n            return fieldValue >= min && fieldValue <= max\r\n          }\r\n          if (fieldValue instanceof Date) {\r\n            const timestamp = fieldValue.getTime()\r\n            return timestamp >= min && timestamp <= max\r\n          }\r\n        }\r\n        return false\r\n      \r\n      case 'in':\r\n        if (Array.isArray(ruleValue)) {\r\n          return ruleValue.includes(fieldValue)\r\n        }\r\n        return false\r\n      \r\n      default:\r\n        return false\r\n    }\r\n  }\r\n\r\n  // Sort tracks based on criteria\r\n  private sortTracks(\r\n    tracks: TrackMetadata[], \r\n    sortBy: Playlist['sortBy'], \r\n    sortOrder: Playlist['sortOrder']\r\n  ): TrackMetadata[] {\r\n    const sorted = [...tracks].sort((a, b) => {\r\n      let aValue: any\r\n      let bValue: any\r\n\r\n      switch (sortBy) {\r\n        case 'title':\r\n          aValue = a.title.toLowerCase()\r\n          bValue = b.title.toLowerCase()\r\n          break\r\n        case 'artist':\r\n          aValue = a.artist.toLowerCase()\r\n          bValue = b.artist.toLowerCase()\r\n          break\r\n        case 'album':\r\n          aValue = a.album.toLowerCase()\r\n          bValue = b.album.toLowerCase()\r\n          break\r\n        case 'dateAdded':\r\n          aValue = a.dateAdded\r\n          bValue = b.dateAdded\r\n          break\r\n        case 'playCount':\r\n          aValue = a.playCount\r\n          bValue = b.playCount\r\n          break\r\n        case 'rating':\r\n          aValue = a.rating || 0\r\n          bValue = b.rating || 0\r\n          break\r\n        case 'duration':\r\n          aValue = a.duration\r\n          bValue = b.duration\r\n          break\r\n        default:\r\n          return 0\r\n      }\r\n\r\n      if (aValue < bValue) return sortOrder === 'asc' ? -1 : 1\r\n      if (aValue > bValue) return sortOrder === 'asc' ? 1 : -1\r\n      return 0\r\n    })\r\n\r\n    return sorted\r\n  }\r\n\r\n  // Generate dynamic playlist based on listening behavior\r\n  generateDynamicPlaylist(\r\n    allTracks: TrackMetadata[],\r\n    type: 'recently_played' | 'most_played' | 'recently_added' | 'highly_rated' | 'discover_weekly',\r\n    limit = 50\r\n  ): string[] {\r\n    let tracks: TrackMetadata[]\r\n\r\n    switch (type) {\r\n      case 'recently_played':\r\n        tracks = allTracks\r\n          .filter(track => track.lastPlayed)\r\n          .sort((a, b) => {\r\n            const aTime = a.lastPlayed?.getTime() || 0\r\n            const bTime = b.lastPlayed?.getTime() || 0\r\n            return bTime - aTime\r\n          })\r\n          .slice(0, limit)\r\n        break\r\n\r\n      case 'most_played':\r\n        tracks = allTracks\r\n          .filter(track => track.playCount > 0)\r\n          .sort((a, b) => b.playCount - a.playCount)\r\n          .slice(0, limit)\r\n        break\r\n\r\n      case 'recently_added':\r\n        tracks = allTracks\r\n          .sort((a, b) => b.dateAdded.getTime() - a.dateAdded.getTime())\r\n          .slice(0, limit)\r\n        break\r\n\r\n      case 'highly_rated':\r\n        tracks = allTracks\r\n          .filter(track => track.rating && track.rating >= 4)\r\n          .sort((a, b) => (b.rating || 0) - (a.rating || 0))\r\n          .slice(0, limit)\r\n        break\r\n\r\n      case 'discover_weekly':\r\n        // Generate discovery playlist based on listening patterns\r\n        tracks = this.generateDiscoveryPlaylist(allTracks, limit)\r\n        break\r\n\r\n      default:\r\n        tracks = []\r\n    }\r\n\r\n    return tracks.map(track => track.id)\r\n  }\r\n\r\n  // Generate discovery playlist using similarity and listening patterns\r\n  private generateDiscoveryPlaylist(allTracks: TrackMetadata[], limit: number): TrackMetadata[] {\r\n    // Get user's most played genres and artists\r\n    const genrePlayCounts = new Map<string, number>()\r\n    const artistPlayCounts = new Map<string, number>()\r\n\r\n    allTracks.forEach(track => {\r\n      if (track.genre) {\r\n        genrePlayCounts.set(track.genre, (genrePlayCounts.get(track.genre) || 0) + track.playCount)\r\n      }\r\n      artistPlayCounts.set(track.artist, (artistPlayCounts.get(track.artist) || 0) + track.playCount)\r\n    })\r\n\r\n    // Get top genres and artists\r\n    const topGenres = Array.from(genrePlayCounts.entries())\r\n      .sort(([, a], [, b]) => b - a)\r\n      .slice(0, 5)\r\n      .map(([genre]) => genre)\r\n\r\n    const topArtists = Array.from(artistPlayCounts.entries())\r\n      .sort(([, a], [, b]) => b - a)\r\n      .slice(0, 10)\r\n      .map(([artist]) => artist)\r\n\r\n    // Find tracks that match user preferences but haven't been played much\r\n    const discoveryTracks = allTracks.filter(track => {\r\n      // Skip heavily played tracks\r\n      if (track.playCount > 5) return false\r\n\r\n      // Include tracks from favorite genres\r\n      if (track.genre && topGenres.includes(track.genre)) return true\r\n\r\n      // Include tracks from favorite artists (but not overplayed)\r\n      if (topArtists.includes(track.artist) && track.playCount < 3) return true\r\n\r\n      // Include highly rated but underplayed tracks\r\n      if (track.rating && track.rating >= 4 && track.playCount < 2) return true\r\n\r\n      return false\r\n    })\r\n\r\n    // Sort by potential interest (combination of rating, genre preference, and freshness)\r\n    discoveryTracks.sort((a, b) => {\r\n      let aScore = 0\r\n      let bScore = 0\r\n\r\n      // Genre preference score\r\n      if (a.genre && topGenres.includes(a.genre)) {\r\n        aScore += topGenres.indexOf(a.genre) * 10\r\n      }\r\n      if (b.genre && topGenres.includes(b.genre)) {\r\n        bScore += topGenres.indexOf(b.genre) * 10\r\n      }\r\n\r\n      // Rating score\r\n      aScore += (a.rating || 0) * 5\r\n      bScore += (b.rating || 0) * 5\r\n\r\n      // Freshness score (newer tracks get bonus)\r\n      const now = Date.now()\r\n      const aAge = now - a.dateAdded.getTime()\r\n      const bAge = now - b.dateAdded.getTime()\r\n      const maxAge = 30 * 24 * 60 * 60 * 1000 // 30 days\r\n\r\n      if (aAge < maxAge) aScore += (maxAge - aAge) / maxAge * 10\r\n      if (bAge < maxAge) bScore += (maxAge - bAge) / maxAge * 10\r\n\r\n      return bScore - aScore\r\n    })\r\n\r\n    return discoveryTracks.slice(0, limit)\r\n  }\r\n\r\n  // Create playlist from similar tracks\r\n  createSimilarTracksPlaylist(\r\n    seedTrack: TrackMetadata,\r\n    allTracks: TrackMetadata[],\r\n    limit = 25\r\n  ): string[] {\r\n    const similarTracks = allTracks\r\n      .filter(track => track.id !== seedTrack.id)\r\n      .map(track => ({\r\n        track,\r\n        similarity: this.calculateTrackSimilarity(seedTrack, track)\r\n      }))\r\n      .filter(({ similarity }) => similarity > 0.3)\r\n      .sort((a, b) => b.similarity - a.similarity)\r\n      .slice(0, limit)\r\n      .map(({ track }) => track)\r\n\r\n    return similarTracks.map(track => track.id)\r\n  }\r\n\r\n  // Calculate similarity between two tracks\r\n  private calculateTrackSimilarity(track1: TrackMetadata, track2: TrackMetadata): number {\r\n    let similarity = 0\r\n    let factors = 0\r\n\r\n    // Genre similarity\r\n    if (track1.genre && track2.genre) {\r\n      similarity += track1.genre === track2.genre ? 0.3 : 0\r\n      factors += 0.3\r\n    }\r\n\r\n    // Artist similarity\r\n    similarity += track1.artist === track2.artist ? 0.4 : 0\r\n    factors += 0.4\r\n\r\n    // Album similarity\r\n    similarity += track1.album === track2.album ? 0.2 : 0\r\n    factors += 0.2\r\n\r\n    // Duration similarity (within 30 seconds)\r\n    const durationDiff = Math.abs(track1.duration - track2.duration)\r\n    if (durationDiff <= 30) {\r\n      similarity += 0.1\r\n    }\r\n    factors += 0.1\r\n\r\n    return factors > 0 ? similarity / factors : 0\r\n  }\r\n\r\n  // Validate playlist rules\r\n  validatePlaylistRules(rules: PlaylistRule[]): { isValid: boolean; errors: string[] } {\r\n    const errors: string[] = []\r\n\r\n    rules.forEach((rule, index) => {\r\n      // Check if field and operator combination is valid\r\n      if (rule.field === 'dateAdded' && !['greaterThan', 'lessThan', 'between'].includes(rule.operator)) {\r\n        errors.push(`Rule ${index + 1}: Date fields only support date comparison operators`)\r\n      }\r\n\r\n      if (['playCount', 'rating', 'year'].includes(rule.field) && \r\n          !['equals', 'greaterThan', 'lessThan', 'between', 'in'].includes(rule.operator)) {\r\n        errors.push(`Rule ${index + 1}: Numeric fields don't support text operators`)\r\n      }\r\n\r\n      // Check if value type matches field type\r\n      if (rule.operator === 'between' && !Array.isArray(rule.value)) {\r\n        errors.push(`Rule ${index + 1}: 'between' operator requires an array of two values`)\r\n      }\r\n\r\n      if (rule.operator === 'in' && !Array.isArray(rule.value)) {\r\n        errors.push(`Rule ${index + 1}: 'in' operator requires an array of values`)\r\n      }\r\n    })\r\n\r\n    return {\r\n      isValid: errors.length === 0,\r\n      errors\r\n    }\r\n  }\r\n\r\n  // Get suggested rules based on user's library\r\n  getSuggestedRules(allTracks: TrackMetadata[]): PlaylistRule[] {\r\n    const suggestions: PlaylistRule[] = []\r\n\r\n    // Most common genres\r\n    const genreCounts = new Map<string, number>()\r\n    allTracks.forEach(track => {\r\n      if (track.genre) {\r\n        genreCounts.set(track.genre, (genreCounts.get(track.genre) || 0) + 1)\r\n      }\r\n    })\r\n\r\n    const topGenres = Array.from(genreCounts.entries())\r\n      .sort(([, a], [, b]) => b - a)\r\n      .slice(0, 3)\r\n      .map(([genre]) => genre)\r\n\r\n    topGenres.forEach(genre => {\r\n      suggestions.push({\r\n        field: 'genre',\r\n        operator: 'equals',\r\n        value: genre\r\n      })\r\n    })\r\n\r\n    // High-rated tracks\r\n    const hasRatedTracks = allTracks.some(track => track.rating && track.rating > 0)\r\n    if (hasRatedTracks) {\r\n      suggestions.push({\r\n        field: 'rating',\r\n        operator: 'greaterThan',\r\n        value: 3\r\n      })\r\n    }\r\n\r\n    // Recently added\r\n    suggestions.push({\r\n      field: 'dateAdded',\r\n      operator: 'greaterThan',\r\n      value: Date.now() - 30 * 24 * 60 * 60 * 1000 // Last 30 days as timestamp\r\n    })\r\n\r\n    // Frequently played\r\n    const hasPlayCounts = allTracks.some(track => track.playCount > 0)\r\n    if (hasPlayCounts) {\r\n      suggestions.push({\r\n        field: 'playCount',\r\n        operator: 'greaterThan',\r\n        value: 2\r\n      })\r\n    }\r\n\r\n    return suggestions\r\n  }\r\n}\r\n\r\nexport const playlistService = new PlaylistService()"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1320, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/lib/services/analytics-service.ts"],"sourcesContent":["import { TrackMetadata, ListeningEvent, LibraryStats } from '@/lib/types/music'\r\nimport { format, startOfDay, startOfWeek, startOfMonth, subDays, subWeeks, subMonths } from 'date-fns'\r\n\r\nexport interface GenreDistribution {\r\n  genre: string\r\n  count: number\r\n  percentage: number\r\n  totalDuration: number\r\n}\r\n\r\nexport interface ArtistStats {\r\n  artist: string\r\n  trackCount: number\r\n  totalPlayCount: number\r\n  totalDuration: number\r\n  averageRating: number\r\n}\r\n\r\nexport interface ListeningPattern {\r\n  hour: number\r\n  playCount: number\r\n  averageDuration: number\r\n}\r\n\r\nexport interface LibraryGrowth {\r\n  date: string\r\n  totalTracks: number\r\n  tracksAdded: number\r\n}\r\n\r\nexport interface PlaybackStats {\r\n  totalPlayTime: number\r\n  averageSessionLength: number\r\n  skipRate: number\r\n  completionRate: number\r\n  mostPlayedHour: number\r\n}\r\n\r\nclass AnalyticsService {\r\n  // Calculate basic library statistics\r\n  calculateLibraryStats(tracks: TrackMetadata[]): LibraryStats {\r\n    if (tracks.length === 0) {\r\n      return {\r\n        totalTracks: 0,\r\n        totalAlbums: 0,\r\n        totalArtists: 0,\r\n        totalDuration: 0,\r\n        totalSize: 0,\r\n        averageRating: undefined,\r\n        mostPlayedGenre: undefined,\r\n        recentlyAdded: 0,\r\n      }\r\n    }\r\n\r\n    const uniqueAlbums = new Set(tracks.map(t => `${t.artist}-${t.album}`))\r\n    const uniqueArtists = new Set(tracks.map(t => t.artist))\r\n    const totalDuration = tracks.reduce((sum, t) => sum + t.duration, 0)\r\n    const totalSize = tracks.reduce((sum, t) => sum + t.fileSize, 0)\r\n\r\n    // Calculate average rating\r\n    const ratedTracks = tracks.filter(t => t.rating && t.rating > 0)\r\n    const averageRating = ratedTracks.length > 0 \r\n      ? ratedTracks.reduce((sum, t) => sum + (t.rating || 0), 0) / ratedTracks.length\r\n      : undefined\r\n\r\n    // Find most played genre\r\n    const genrePlayCounts = new Map<string, number>()\r\n    tracks.forEach(track => {\r\n      if (track.genre) {\r\n        genrePlayCounts.set(track.genre, (genrePlayCounts.get(track.genre) || 0) + track.playCount)\r\n      }\r\n    })\r\n\r\n    const mostPlayedGenre = genrePlayCounts.size > 0\r\n      ? Array.from(genrePlayCounts.entries()).reduce((a, b) => a[1] > b[1] ? a : b)[0]\r\n      : undefined\r\n\r\n    // Recently added (last 7 days)\r\n    const sevenDaysAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000)\r\n    const recentlyAdded = tracks.filter(t => t.dateAdded > sevenDaysAgo).length\r\n\r\n    return {\r\n      totalTracks: tracks.length,\r\n      totalAlbums: uniqueAlbums.size,\r\n      totalArtists: uniqueArtists.size,\r\n      totalDuration,\r\n      totalSize,\r\n      averageRating,\r\n      mostPlayedGenre,\r\n      recentlyAdded,\r\n    }\r\n  }\r\n\r\n  // Calculate genre distribution\r\n  calculateGenreDistribution(tracks: TrackMetadata[]): GenreDistribution[] {\r\n    const genreStats = new Map<string, { count: number; totalDuration: number }>()\r\n\r\n    tracks.forEach(track => {\r\n      const genre = track.genre || 'Unknown'\r\n      const existing = genreStats.get(genre) || { count: 0, totalDuration: 0 }\r\n      genreStats.set(genre, {\r\n        count: existing.count + 1,\r\n        totalDuration: existing.totalDuration + track.duration,\r\n      })\r\n    })\r\n\r\n    const totalTracks = tracks.length\r\n\r\n    return Array.from(genreStats.entries())\r\n      .map(([genre, stats]) => ({\r\n        genre,\r\n        count: stats.count,\r\n        percentage: (stats.count / totalTracks) * 100,\r\n        totalDuration: stats.totalDuration,\r\n      }))\r\n      .sort((a, b) => b.count - a.count)\r\n  }\r\n\r\n  // Calculate artist statistics\r\n  calculateArtistStats(tracks: TrackMetadata[]): ArtistStats[] {\r\n    const artistStats = new Map<string, {\r\n      trackCount: number\r\n      totalPlayCount: number\r\n      totalDuration: number\r\n      totalRating: number\r\n      ratedTracks: number\r\n    }>()\r\n\r\n    tracks.forEach(track => {\r\n      const existing = artistStats.get(track.artist) || {\r\n        trackCount: 0,\r\n        totalPlayCount: 0,\r\n        totalDuration: 0,\r\n        totalRating: 0,\r\n        ratedTracks: 0,\r\n      }\r\n\r\n      artistStats.set(track.artist, {\r\n        trackCount: existing.trackCount + 1,\r\n        totalPlayCount: existing.totalPlayCount + track.playCount,\r\n        totalDuration: existing.totalDuration + track.duration,\r\n        totalRating: existing.totalRating + (track.rating || 0),\r\n        ratedTracks: existing.ratedTracks + (track.rating ? 1 : 0),\r\n      })\r\n    })\r\n\r\n    return Array.from(artistStats.entries())\r\n      .map(([artist, stats]) => ({\r\n        artist,\r\n        trackCount: stats.trackCount,\r\n        totalPlayCount: stats.totalPlayCount,\r\n        totalDuration: stats.totalDuration,\r\n        averageRating: stats.ratedTracks > 0 ? stats.totalRating / stats.ratedTracks : 0,\r\n      }))\r\n      .sort((a, b) => b.totalPlayCount - a.totalPlayCount)\r\n  }\r\n\r\n  // Analyze listening patterns by hour\r\n  analyzeListeningPatterns(events: ListeningEvent[]): ListeningPattern[] {\r\n    const hourlyStats = new Map<number, { playCount: number; totalDuration: number }>()\r\n\r\n    // Initialize all hours\r\n    for (let hour = 0; hour < 24; hour++) {\r\n      hourlyStats.set(hour, { playCount: 0, totalDuration: 0 })\r\n    }\r\n\r\n    events.forEach(event => {\r\n      const hour = event.timestamp.getHours()\r\n      const existing = hourlyStats.get(hour)!\r\n      hourlyStats.set(hour, {\r\n        playCount: existing.playCount + 1,\r\n        totalDuration: existing.totalDuration + event.duration,\r\n      })\r\n    })\r\n\r\n    return Array.from(hourlyStats.entries())\r\n      .map(([hour, stats]) => ({\r\n        hour,\r\n        playCount: stats.playCount,\r\n        averageDuration: stats.playCount > 0 ? stats.totalDuration / stats.playCount : 0,\r\n      }))\r\n  }\r\n\r\n  // Calculate library growth over time\r\n  calculateLibraryGrowth(tracks: TrackMetadata[], days = 30): LibraryGrowth[] {\r\n    const growth: LibraryGrowth[] = []\r\n    const sortedTracks = [...tracks].sort((a, b) => a.dateAdded.getTime() - b.dateAdded.getTime())\r\n\r\n    for (let i = days - 1; i >= 0; i--) {\r\n      const date = subDays(new Date(), i)\r\n      const dayStart = startOfDay(date)\r\n      const dayEnd = new Date(dayStart.getTime() + 24 * 60 * 60 * 1000)\r\n\r\n      const totalTracks = sortedTracks.filter(t => t.dateAdded < dayEnd).length\r\n      const tracksAdded = sortedTracks.filter(t => \r\n        t.dateAdded >= dayStart && t.dateAdded < dayEnd\r\n      ).length\r\n\r\n      growth.push({\r\n        date: format(date, 'yyyy-MM-dd'),\r\n        totalTracks,\r\n        tracksAdded,\r\n      })\r\n    }\r\n\r\n    return growth\r\n  }\r\n\r\n  // Calculate playback statistics\r\n  calculatePlaybackStats(events: ListeningEvent[]): PlaybackStats {\r\n    if (events.length === 0) {\r\n      return {\r\n        totalPlayTime: 0,\r\n        averageSessionLength: 0,\r\n        skipRate: 0,\r\n        completionRate: 0,\r\n        mostPlayedHour: 0,\r\n      }\r\n    }\r\n\r\n    const totalPlayTime = events.reduce((sum, event) => sum + event.duration, 0)\r\n    const completedEvents = events.filter(event => event.completed)\r\n    const skippedEvents = events.filter(event => event.skipped)\r\n\r\n    const completionRate = (completedEvents.length / events.length) * 100\r\n    const skipRate = (skippedEvents.length / events.length) * 100\r\n\r\n    // Calculate average session length (group events by proximity)\r\n    const sessions = this.groupEventsIntoSessions(events)\r\n    const averageSessionLength = sessions.length > 0\r\n      ? sessions.reduce((sum, session) => sum + session.duration, 0) / sessions.length\r\n      : 0\r\n\r\n    // Find most played hour\r\n    const hourlyPlayCounts = new Map<number, number>()\r\n    events.forEach(event => {\r\n      const hour = event.timestamp.getHours()\r\n      hourlyPlayCounts.set(hour, (hourlyPlayCounts.get(hour) || 0) + 1)\r\n    })\r\n\r\n    const mostPlayedHour = hourlyPlayCounts.size > 0\r\n      ? Array.from(hourlyPlayCounts.entries()).reduce((a, b) => a[1] > b[1] ? a : b)[0]\r\n      : 0\r\n\r\n    return {\r\n      totalPlayTime,\r\n      averageSessionLength,\r\n      skipRate,\r\n      completionRate,\r\n      mostPlayedHour,\r\n    }\r\n  }\r\n\r\n  // Group listening events into sessions\r\n  private groupEventsIntoSessions(events: ListeningEvent[]): Array<{ duration: number; eventCount: number }> {\r\n    const sortedEvents = [...events].sort((a, b) => a.timestamp.getTime() - b.timestamp.getTime())\r\n    const sessions: Array<{ duration: number; eventCount: number }> = []\r\n    \r\n    let currentSession = { duration: 0, eventCount: 0 }\r\n    let lastEventTime = 0\r\n\r\n    sortedEvents.forEach(event => {\r\n      const eventTime = event.timestamp.getTime()\r\n      const timeSinceLastEvent = eventTime - lastEventTime\r\n\r\n      // If more than 30 minutes since last event, start new session\r\n      if (timeSinceLastEvent > 30 * 60 * 1000 && currentSession.eventCount > 0) {\r\n        sessions.push(currentSession)\r\n        currentSession = { duration: 0, eventCount: 0 }\r\n      }\r\n\r\n      currentSession.duration += event.duration\r\n      currentSession.eventCount += 1\r\n      lastEventTime = eventTime\r\n    })\r\n\r\n    if (currentSession.eventCount > 0) {\r\n      sessions.push(currentSession)\r\n    }\r\n\r\n    return sessions\r\n  }\r\n\r\n  // Get top tracks by various metrics\r\n  getTopTracks(\r\n    tracks: TrackMetadata[],\r\n    metric: 'playCount' | 'rating' | 'duration' | 'recent',\r\n    limit = 10\r\n  ): TrackMetadata[] {\r\n    let sortedTracks: TrackMetadata[]\r\n\r\n    switch (metric) {\r\n      case 'playCount':\r\n        sortedTracks = [...tracks].sort((a, b) => b.playCount - a.playCount)\r\n        break\r\n      case 'rating':\r\n        sortedTracks = [...tracks]\r\n          .filter(t => t.rating && t.rating > 0)\r\n          .sort((a, b) => (b.rating || 0) - (a.rating || 0))\r\n        break\r\n      case 'duration':\r\n        sortedTracks = [...tracks].sort((a, b) => b.duration - a.duration)\r\n        break\r\n      case 'recent':\r\n        sortedTracks = [...tracks]\r\n          .filter(t => t.lastPlayed)\r\n          .sort((a, b) => {\r\n            const aTime = a.lastPlayed?.getTime() || 0\r\n            const bTime = b.lastPlayed?.getTime() || 0\r\n            return bTime - aTime\r\n          })\r\n        break\r\n      default:\r\n        sortedTracks = tracks\r\n    }\r\n\r\n    return sortedTracks.slice(0, limit)\r\n  }\r\n\r\n  // Calculate listening trends over time periods\r\n  calculateListeningTrends(\r\n    events: ListeningEvent[],\r\n    period: 'daily' | 'weekly' | 'monthly',\r\n    duration = 30\r\n  ): Array<{ period: string; playCount: number; uniqueTracks: number }> {\r\n    const trends: Array<{ period: string; playCount: number; uniqueTracks: number }> = []\r\n\r\n    for (let i = duration - 1; i >= 0; i--) {\r\n      let periodStart: Date\r\n      let periodEnd: Date\r\n      let formatString: string\r\n\r\n      switch (period) {\r\n        case 'daily':\r\n          periodStart = startOfDay(subDays(new Date(), i))\r\n          periodEnd = new Date(periodStart.getTime() + 24 * 60 * 60 * 1000)\r\n          formatString = 'MMM dd'\r\n          break\r\n        case 'weekly':\r\n          periodStart = startOfWeek(subWeeks(new Date(), i))\r\n          periodEnd = new Date(periodStart.getTime() + 7 * 24 * 60 * 60 * 1000)\r\n          formatString = 'MMM dd'\r\n          break\r\n        case 'monthly':\r\n          periodStart = startOfMonth(subMonths(new Date(), i))\r\n          periodEnd = startOfMonth(subMonths(new Date(), i - 1))\r\n          formatString = 'MMM yyyy'\r\n          break\r\n        default:\r\n          continue\r\n      }\r\n\r\n      const periodEvents = events.filter(event =>\r\n        event.timestamp >= periodStart && event.timestamp < periodEnd\r\n      )\r\n\r\n      const uniqueTracks = new Set(periodEvents.map(event => event.trackId)).size\r\n\r\n      trends.push({\r\n        period: format(periodStart, formatString),\r\n        playCount: periodEvents.length,\r\n        uniqueTracks,\r\n      })\r\n    }\r\n\r\n    return trends\r\n  }\r\n\r\n  // Export analytics data\r\n  exportAnalyticsData(tracks: TrackMetadata[], events: ListeningEvent[]): {\r\n    libraryStats: LibraryStats\r\n    genreDistribution: GenreDistribution[]\r\n    artistStats: ArtistStats[]\r\n    listeningPatterns: ListeningPattern[]\r\n    playbackStats: PlaybackStats\r\n    topTracks: {\r\n      mostPlayed: TrackMetadata[]\r\n      highestRated: TrackMetadata[]\r\n      recentlyPlayed: TrackMetadata[]\r\n    }\r\n  } {\r\n    return {\r\n      libraryStats: this.calculateLibraryStats(tracks),\r\n      genreDistribution: this.calculateGenreDistribution(tracks),\r\n      artistStats: this.calculateArtistStats(tracks),\r\n      listeningPatterns: this.analyzeListeningPatterns(events),\r\n      playbackStats: this.calculatePlaybackStats(events),\r\n      topTracks: {\r\n        mostPlayed: this.getTopTracks(tracks, 'playCount'),\r\n        highestRated: this.getTopTracks(tracks, 'rating'),\r\n        recentlyPlayed: this.getTopTracks(tracks, 'recent'),\r\n      },\r\n    }\r\n  }\r\n}\r\n\r\nexport const analyticsService = new AnalyticsService()"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1627, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/lib/store/music-store.ts"],"sourcesContent":["'use client'\r\n\r\nimport { create } from 'zustand'\r\nimport { subscribeWithSelector } from 'zustand/middleware'\r\nimport { TrackMetadata, Playlist, ListeningEvent, DuplicateGroup, ViewState, ImportProgress, LibraryStats } from '@/lib/types/music'\r\nimport { dbManager } from '@/lib/db/indexed-db'\r\nimport { searchService } from '@/lib/services/search-service'\r\nimport { duplicateDetectionService } from '@/lib/services/duplicate-detection-service'\r\nimport { playlistService } from '@/lib/services/playlist-service'\r\nimport { analyticsService } from '@/lib/services/analytics-service'\r\n\r\ninterface MusicStoreState {\r\n  // Core data\r\n  tracks: TrackMetadata[]\r\n  playlists: Playlist[]\r\n  listeningEvents: ListeningEvent[]\r\n  duplicateGroups: DuplicateGroup[]\r\n  \r\n  // UI state\r\n  viewState: ViewState\r\n  importProgress: ImportProgress\r\n  libraryStats: LibraryStats | null\r\n  \r\n  // Loading states\r\n  isInitialized: boolean\r\n  isLoading: boolean\r\n  \r\n  // Modals and UI\r\n  showImportModal: boolean\r\n  selectedPlaylistId: string | null\r\n  \r\n  // Actions\r\n  initialize: () => Promise<void>\r\n  \r\n  // Track operations\r\n  addTracks: (tracks: TrackMetadata[]) => Promise<void>\r\n  updateTrack: (track: TrackMetadata) => Promise<void>\r\n  deleteTrack: (id: string) => Promise<void>\r\n  \r\n  // Playlist operations\r\n  createPlaylist: (playlist: Omit<Playlist, 'id' | 'dateCreated' | 'dateModified'>) => Promise<void>\r\n  updatePlaylist: (playlist: Playlist) => Promise<void>\r\n  deletePlaylist: (id: string) => Promise<void>\r\n  \r\n  // Tag-based playlist management\r\n  syncTagBasedPlaylists: () => Promise<void>\r\n  createTagBasedPlaylist: (tag: string) => Promise<void>\r\n  \r\n  // Listening events\r\n  recordListeningEvent: (event: Omit<ListeningEvent, 'id'>) => Promise<void>\r\n  \r\n  // Search and filtering\r\n  searchTracks: (query: string) => TrackMetadata[]\r\n  setFilters: (filters: Partial<ViewState['filters']>) => void\r\n  setSorting: (sortBy: keyof TrackMetadata, sortOrder: 'asc' | 'desc') => void\r\n  \r\n  // UI actions\r\n  setCurrentView: (view: ViewState['currentView']) => void\r\n  setSelectedTracks: (trackIds: string[]) => void\r\n  toggleImportModal: () => void\r\n  setSelectedPlaylist: (playlistId: string | null) => void\r\n  \r\n  // Import operations\r\n  startImport: () => void\r\n  updateImportProgress: (progress: Partial<ImportProgress>) => void\r\n  \r\n  // Analytics\r\n  refreshStats: () => Promise<void>\r\n  \r\n  // Duplicate detection\r\n  detectDuplicates: () => Promise<void>\r\n  resolveDuplicateGroup: (groupId: string, preferredTrackId: string) => Promise<void>\r\n}\r\n\r\nexport const useMusicStore = create<MusicStoreState>()(\r\n  subscribeWithSelector((set, get) => ({\r\n    // Initial state\r\n    tracks: [],\r\n    playlists: [],\r\n    listeningEvents: [],\r\n    duplicateGroups: [],\r\n    \r\n    viewState: {\r\n      currentView: 'library',\r\n      selectedTrackIds: [],\r\n      searchQuery: '',\r\n      filters: {},\r\n      sortBy: 'dateAdded',\r\n      sortOrder: 'desc',\r\n    },\r\n    \r\n    importProgress: {\r\n      isImporting: false,\r\n      currentFile: '',\r\n      processedFiles: 0,\r\n      totalFiles: 0,\r\n      errors: [],\r\n    },\r\n    \r\n    libraryStats: null,\r\n    isInitialized: false,\r\n    isLoading: false,\r\n    showImportModal: false,\r\n    selectedPlaylistId: null,\r\n    \r\n    // Initialize the store\r\n    initialize: async () => {\r\n      set({ isLoading: true })\r\n      \r\n      try {\r\n        await dbManager.initialize()\r\n        \r\n        // Load all data from IndexedDB\r\n        const [tracks, playlists, duplicateGroups] = await Promise.all([\r\n          dbManager.getAllTracks(),\r\n          dbManager.getAllPlaylists(),\r\n          dbManager.getAllDuplicateGroups(),\r\n        ])\r\n        \r\n        // Initialize search service\r\n        searchService.initialize(tracks)\r\n        \r\n        set({\r\n          tracks,\r\n          playlists,\r\n          duplicateGroups,\r\n          isInitialized: true,\r\n          isLoading: false,\r\n        })\r\n        \r\n        // Refresh stats\r\n        get().refreshStats()\r\n        \r\n      } catch (error) {\r\n        console.error('Failed to initialize music store:', error)\r\n        set({ isLoading: false })\r\n      }\r\n    },\r\n    \r\n    // Track operations\r\n    addTracks: async (newTracks) => {\r\n      const { tracks } = get()\r\n      \r\n      try {\r\n        // Add tracks to database\r\n        await Promise.all(newTracks.map(track => dbManager.addTrack(track)))\r\n        \r\n        // Update store\r\n        const updatedTracks = [...tracks, ...newTracks]\r\n        set({ tracks: updatedTracks })\r\n        \r\n        // Update search index\r\n        searchService.addTracks(newTracks)\r\n        \r\n        // Sync tag-based playlists for new tracks with tags\r\n        const hasTaggedTracks = newTracks.some(track => track.customTags.length > 0)\r\n        if (hasTaggedTracks) {\r\n          get().syncTagBasedPlaylists()\r\n        }\r\n        \r\n        // Refresh stats\r\n        get().refreshStats()\r\n        \r\n      } catch (error) {\r\n        console.error('Failed to add tracks:', error)\r\n        throw error\r\n      }\r\n    },\r\n    \r\n    updateTrack: async (updatedTrack) => {\r\n      const { tracks } = get()\r\n      \r\n      try {\r\n        await dbManager.updateTrack(updatedTrack)\r\n        \r\n        const updatedTracks = tracks.map(track => \r\n          track.id === updatedTrack.id ? updatedTrack : track\r\n        )\r\n        set({ tracks: updatedTracks })\r\n        \r\n        // Update search index\r\n        searchService.updateTrack(updatedTrack)\r\n        \r\n        // Sync tag-based playlists when track tags change\r\n        get().syncTagBasedPlaylists()\r\n        \r\n      } catch (error) {\r\n        console.error('Failed to update track:', error)\r\n        throw error\r\n      }\r\n    },\r\n    \r\n    deleteTrack: async (id) => {\r\n      const { tracks, playlists } = get()\r\n      \r\n      try {\r\n        await dbManager.deleteTrack(id)\r\n        \r\n        // Remove from tracks\r\n        const updatedTracks = tracks.filter(track => track.id !== id)\r\n        \r\n        // Remove from playlists\r\n        const updatedPlaylists = playlists.map(playlist => ({\r\n          ...playlist,\r\n          trackIds: playlist.trackIds.filter(trackId => trackId !== id)\r\n        }))\r\n        \r\n        set({ tracks: updatedTracks, playlists: updatedPlaylists })\r\n        \r\n        // Update search index\r\n        searchService.removeTrack(id)\r\n        \r\n        // Update playlists in database\r\n        await Promise.all(\r\n          updatedPlaylists\r\n            .filter(playlist => playlist.trackIds.length !== playlists.find(p => p.id === playlist.id)?.trackIds.length)\r\n            .map(playlist => dbManager.updatePlaylist(playlist))\r\n        )\r\n        \r\n        get().refreshStats()\r\n        \r\n      } catch (error) {\r\n        console.error('Failed to delete track:', error)\r\n        throw error\r\n      }\r\n    },\r\n    \r\n    // Playlist operations\r\n    createPlaylist: async (playlistData) => {\r\n      const { playlists } = get()\r\n      \r\n      const newPlaylist: Playlist = {\r\n        ...playlistData,\r\n        id: crypto.randomUUID(),\r\n        dateCreated: new Date(),\r\n        dateModified: new Date(),\r\n      }\r\n      \r\n      try {\r\n        await dbManager.addPlaylist(newPlaylist)\r\n        set({ playlists: [...playlists, newPlaylist] })\r\n      } catch (error) {\r\n        console.error('Failed to create playlist:', error)\r\n        throw error\r\n      }\r\n    },\r\n    \r\n    updatePlaylist: async (updatedPlaylist) => {\r\n      const { playlists } = get()\r\n      \r\n      const playlistWithUpdatedDate = {\r\n        ...updatedPlaylist,\r\n        dateModified: new Date(),\r\n      }\r\n      \r\n      try {\r\n        await dbManager.updatePlaylist(playlistWithUpdatedDate)\r\n        \r\n        const updatedPlaylists = playlists.map(playlist =>\r\n          playlist.id === updatedPlaylist.id ? playlistWithUpdatedDate : playlist\r\n        )\r\n        set({ playlists: updatedPlaylists })\r\n      } catch (error) {\r\n        console.error('Failed to update playlist:', error)\r\n        throw error\r\n      }\r\n    },\r\n    \r\n    deletePlaylist: async (id) => {\r\n      const { playlists } = get()\r\n      \r\n      try {\r\n        await dbManager.deletePlaylist(id)\r\n        set({ playlists: playlists.filter(playlist => playlist.id !== id) })\r\n      } catch (error) {\r\n        console.error('Failed to delete playlist:', error)\r\n        throw error\r\n      }\r\n    },\r\n    \r\n    // Tag-based playlist management\r\n    syncTagBasedPlaylists: async () => {\r\n      const { tracks, playlists } = get()\r\n      \r\n      try {\r\n        // Create or update tag-based playlists\r\n        const tagBasedPlaylists = await playlistService.createTagBasedPlaylists(tracks, playlists)\r\n        \r\n        // Update existing playlists or create new ones\r\n        for (const playlist of tagBasedPlaylists) {\r\n          const existingIndex = playlists.findIndex(p => p.id === playlist.id)\r\n          if (existingIndex >= 0) {\r\n            // Update existing playlist\r\n            await dbManager.updatePlaylist(playlist)\r\n          } else {\r\n            // Create new playlist\r\n            await dbManager.addPlaylist(playlist)\r\n          }\r\n        }\r\n        \r\n        // Clean up orphaned tag playlists\r\n        const orphanedIds = playlistService.cleanupOrphanedTagPlaylists(tracks, playlists)\r\n        for (const id of orphanedIds) {\r\n          await dbManager.deletePlaylist(id)\r\n        }\r\n        \r\n        // Update store with all playlists\r\n        const updatedPlaylists = await dbManager.getAllPlaylists()\r\n        set({ playlists: updatedPlaylists })\r\n        \r\n      } catch (error) {\r\n        console.error('Failed to sync tag-based playlists:', error)\r\n      }\r\n    },\r\n    \r\n    createTagBasedPlaylist: async (tag: string) => {\r\n      const { tracks } = get()\r\n      \r\n      try {\r\n        const tracksWithTag = tracks.filter(track => track.customTags.includes(tag))\r\n        \r\n        const newPlaylist: Playlist = {\r\n          id: crypto.randomUUID(),\r\n          name: ` ${tag}`,\r\n          description: `Automatically generated playlist for tracks tagged with \"${tag}\"`,\r\n          type: 'smart',\r\n          rules: [{\r\n            field: 'customTags',\r\n            operator: 'contains',\r\n            value: tag\r\n          }],\r\n          trackIds: tracksWithTag.map(track => track.id),\r\n          dateCreated: new Date(),\r\n          dateModified: new Date(),\r\n          sortBy: 'dateAdded',\r\n          sortOrder: 'desc'\r\n        }\r\n        \r\n        await get().createPlaylist(newPlaylist)\r\n        \r\n      } catch (error) {\r\n        console.error('Failed to create tag-based playlist:', error)\r\n        throw error\r\n      }\r\n    },\r\n    \r\n    // Listening events\r\n    recordListeningEvent: async (eventData) => {\r\n      const event: ListeningEvent = {\r\n        ...eventData,\r\n        id: crypto.randomUUID(),\r\n      }\r\n      \r\n      try {\r\n        await dbManager.addListeningEvent(event)\r\n        \r\n        // Update track play count\r\n        const { tracks } = get()\r\n        const track = tracks.find(t => t.id === event.trackId)\r\n        if (track) {\r\n          const updatedTrack = {\r\n            ...track,\r\n            playCount: track.playCount + 1,\r\n            lastPlayed: event.timestamp,\r\n          }\r\n          get().updateTrack(updatedTrack)\r\n        }\r\n        \r\n      } catch (error) {\r\n        console.error('Failed to record listening event:', error)\r\n      }\r\n    },\r\n    \r\n    // Search and filtering\r\n    searchTracks: (query) => {\r\n      const { tracks, viewState } = get()\r\n      \r\n      if (!query.trim()) {\r\n        return tracks\r\n      }\r\n      \r\n      return searchService.search(query, viewState.filters)\r\n    },\r\n    \r\n    setFilters: (filters) => {\r\n      set(state => ({\r\n        viewState: {\r\n          ...state.viewState,\r\n          filters: { ...state.viewState.filters, ...filters }\r\n        }\r\n      }))\r\n    },\r\n    \r\n    setSorting: (sortBy, sortOrder) => {\r\n      set(state => ({\r\n        viewState: {\r\n          ...state.viewState,\r\n          sortBy,\r\n          sortOrder,\r\n        }\r\n      }))\r\n    },\r\n    \r\n    // UI actions\r\n    setCurrentView: (currentView) => {\r\n      set(state => ({\r\n        viewState: { ...state.viewState, currentView }\r\n      }))\r\n    },\r\n    \r\n    setSelectedTracks: (selectedTrackIds) => {\r\n      set(state => ({\r\n        viewState: { ...state.viewState, selectedTrackIds }\r\n      }))\r\n    },\r\n    \r\n    toggleImportModal: () => {\r\n      set(state => ({ showImportModal: !state.showImportModal }))\r\n    },\r\n    \r\n    setSelectedPlaylist: (selectedPlaylistId) => {\r\n      set({ selectedPlaylistId })\r\n    },\r\n    \r\n    // Import operations\r\n    startImport: () => {\r\n      set({\r\n        importProgress: {\r\n          isImporting: true,\r\n          currentFile: '',\r\n          processedFiles: 0,\r\n          totalFiles: 0,\r\n          errors: [],\r\n        }\r\n      })\r\n    },\r\n    \r\n    updateImportProgress: (progress) => {\r\n      set(state => ({\r\n        importProgress: { ...state.importProgress, ...progress }\r\n      }))\r\n    },\r\n    \r\n    // Analytics\r\n    refreshStats: async () => {\r\n      const { tracks } = get()\r\n      const stats = analyticsService.calculateLibraryStats(tracks)\r\n      set({ libraryStats: stats })\r\n    },\r\n    \r\n    // Duplicate detection\r\n    detectDuplicates: async () => {\r\n      const { tracks } = get()\r\n      \r\n      try {\r\n        const duplicateGroups = await duplicateDetectionService.detectDuplicates(tracks)\r\n        \r\n        // Save to database\r\n        await Promise.all(duplicateGroups.map(group => dbManager.addDuplicateGroup(group)))\r\n        \r\n        set({ duplicateGroups })\r\n      } catch (error) {\r\n        console.error('Failed to detect duplicates:', error)\r\n      }\r\n    },\r\n    \r\n    resolveDuplicateGroup: async (groupId, preferredTrackId) => {\r\n      const { duplicateGroups } = get()\r\n      \r\n      const group = duplicateGroups.find(g => g.id === groupId)\r\n      if (!group) return\r\n      \r\n      const resolvedGroup = {\r\n        ...group,\r\n        resolved: true,\r\n        preferredTrackId,\r\n      }\r\n      \r\n      try {\r\n        await dbManager.updateDuplicateGroup(resolvedGroup)\r\n        \r\n        const updatedGroups = duplicateGroups.map(g =>\r\n          g.id === groupId ? resolvedGroup : g\r\n        )\r\n        set({ duplicateGroups: updatedGroups })\r\n      } catch (error) {\r\n        console.error('Failed to resolve duplicate group:', error)\r\n      }\r\n    },\r\n  }))\r\n)"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2030, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/lib/utils/cn.ts"],"sourcesContent":["import { clsx, type ClassValue } from 'clsx'\r\nimport { twMerge } from 'tailwind-merge'\r\n\r\nexport function cn(...inputs: ClassValue[]) {\r\n  return twMerge(clsx(inputs))\r\n}"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,yKAAO,EAAC,IAAA,gJAAI,EAAC;AACtB"}},
    {"offset": {"line": 2048, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/components/layout/Sidebar.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useMusicStore } from '@/lib/store/music-store'\r\nimport { cn } from '@/lib/utils/cn'\r\nimport { \r\n  Music, \r\n  ListMusic, \r\n  BarChart3, \r\n  Copy, \r\n  Settings, \r\n  Plus,\r\n  Search,\r\n  Home\r\n} from 'lucide-react'\r\n\r\nconst navigationItems = [\r\n  { id: 'library', label: 'Library', icon: Music },\r\n  { id: 'playlists', label: 'Playlists', icon: ListMusic },\r\n  { id: 'analytics', label: 'Analytics', icon: BarChart3 },\r\n  { id: 'duplicates', label: 'Duplicates', icon: Copy },\r\n  { id: 'settings', label: 'Settings', icon: Settings },\r\n] as const\r\n\r\nexport function Sidebar() {\r\n  const { viewState, setCurrentView, toggleImportModal, playlists, libraryStats } = useMusicStore()\r\n\r\n  return (\r\n    <div className=\"w-64 bg-gray-800 border-r border-gray-700 flex flex-col\">\r\n      {/* Header */}\r\n      <div className=\"p-4 border-b border-gray-700\">\r\n        <div className=\"flex items-center gap-2 mb-4\">\r\n          <Home className=\"w-6 h-6 text-blue-400\" />\r\n          <h1 className=\"text-lg font-semibold text-white\">Music Library</h1>\r\n        </div>\r\n        \r\n        <button\r\n          onClick={toggleImportModal}\r\n          className=\"w-full flex items-center gap-2 px-3 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-white text-sm font-medium transition-colors\"\r\n        >\r\n          <Plus className=\"w-4 h-4\" />\r\n          Import Music\r\n        </button>\r\n      </div>\r\n\r\n      {/* Navigation */}\r\n      <nav className=\"flex-1 p-4\">\r\n        <div className=\"space-y-1\">\r\n          {navigationItems.map((item) => {\r\n            const Icon = item.icon\r\n            const isActive = viewState.currentView === item.id\r\n            \r\n            return (\r\n              <button\r\n                key={item.id}\r\n                onClick={() => setCurrentView(item.id)}\r\n                className={cn(\r\n                  'w-full flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium transition-colors',\r\n                  isActive\r\n                    ? 'bg-blue-600 text-white'\r\n                    : 'text-gray-300 hover:text-white hover:bg-gray-700'\r\n                )}\r\n              >\r\n                <Icon className=\"w-4 h-4\" />\r\n                {item.label}\r\n              </button>\r\n            )\r\n          })}\r\n        </div>\r\n\r\n        {/* Playlists Section */}\r\n        <div className=\"mt-8\">\r\n          <div className=\"flex items-center justify-between mb-3\">\r\n            <h3 className=\"text-xs font-semibold text-gray-400 uppercase tracking-wider\">\r\n              Playlists\r\n            </h3>\r\n            <button\r\n              onClick={() => {\r\n                // TODO: Open create playlist modal\r\n              }}\r\n              className=\"text-gray-400 hover:text-white\"\r\n            >\r\n              <Plus className=\"w-4 h-4\" />\r\n            </button>\r\n          </div>\r\n          \r\n          <div className=\"space-y-1 max-h-48 overflow-y-auto\">\r\n            {playlists.map((playlist) => (\r\n              <button\r\n                key={playlist.id}\r\n                onClick={() => {\r\n                  setCurrentView('playlists')\r\n                  // TODO: Select playlist\r\n                }}\r\n                className=\"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-300 hover:text-white hover:bg-gray-700 rounded-lg transition-colors text-left\"\r\n              >\r\n                <ListMusic className=\"w-4 h-4 flex-shrink-0\" />\r\n                <span className=\"truncate\">{playlist.name}</span>\r\n                <span className=\"text-xs text-gray-500 ml-auto\">\r\n                  {playlist.trackIds.length}\r\n                </span>\r\n              </button>\r\n            ))}\r\n            \r\n            {playlists.length === 0 && (\r\n              <p className=\"text-xs text-gray-500 px-3 py-2\">\r\n                No playlists yet\r\n              </p>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </nav>\r\n\r\n      {/* Library Stats */}\r\n      {libraryStats && (\r\n        <div className=\"p-4 border-t border-gray-700\">\r\n          <div className=\"text-xs text-gray-400 space-y-1\">\r\n            <div className=\"flex justify-between\">\r\n              <span>Tracks:</span>\r\n              <span className=\"text-white\">{libraryStats.totalTracks.toLocaleString()}</span>\r\n            </div>\r\n            <div className=\"flex justify-between\">\r\n              <span>Artists:</span>\r\n              <span className=\"text-white\">{libraryStats.totalArtists.toLocaleString()}</span>\r\n            </div>\r\n            <div className=\"flex justify-between\">\r\n              <span>Albums:</span>\r\n              <span className=\"text-white\">{libraryStats.totalAlbums.toLocaleString()}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;AAJA;;;;AAeA,MAAM,kBAAkB;IACtB;QAAE,IAAI;QAAW,OAAO;QAAW,MAAM,gNAAK;IAAC;IAC/C;QAAE,IAAI;QAAa,OAAO;QAAa,MAAM,gOAAS;IAAC;IACvD;QAAE,IAAI;QAAa,OAAO;QAAa,MAAM,kOAAS;IAAC;IACvD;QAAE,IAAI;QAAc,OAAO;QAAc,MAAM,6MAAI;IAAC;IACpD;QAAE,IAAI;QAAY,OAAO;QAAY,MAAM,yNAAQ;IAAC;CACrD;AAEM,SAAS;;IACd,MAAM,EAAE,SAAS,EAAE,cAAc,EAAE,iBAAiB,EAAE,SAAS,EAAE,YAAY,EAAE,GAAG,IAAA,yJAAa;IAE/F,qBACE,6LAAC;QAAI,WAAU;;0BAEb,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,8MAAI;gCAAC,WAAU;;;;;;0CAChB,6LAAC;gCAAG,WAAU;0CAAmC;;;;;;;;;;;;kCAGnD,6LAAC;wBACC,SAAS;wBACT,WAAU;;0CAEV,6LAAC,6MAAI;gCAAC,WAAU;;;;;;4BAAY;;;;;;;;;;;;;0BAMhC,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;kCACZ,gBAAgB,GAAG,CAAC,CAAC;4BACpB,MAAM,OAAO,KAAK,IAAI;4BACtB,MAAM,WAAW,UAAU,WAAW,KAAK,KAAK,EAAE;4BAElD,qBACE,6LAAC;gCAEC,SAAS,IAAM,eAAe,KAAK,EAAE;gCACrC,WAAW,IAAA,kIAAE,EACX,6FACA,WACI,2BACA;;kDAGN,6LAAC;wCAAK,WAAU;;;;;;oCACf,KAAK,KAAK;;+BAVN,KAAK,EAAE;;;;;wBAalB;;;;;;kCAIF,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAG,WAAU;kDAA+D;;;;;;kDAG7E,6LAAC;wCACC,SAAS;wCACP,mCAAmC;wCACrC;wCACA,WAAU;kDAEV,cAAA,6LAAC,6MAAI;4CAAC,WAAU;;;;;;;;;;;;;;;;;0CAIpB,6LAAC;gCAAI,WAAU;;oCACZ,UAAU,GAAG,CAAC,CAAC,yBACd,6LAAC;4CAEC,SAAS;gDACP,eAAe;4CACf,wBAAwB;4CAC1B;4CACA,WAAU;;8DAEV,6LAAC,gOAAS;oDAAC,WAAU;;;;;;8DACrB,6LAAC;oDAAK,WAAU;8DAAY,SAAS,IAAI;;;;;;8DACzC,6LAAC;oDAAK,WAAU;8DACb,SAAS,QAAQ,CAAC,MAAM;;;;;;;2CAVtB,SAAS,EAAE;;;;;oCAenB,UAAU,MAAM,KAAK,mBACpB,6LAAC;wCAAE,WAAU;kDAAkC;;;;;;;;;;;;;;;;;;;;;;;;YAStD,8BACC,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;8CAAK;;;;;;8CACN,6LAAC;oCAAK,WAAU;8CAAc,aAAa,WAAW,CAAC,cAAc;;;;;;;;;;;;sCAEvE,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;8CAAK;;;;;;8CACN,6LAAC;oCAAK,WAAU;8CAAc,aAAa,YAAY,CAAC,cAAc;;;;;;;;;;;;sCAExE,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;8CAAK;;;;;;8CACN,6LAAC;oCAAK,WAAU;8CAAc,aAAa,WAAW,CAAC,cAAc;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOnF;GA9GgB;;QACoE,yJAAa;;;KADjF"}},
    {"offset": {"line": 2396, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/components/ui/SearchBar.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { Search, X } from 'lucide-react'\r\n\r\ninterface SearchBarProps {\r\n  value: string\r\n  onChange: (value: string) => void\r\n  placeholder?: string\r\n}\r\n\r\nexport function SearchBar({ value, onChange, placeholder = \"Search...\" }: SearchBarProps) {\r\n  return (\r\n    <div className=\"relative\">\r\n      <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\" />\r\n      <input\r\n        type=\"text\"\r\n        value={value}\r\n        onChange={(e) => onChange(e.target.value)}\r\n        placeholder={placeholder}\r\n        className=\"w-full pl-10 pr-10 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n      />\r\n      {value && (\r\n        <button\r\n          onClick={() => onChange('')}\r\n          className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white\"\r\n        >\r\n          <X className=\"w-4 h-4\" />\r\n        </button>\r\n      )}\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":";;;;;AAEA;AAAA;AAFA;;;AAUO,SAAS,UAAU,EAAE,KAAK,EAAE,QAAQ,EAAE,cAAc,WAAW,EAAkB;IACtF,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC,mNAAM;gBAAC,WAAU;;;;;;0BAClB,6LAAC;gBACC,MAAK;gBACL,OAAO;gBACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;gBACxC,aAAa;gBACb,WAAU;;;;;;YAEX,uBACC,6LAAC;gBACC,SAAS,IAAM,SAAS;gBACxB,WAAU;0BAEV,cAAA,6LAAC,oMAAC;oBAAC,WAAU;;;;;;;;;;;;;;;;;AAKvB;KArBgB"}},
    {"offset": {"line": 2460, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/lib/services/tag-service.ts"],"sourcesContent":["import { TrackMetadata } from '@/lib/types/music'\r\n\r\nexport interface TagSuggestion {\r\n  tag: string\r\n  count: number\r\n  category?: 'genre' | 'mood' | 'custom'\r\n}\r\n\r\nexport interface MoodSuggestion {\r\n  mood: string\r\n  count: number\r\n}\r\n\r\nclass TagService {\r\n  // Get all unique tags from the library\r\n  getAllTags(tracks: TrackMetadata[]): TagSuggestion[] {\r\n    const tagCounts = new Map<string, number>()\r\n    \r\n    tracks.forEach(track => {\r\n      track.customTags.forEach(tag => {\r\n        tagCounts.set(tag, (tagCounts.get(tag) || 0) + 1)\r\n      })\r\n    })\r\n    \r\n    return Array.from(tagCounts.entries())\r\n      .map(([tag, count]) => ({ tag, count, category: 'custom' as const }))\r\n      .sort((a, b) => b.count - a.count)\r\n  }\r\n\r\n  // Get all unique moods from the library\r\n  getAllMoods(tracks: TrackMetadata[]): MoodSuggestion[] {\r\n    const moodCounts = new Map<string, number>()\r\n    \r\n    tracks.forEach(track => {\r\n      if (track.mood) {\r\n        moodCounts.set(track.mood, (moodCounts.get(track.mood) || 0) + 1)\r\n      }\r\n    })\r\n    \r\n    return Array.from(moodCounts.entries())\r\n      .map(([mood, count]) => ({ mood, count }))\r\n      .sort((a, b) => b.count - a.count)\r\n  }\r\n\r\n  // Get tag suggestions based on partial input\r\n  getTagSuggestions(tracks: TrackMetadata[], query: string, limit = 10): TagSuggestion[] {\r\n    const allTags = this.getAllTags(tracks)\r\n    \r\n    if (!query.trim()) {\r\n      return allTags.slice(0, limit)\r\n    }\r\n    \r\n    const queryLower = query.toLowerCase()\r\n    return allTags\r\n      .filter(({ tag }) => tag.toLowerCase().includes(queryLower))\r\n      .slice(0, limit)\r\n  }\r\n\r\n  // Get mood suggestions based on partial input\r\n  getMoodSuggestions(tracks: TrackMetadata[], query: string, limit = 10): MoodSuggestion[] {\r\n    const allMoods = this.getAllMoods(tracks)\r\n    \r\n    if (!query.trim()) {\r\n      return allMoods.slice(0, limit)\r\n    }\r\n    \r\n    const queryLower = query.toLowerCase()\r\n    return allMoods\r\n      .filter(({ mood }) => mood.toLowerCase().includes(queryLower))\r\n      .slice(0, limit)\r\n  }\r\n\r\n  // Normalize tag names (consistent casing, remove duplicates)\r\n  normalizeTags(tags: string[]): string[] {\r\n    const normalized = new Set<string>()\r\n    \r\n    tags.forEach(tag => {\r\n      const trimmed = tag.trim()\r\n      if (trimmed) {\r\n        // Convert to title case for consistency\r\n        const titleCase = trimmed\r\n          .toLowerCase()\r\n          .split(' ')\r\n          .map(word => word.charAt(0).toUpperCase() + word.slice(1))\r\n          .join(' ')\r\n        normalized.add(titleCase)\r\n      }\r\n    })\r\n    \r\n    return Array.from(normalized).sort()\r\n  }\r\n\r\n  // Normalize mood names\r\n  normalizeMood(mood: string): string {\r\n    const trimmed = mood.trim()\r\n    if (!trimmed) return ''\r\n    \r\n    // Convert to title case\r\n    return trimmed\r\n      .toLowerCase()\r\n      .split(' ')\r\n      .map(word => word.charAt(0).toUpperCase() + word.slice(1))\r\n      .join(' ')\r\n  }\r\n\r\n  // Get popular tags (most used)\r\n  getPopularTags(tracks: TrackMetadata[], limit = 20): TagSuggestion[] {\r\n    return this.getAllTags(tracks).slice(0, limit)\r\n  }\r\n\r\n  // Get popular moods (most used)\r\n  getPopularMoods(tracks: TrackMetadata[], limit = 10): MoodSuggestion[] {\r\n    return this.getAllMoods(tracks).slice(0, limit)\r\n  }\r\n\r\n  // Find similar tags (for deduplication)\r\n  findSimilarTags(tracks: TrackMetadata[], threshold = 0.8): Array<{ original: string; similar: string[]; count: number }> {\r\n    const allTags = this.getAllTags(tracks)\r\n    const similar: Array<{ original: string; similar: string[]; count: number }> = []\r\n    \r\n    for (let i = 0; i < allTags.length; i++) {\r\n      const tag1 = allTags[i]\r\n      const similarTags: string[] = []\r\n      \r\n      for (let j = i + 1; j < allTags.length; j++) {\r\n        const tag2 = allTags[j]\r\n        \r\n        if (this.calculateSimilarity(tag1.tag, tag2.tag) >= threshold) {\r\n          similarTags.push(tag2.tag)\r\n        }\r\n      }\r\n      \r\n      if (similarTags.length > 0) {\r\n        similar.push({\r\n          original: tag1.tag,\r\n          similar: similarTags,\r\n          count: tag1.count\r\n        })\r\n      }\r\n    }\r\n    \r\n    return similar.sort((a, b) => b.count - a.count)\r\n  }\r\n\r\n  // Calculate string similarity (Levenshtein distance based)\r\n  private calculateSimilarity(str1: string, str2: string): number {\r\n    const s1 = str1.toLowerCase()\r\n    const s2 = str2.toLowerCase()\r\n    \r\n    if (s1 === s2) return 1\r\n    \r\n    const longer = s1.length > s2.length ? s1 : s2\r\n    const shorter = s1.length > s2.length ? s2 : s1\r\n    \r\n    if (longer.length === 0) return 1\r\n    \r\n    const distance = this.levenshteinDistance(longer, shorter)\r\n    return (longer.length - distance) / longer.length\r\n  }\r\n\r\n  private levenshteinDistance(str1: string, str2: string): number {\r\n    const matrix = []\r\n    \r\n    for (let i = 0; i <= str2.length; i++) {\r\n      matrix[i] = [i]\r\n    }\r\n    \r\n    for (let j = 0; j <= str1.length; j++) {\r\n      matrix[0][j] = j\r\n    }\r\n    \r\n    for (let i = 1; i <= str2.length; i++) {\r\n      for (let j = 1; j <= str1.length; j++) {\r\n        if (str2.charAt(i - 1) === str1.charAt(j - 1)) {\r\n          matrix[i][j] = matrix[i - 1][j - 1]\r\n        } else {\r\n          matrix[i][j] = Math.min(\r\n            matrix[i - 1][j - 1] + 1,\r\n            matrix[i][j - 1] + 1,\r\n            matrix[i - 1][j] + 1\r\n          )\r\n        }\r\n      }\r\n    }\r\n    \r\n    return matrix[str2.length][str1.length]\r\n  }\r\n\r\n  // Predefined mood categories for suggestions\r\n  getPredefinedMoods(): string[] {\r\n    return [\r\n      'Happy',\r\n      'Sad',\r\n      'Energetic',\r\n      'Calm',\r\n      'Melancholic',\r\n      'Upbeat',\r\n      'Relaxing',\r\n      'Intense',\r\n      'Peaceful',\r\n      'Aggressive',\r\n      'Romantic',\r\n      'Nostalgic',\r\n      'Motivational',\r\n      'Dark',\r\n      'Bright',\r\n      'Dreamy',\r\n      'Powerful',\r\n      'Gentle',\r\n      'Mysterious',\r\n      'Playful'\r\n    ]\r\n  }\r\n\r\n  // Predefined tag categories for suggestions\r\n  getPredefinedTags(): string[] {\r\n    return [\r\n      'Favorite',\r\n      'Workout',\r\n      'Study',\r\n      'Party',\r\n      'Driving',\r\n      'Sleep',\r\n      'Focus',\r\n      'Chill',\r\n      'Dance',\r\n      'Acoustic',\r\n      'Live',\r\n      'Cover',\r\n      'Instrumental',\r\n      'Vocal',\r\n      'Classic',\r\n      'New',\r\n      'Discovered',\r\n      'Recommended',\r\n      'Seasonal',\r\n      'Holiday'\r\n    ]\r\n  }\r\n}\r\n\r\nexport const tagService = new TagService()"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2652, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/components/ui/FilterBar.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState } from 'react'\r\nimport { TrackMetadata, ViewState } from '@/lib/types/music'\r\nimport { searchService } from '@/lib/services/search-service'\r\nimport { tagService } from '@/lib/services/tag-service'\r\nimport { Filter, X } from 'lucide-react'\r\n\r\ninterface FilterBarProps {\r\n  tracks: TrackMetadata[]\r\n  filters: ViewState['filters']\r\n  onFiltersChange: (filters: Partial<ViewState['filters']>) => void\r\n}\r\n\r\nexport function FilterBar({ tracks, filters, onFiltersChange }: FilterBarProps) {\r\n  const [showFilters, setShowFilters] = useState(false)\r\n\r\n  const genres = searchService.getUniqueValues('genre')\r\n  const artists = searchService.getUniqueValues('artist')\r\n  const albums = searchService.getUniqueValues('album')\r\n  const years = Array.from(new Set(tracks.map(t => t.year).filter(Boolean))).sort((a, b) => b! - a!)\r\n  const fileFormats = Array.from(new Set(tracks.map(t => t.fileFormat).filter(Boolean))).sort()\r\n  const allTags = tagService.getAllTags(tracks)\r\n  const allMoods = tagService.getAllMoods(tracks)\r\n\r\n  const activeFiltersCount = Object.values(filters).filter(Boolean).length\r\n\r\n  const clearFilters = () => {\r\n    onFiltersChange({\r\n      genre: undefined,\r\n      artist: undefined,\r\n      album: undefined,\r\n      year: undefined,\r\n      rating: undefined,\r\n      fileFormat: undefined,\r\n      customTag: undefined,\r\n      mood: undefined,\r\n    })\r\n  }\r\n\r\n  return (\r\n    <div className=\"relative\">\r\n      <button\r\n        onClick={() => setShowFilters(!showFilters)}\r\n        className=\"flex items-center gap-2 px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white hover:bg-gray-700 transition-colors\"\r\n      >\r\n        <Filter className=\"w-4 h-4\" />\r\n        Filters\r\n        {activeFiltersCount > 0 && (\r\n          <span className=\"bg-blue-600 text-white text-xs px-2 py-1 rounded-full\">\r\n            {activeFiltersCount}\r\n          </span>\r\n        )}\r\n      </button>\r\n\r\n      {showFilters && (\r\n        <div className=\"absolute top-full right-0 mt-2 w-80 bg-gray-800 border border-gray-600 rounded-lg shadow-lg z-10\">\r\n          <div className=\"p-4\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <h3 className=\"text-white font-medium\">Filters</h3>\r\n              {activeFiltersCount > 0 && (\r\n                <button\r\n                  onClick={clearFilters}\r\n                  className=\"text-blue-400 hover:text-blue-300 text-sm\"\r\n                >\r\n                  Clear all\r\n                </button>\r\n              )}\r\n            </div>\r\n\r\n            <div className=\"space-y-4\">\r\n              {/* Genre Filter */}\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-300 mb-2\">\r\n                  Genre\r\n                </label>\r\n                <select\r\n                  value={filters.genre || ''}\r\n                  onChange={(e) => onFiltersChange({ genre: e.target.value || undefined })}\r\n                  className=\"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white\"\r\n                >\r\n                  <option value=\"\">All genres</option>\r\n                  {genres.map(genre => (\r\n                    <option key={genre} value={genre}>{genre}</option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n\r\n              {/* Artist Filter */}\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-300 mb-2\">\r\n                  Artist\r\n                </label>\r\n                <select\r\n                  value={filters.artist || ''}\r\n                  onChange={(e) => onFiltersChange({ artist: e.target.value || undefined })}\r\n                  className=\"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white\"\r\n                >\r\n                  <option value=\"\">All artists</option>\r\n                  {artists.slice(0, 50).map(artist => (\r\n                    <option key={artist} value={artist}>{artist}</option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n\r\n              {/* Year Filter */}\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-300 mb-2\">\r\n                  Year\r\n                </label>\r\n                <select\r\n                  value={filters.year || ''}\r\n                  onChange={(e) => onFiltersChange({ year: e.target.value ? parseInt(e.target.value) : undefined })}\r\n                  className=\"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white\"\r\n                >\r\n                  <option value=\"\">All years</option>\r\n                  {years.map(year => (\r\n                    <option key={year} value={year}>{year}</option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n\r\n              {/* File Format Filter */}\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-300 mb-2\">\r\n                  File Format\r\n                </label>\r\n                <select\r\n                  value={filters.fileFormat || ''}\r\n                  onChange={(e) => onFiltersChange({ fileFormat: e.target.value || undefined })}\r\n                  className=\"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white\"\r\n                >\r\n                  <option value=\"\">All formats</option>\r\n                  {fileFormats.map(format => (\r\n                    <option key={format} value={format}>{format.toUpperCase()}</option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n\r\n              {/* Rating Filter */}\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-300 mb-2\">\r\n                  Rating\r\n                </label>\r\n                <select\r\n                  value={filters.rating || ''}\r\n                  onChange={(e) => onFiltersChange({ rating: e.target.value ? parseInt(e.target.value) : undefined })}\r\n                  className=\"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white\"\r\n                >\r\n                  <option value=\"\">All ratings</option>\r\n                  <option value=\"5\"> (5 stars)</option>\r\n                  <option value=\"4\"> (4+ stars)</option>\r\n                  <option value=\"3\"> (3+ stars)</option>\r\n                  <option value=\"2\"> (2+ stars)</option>\r\n                  <option value=\"1\"> (1+ stars)</option>\r\n                </select>\r\n              </div>\r\n\r\n              {/* Custom Tag Filter */}\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-300 mb-2\">\r\n                  Tag\r\n                </label>\r\n                <select\r\n                  value={filters.customTag || ''}\r\n                  onChange={(e) => onFiltersChange({ customTag: e.target.value || undefined })}\r\n                  className=\"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white\"\r\n                >\r\n                  <option value=\"\">All tags</option>\r\n                  {allTags.slice(0, 20).map(({ tag, count }) => (\r\n                    <option key={tag} value={tag}>{tag} ({count})</option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n\r\n              {/* Mood Filter */}\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-300 mb-2\">\r\n                  Mood\r\n                </label>\r\n                <select\r\n                  value={filters.mood || ''}\r\n                  onChange={(e) => onFiltersChange({ mood: e.target.value || undefined })}\r\n                  className=\"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white\"\r\n                >\r\n                  <option value=\"\">All moods</option>\r\n                  {allMoods.slice(0, 15).map(({ mood, count }) => (\r\n                    <option key={mood} value={mood}>{mood} ({count})</option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3146, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/lib/utils/format.ts"],"sourcesContent":["// Format duration in seconds to MM:SS or HH:MM:SS\r\nexport function formatDuration(seconds: number): string {\r\n  if (seconds < 0) return '0:00'\r\n  \r\n  const hours = Math.floor(seconds / 3600)\r\n  const minutes = Math.floor((seconds % 3600) / 60)\r\n  const remainingSeconds = Math.floor(seconds % 60)\r\n  \r\n  if (hours > 0) {\r\n    return `${hours}:${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`\r\n  }\r\n  \r\n  return `${minutes}:${remainingSeconds.toString().padStart(2, '0')}`\r\n}\r\n\r\n// Format file size in bytes to human readable format\r\nexport function formatFileSize(bytes: number): string {\r\n  if (bytes === 0) return '0 B'\r\n  \r\n  const k = 1024\r\n  const sizes = ['B', 'KB', 'MB', 'GB']\r\n  const i = Math.floor(Math.log(bytes) / Math.log(k))\r\n  \r\n  return `${parseFloat((bytes / Math.pow(k, i)).toFixed(1))} ${sizes[i]}`\r\n}\r\n\r\n// Format bitrate\r\nexport function formatBitrate(bitrate?: number): string {\r\n  if (!bitrate) return 'Unknown'\r\n  return `${bitrate} kbps`\r\n}\r\n\r\n// Format play count\r\nexport function formatPlayCount(count: number): string {\r\n  if (count === 0) return 'Never played'\r\n  if (count === 1) return '1 play'\r\n  if (count < 1000) return `${count} plays`\r\n  if (count < 1000000) return `${(count / 1000).toFixed(1)}K plays`\r\n  return `${(count / 1000000).toFixed(1)}M plays`\r\n}\r\n\r\n// Format date relative to now\r\nexport function formatRelativeDate(date: Date): string {\r\n  const now = new Date()\r\n  const diffMs = now.getTime() - date.getTime()\r\n  const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24))\r\n  \r\n  if (diffDays === 0) return 'Today'\r\n  if (diffDays === 1) return 'Yesterday'\r\n  if (diffDays < 7) return `${diffDays} days ago`\r\n  if (diffDays < 30) return `${Math.floor(diffDays / 7)} weeks ago`\r\n  if (diffDays < 365) return `${Math.floor(diffDays / 30)} months ago`\r\n  return `${Math.floor(diffDays / 365)} years ago`\r\n}\r\n\r\n// Format percentage\r\nexport function formatPercentage(value: number, decimals = 1): string {\r\n  return `${value.toFixed(decimals)}%`\r\n}\r\n\r\n// Format rating as stars\r\nexport function formatRating(rating?: number): string {\r\n  if (!rating) return ''\r\n  \r\n  const fullStars = Math.floor(rating)\r\n  const hasHalfStar = rating % 1 >= 0.5\r\n  const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0)\r\n  \r\n  return ''.repeat(fullStars) + \r\n         (hasHalfStar ? '' : '') + \r\n         ''.repeat(emptyStars)\r\n}\r\n\r\n// Truncate text with ellipsis\r\nexport function truncateText(text: string, maxLength: number): string {\r\n  if (text.length <= maxLength) return text\r\n  return text.substring(0, maxLength - 3) + '...'\r\n}\r\n\r\n// Format track number with leading zero\r\nexport function formatTrackNumber(trackNumber?: number, totalTracks?: number): string {\r\n  if (!trackNumber) return ''\r\n  \r\n  const digits = totalTracks ? totalTracks.toString().length : 2\r\n  return trackNumber.toString().padStart(digits, '0')\r\n}\r\n\r\n// Format disc number\r\nexport function formatDiscNumber(discNumber?: number): string {\r\n  if (!discNumber) return ''\r\n  return `Disc ${discNumber}`\r\n}\r\n\r\n// Format file format\r\nexport function formatFileFormat(format?: string): string {\r\n  if (!format) return 'Unknown'\r\n  return format.toUpperCase()\r\n}\r\n\r\n// Format year range\r\nexport function formatYearRange(startYear?: number, endYear?: number): string {\r\n  if (!startYear && !endYear) return ''\r\n  if (!endYear || startYear === endYear) return startYear?.toString() || ''\r\n  return `${startYear}-${endYear}`\r\n}\r\n\r\n// Format time of day\r\nexport function formatTimeOfDay(hour: number): string {\r\n  if (hour === 0) return '12 AM'\r\n  if (hour < 12) return `${hour} AM`\r\n  if (hour === 12) return '12 PM'\r\n  return `${hour - 12} PM`\r\n}\r\n\r\n// Format large numbers with commas\r\nexport function formatNumber(num: number): string {\r\n  return num.toLocaleString()\r\n}\r\n\r\n// Format similarity score as percentage\r\nexport function formatSimilarity(score: number): string {\r\n  return `${Math.round(score * 100)}%`\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3274, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/components/ui/TrackRow.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState } from 'react'\r\nimport { TrackMetadata } from '@/lib/types/music'\r\nimport { \r\n  formatDuration, \r\n  formatRating, \r\n  formatBitrate,\r\n  formatTrackNumber,\r\n  formatFileFormat\r\n} from '@/lib/utils/format'\r\nimport { Trash2, Edit, MoreHorizontal, ListPlus } from 'lucide-react'\r\nimport { cn } from '@/lib/utils/cn'\r\n\r\ninterface TrackRowProps {\r\n  track: TrackMetadata\r\n  index: number\r\n  isSelected?: boolean\r\n  onSelect?: (isSelected: boolean) => void\r\n  onDelete?: (trackId: string) => void\r\n  onEdit?: (trackId: string) => void\r\n  onAddToPlaylist?: (trackId: string) => void\r\n  context?: 'library' | 'playlist'\r\n}\r\n\r\nexport function TrackRow({ \r\n  track, \r\n  index, \r\n  isSelected = false,\r\n  onSelect,\r\n  onDelete,\r\n  onEdit,\r\n  onAddToPlaylist,\r\n  context = 'library'\r\n}: TrackRowProps) {\r\n  const [showActionsMenu, setShowActionsMenu] = useState(false)\r\n\r\n  const handleDelete = () => {\r\n    if (confirm(`Are you sure you want to delete \"${track.title}\" from your library? This cannot be undone.`)) {\r\n      onDelete?.(track.id)\r\n    }\r\n    setShowActionsMenu(false)\r\n  }\r\n\r\n  const handleEdit = () => {\r\n    onEdit?.(track.id)\r\n    setShowActionsMenu(false)\r\n  }\r\n\r\n  const handleAddToPlaylist = () => {\r\n    onAddToPlaylist?.(track.id)\r\n    setShowActionsMenu(false)\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className={cn(\r\n        'flex items-center px-6 py-3 hover:bg-gray-800 transition-colors group',\r\n        isSelected && 'bg-gray-800',\r\n        index % 2 === 0 && 'bg-gray-900/50'\r\n      )}\r\n    >\r\n      {/* Selection checkbox */}\r\n      {onSelect && (\r\n        <input\r\n          type=\"checkbox\"\r\n          checked={isSelected}\r\n          onChange={(e) => onSelect(e.target.checked)}\r\n          className=\"mr-4 rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500\"\r\n        />\r\n      )}\r\n      \r\n      <div className=\"flex-1 grid grid-cols-24 gap-2 items-center text-sm\">\r\n        {/* Title */}\r\n        <div className=\"col-span-4 flex items-center gap-3 min-w-0\">\r\n          <div className=\"min-w-0\">\r\n            <div className=\"text-white font-medium truncate\" title={track.title}>\r\n              {track.title}\r\n            </div>\r\n            {/* Show custom tags if any */}\r\n            {track.customTags.length > 0 && (\r\n              <div className=\"flex flex-wrap gap-1 mt-1\">\r\n                {track.customTags.slice(0, 2).map((tag, idx) => (\r\n                  <span\r\n                    key={idx}\r\n                    className=\"inline-block px-1 py-0.5 bg-blue-600 text-xs text-white rounded\"\r\n                    title={track.customTags.join(', ')}\r\n                  >\r\n                    {tag}\r\n                  </span>\r\n                ))}\r\n                {track.customTags.length > 2 && (\r\n                  <span className=\"text-xs text-gray-400\">\r\n                    +{track.customTags.length - 2}\r\n                  </span>\r\n                )}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Artist */}\r\n        <div className=\"col-span-3 text-gray-300 truncate\" title={track.artist}>\r\n          {track.artist}\r\n        </div>\r\n\r\n        {/* Album */}\r\n        <div className=\"col-span-3 text-gray-300 truncate\" title={track.album}>\r\n          {track.album}\r\n        </div>\r\n\r\n        {/* Genre */}\r\n        <div className=\"col-span-2 text-gray-400 truncate\" title={track.genre || 'Unknown'}>\r\n          {track.genre || 'Unknown'}\r\n        </div>\r\n\r\n        {/* Year */}\r\n        <div className=\"col-span-1 text-gray-400 text-center\">\r\n          {track.year || ''}\r\n        </div>\r\n\r\n        {/* Track Number */}\r\n        <div className=\"col-span-1 text-gray-400 text-center\">\r\n          {formatTrackNumber(track.trackNumber)}\r\n        </div>\r\n\r\n        {/* Disc Number */}\r\n        <div className=\"col-span-1 text-gray-400 text-center\">\r\n          {track.discNumber || ''}\r\n        </div>\r\n\r\n        {/* Duration */}\r\n        <div className=\"col-span-2 text-gray-400\">\r\n          {formatDuration(track.duration)}\r\n        </div>\r\n\r\n        {/* Bitrate */}\r\n        <div className=\"col-span-2 text-gray-400\">\r\n          {formatBitrate(track.bitrate)}\r\n        </div>\r\n\r\n        {/* File Format */}\r\n        <div className=\"col-span-1 text-gray-400 text-center\">\r\n          {formatFileFormat(track.fileFormat)}\r\n        </div>\r\n\r\n        {/* Play Count */}\r\n        <div className=\"col-span-1 text-gray-400 text-center\">\r\n          {track.playCount}\r\n        </div>\r\n\r\n        {/* Rating */}\r\n        <div className=\"col-span-2 text-gray-400\">\r\n          {formatRating(track.rating)}\r\n          {track.mood && (\r\n            <div className=\"text-xs text-blue-400 truncate\" title={track.mood}>\r\n              {track.mood}\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Actions */}\r\n        <div className=\"col-span-1 flex justify-center relative\">\r\n          <button \r\n            onClick={() => setShowActionsMenu(!showActionsMenu)}\r\n            className=\"p-2 text-gray-400 hover:text-white opacity-0 group-hover:opacity-100 transition-opacity\"\r\n          >\r\n            <MoreHorizontal className=\"w-4 h-4\" />\r\n          </button>\r\n\r\n          {/* Actions Dropdown Menu */}\r\n          {showActionsMenu && (\r\n            <div className=\"absolute right-0 top-full mt-1 w-48 bg-gray-800 border border-gray-600 rounded-lg shadow-lg z-10\">\r\n              <div className=\"py-1\">\r\n                {/* Edit Track */}\r\n                {onEdit && (\r\n                  <button\r\n                    onClick={handleEdit}\r\n                    className=\"w-full px-4 py-2 text-left text-gray-300 hover:bg-gray-700 hover:text-white flex items-center gap-2\"\r\n                  >\r\n                    <Edit className=\"w-4 h-4\" />\r\n                    Edit Metadata\r\n                  </button>\r\n                )}\r\n\r\n                {/* Add to Playlist */}\r\n                {context === 'library' && onAddToPlaylist && (\r\n                  <button\r\n                    onClick={handleAddToPlaylist}\r\n                    className=\"w-full px-4 py-2 text-left text-gray-300 hover:bg-gray-700 hover:text-white flex items-center gap-2\"\r\n                  >\r\n                    <ListPlus className=\"w-4 h-4\" />\r\n                    Add to Playlist\r\n                  </button>\r\n                )}\r\n\r\n                {/* Separator */}\r\n                {onDelete && (onEdit || (context === 'library' && onAddToPlaylist)) && (\r\n                  <div className=\"border-t border-gray-600 my-1\"></div>\r\n                )}\r\n\r\n                {/* Delete from Library */}\r\n                {onDelete && (\r\n                  <button\r\n                    onClick={handleDelete}\r\n                    className=\"w-full px-4 py-2 text-left text-red-400 hover:bg-gray-700 hover:text-red-300 flex items-center gap-2\"\r\n                  >\r\n                    <Trash2 className=\"w-4 h-4\" />\r\n                    Delete from Library\r\n                  </button>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Click outside to close menu */}\r\n      {showActionsMenu && (\r\n        <div \r\n          className=\"fixed inset-0 z-5\" \r\n          onClick={() => setShowActionsMenu(false)}\r\n        />\r\n      )}\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3615, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/components/ui/TrackCard.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { TrackMetadata } from '@/lib/types/music'\r\nimport { formatDuration, formatRating, formatFileFormat, formatBitrate } from '@/lib/utils/format'\r\nimport { Play, Music } from 'lucide-react'\r\nimport { cn } from '@/lib/utils/cn'\r\n\r\ninterface TrackCardProps {\r\n  track: TrackMetadata\r\n  isSelected: boolean\r\n  onSelect: (isSelected: boolean) => void\r\n}\r\n\r\nexport function TrackCard({ track, isSelected, onSelect }: TrackCardProps) {\r\n  const handlePlay = () => {\r\n    // TODO: Implement play functionality\r\n    console.log('Play track:', track.title)\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className={cn(\r\n        'bg-gray-800 rounded-lg p-4 hover:bg-gray-700 transition-colors group cursor-pointer',\r\n        isSelected && 'ring-2 ring-blue-500'\r\n      )}\r\n    >\r\n      {/* Album Art Placeholder */}\r\n      <div className=\"aspect-square bg-gray-700 rounded-lg mb-3 flex items-center justify-center relative overflow-hidden\">\r\n        <Music className=\"w-12 h-12 text-gray-500\" />\r\n        \r\n        {/* Play Button Overlay */}\r\n        <button\r\n          onClick={handlePlay}\r\n          className=\"absolute inset-0 flex items-center justify-center bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity\"\r\n        >\r\n          <div className=\"w-12 h-12 bg-blue-600 hover:bg-blue-700 rounded-full flex items-center justify-center\">\r\n            <Play className=\"w-6 h-6 text-white ml-0.5\" />\r\n          </div>\r\n        </button>\r\n\r\n        {/* Selection Checkbox */}\r\n        <input\r\n          type=\"checkbox\"\r\n          checked={isSelected}\r\n          onChange={(e) => onSelect(e.target.checked)}\r\n          className=\"absolute top-2 right-2 rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500\"\r\n        />\r\n      </div>\r\n\r\n      {/* Track Info */}\r\n      <div className=\"space-y-1\">\r\n        <h3 className=\"text-white font-medium truncate\" title={track.title}>\r\n          {track.title}\r\n        </h3>\r\n        <p className=\"text-gray-400 text-sm truncate\" title={track.artist}>\r\n          {track.artist}\r\n        </p>\r\n        <p className=\"text-gray-500 text-xs truncate\" title={track.album}>\r\n          {track.album}\r\n        </p>\r\n        \r\n        <div className=\"flex items-center justify-between pt-1 text-xs text-gray-500\">\r\n          <span>{track.genre || 'Unknown'}</span>\r\n          <span>{track.year || ''}</span>\r\n        </div>\r\n        \r\n        <div className=\"flex items-center justify-between pt-1\">\r\n          <span className=\"text-gray-500 text-xs\">\r\n            {formatDuration(track.duration)}  {formatFileFormat(track.fileFormat)}\r\n          </span>\r\n          {track.rating && (\r\n            <span className=\"text-gray-500 text-xs\">\r\n              {formatRating(track.rating)}\r\n            </span>\r\n          )}\r\n        </div>\r\n        \r\n        {track.bitrate && (\r\n          <div className=\"text-gray-500 text-xs\">\r\n            {formatBitrate(track.bitrate)}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":";;;;;AAGA;AACA;AAAA;AACA;AALA;;;;;AAaO,SAAS,UAAU,EAAE,KAAK,EAAE,UAAU,EAAE,QAAQ,EAAkB;IACvE,MAAM,aAAa;QACjB,qCAAqC;QACrC,QAAQ,GAAG,CAAC,eAAe,MAAM,KAAK;IACxC;IAEA,qBACE,6LAAC;QACC,WAAW,IAAA,kIAAE,EACX,uFACA,cAAc;;0BAIhB,6LAAC;gBAAI,WAAU;;kCACb,6LAAC,gNAAK;wBAAC,WAAU;;;;;;kCAGjB,6LAAC;wBACC,SAAS;wBACT,WAAU;kCAEV,cAAA,6LAAC;4BAAI,WAAU;sCACb,cAAA,6LAAC,6MAAI;gCAAC,WAAU;;;;;;;;;;;;;;;;kCAKpB,6LAAC;wBACC,MAAK;wBACL,SAAS;wBACT,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,OAAO;wBAC1C,WAAU;;;;;;;;;;;;0BAKd,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAG,WAAU;wBAAkC,OAAO,MAAM,KAAK;kCAC/D,MAAM,KAAK;;;;;;kCAEd,6LAAC;wBAAE,WAAU;wBAAiC,OAAO,MAAM,MAAM;kCAC9D,MAAM,MAAM;;;;;;kCAEf,6LAAC;wBAAE,WAAU;wBAAiC,OAAO,MAAM,KAAK;kCAC7D,MAAM,KAAK;;;;;;kCAGd,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;0CAAM,MAAM,KAAK,IAAI;;;;;;0CACtB,6LAAC;0CAAM,MAAM,IAAI,IAAI;;;;;;;;;;;;kCAGvB,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAK,WAAU;;oCACb,IAAA,kJAAc,EAAC,MAAM,QAAQ;oCAAE;oCAAI,IAAA,oJAAgB,EAAC,MAAM,UAAU;;;;;;;4BAEtE,MAAM,MAAM,kBACX,6LAAC;gCAAK,WAAU;0CACb,IAAA,gJAAY,EAAC,MAAM,MAAM;;;;;;;;;;;;oBAK/B,MAAM,OAAO,kBACZ,6LAAC;wBAAI,WAAU;kCACZ,IAAA,iJAAa,EAAC,MAAM,OAAO;;;;;;;;;;;;;;;;;;AAMxC;KAxEgB"}},
    {"offset": {"line": 3798, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/components/ui/TrackGrid.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { TrackMetadata } from '@/lib/types/music'\r\nimport { TrackCard } from './TrackCard'\r\n\r\ninterface TrackGridProps {\r\n  tracks: TrackMetadata[]\r\n  selectedTrackIds: string[]\r\n  onTrackSelect: (trackId: string, isSelected: boolean) => void\r\n}\r\n\r\nexport function TrackGrid({ tracks, selectedTrackIds, onTrackSelect }: TrackGridProps) {\r\n  return (\r\n    <div className=\"p-6\">\r\n      <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-6\">\r\n        {tracks.map((track) => (\r\n          <TrackCard\r\n            key={track.id}\r\n            track={track}\r\n            isSelected={selectedTrackIds.includes(track.id)}\r\n            onSelect={(isSelected) => onTrackSelect(track.id, isSelected)}\r\n          />\r\n        ))}\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":";;;;;AAGA;AAHA;;;AAWO,SAAS,UAAU,EAAE,MAAM,EAAE,gBAAgB,EAAE,aAAa,EAAkB;IACnF,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;sBACZ,OAAO,GAAG,CAAC,CAAC,sBACX,6LAAC,qJAAS;oBAER,OAAO;oBACP,YAAY,iBAAiB,QAAQ,CAAC,MAAM,EAAE;oBAC9C,UAAU,CAAC,aAAe,cAAc,MAAM,EAAE,EAAE;mBAH7C,MAAM,EAAE;;;;;;;;;;;;;;;AASzB;KAfgB"}},
    {"offset": {"line": 3842, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/components/ui/TrackList.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { TrackMetadata } from '@/lib/types/music'\r\nimport { TrackRow } from './TrackRow'\r\nimport { TrackGrid } from './TrackGrid'\r\n\r\ninterface TrackListProps {\r\n  tracks: TrackMetadata[]\r\n  viewMode: 'list' | 'grid'\r\n  selectedTrackIds?: string[]\r\n  onSelectionChange?: (trackIds: string[]) => void\r\n  onDelete?: (trackId: string) => void\r\n  onEdit?: (trackId: string) => void\r\n  onAddToPlaylist?: (trackId: string) => void\r\n  onBulkEdit?: (trackIds: string[]) => void\r\n  onBulkAddToPlaylist?: (trackIds: string[]) => void\r\n  showSelection?: boolean\r\n  context?: 'library' | 'playlist'\r\n}\r\n\r\nexport function TrackList({\r\n  tracks,\r\n  viewMode,\r\n  selectedTrackIds = [],\r\n  onSelectionChange,\r\n  onDelete,\r\n  onEdit,\r\n  onAddToPlaylist,\r\n  onBulkEdit,\r\n  onBulkAddToPlaylist,\r\n  showSelection = false,\r\n  context = 'library',\r\n}: TrackListProps) {\r\n  const handleTrackSelect = (trackId: string, isSelected: boolean) => {\r\n    if (!onSelectionChange) return\r\n    \r\n    if (isSelected) {\r\n      onSelectionChange([...selectedTrackIds, trackId])\r\n    } else {\r\n      onSelectionChange(selectedTrackIds.filter(id => id !== trackId))\r\n    }\r\n  }\r\n\r\n  const handleSelectAll = () => {\r\n    if (!onSelectionChange) return\r\n    \r\n    if (selectedTrackIds.length === tracks.length) {\r\n      onSelectionChange([])\r\n    } else {\r\n      onSelectionChange(tracks.map(t => t.id))\r\n    }\r\n  }\r\n  if (viewMode === 'grid') {\r\n    return (\r\n      <TrackGrid\r\n        tracks={tracks}\r\n        selectedTrackIds={selectedTrackIds}\r\n        onTrackSelect={handleTrackSelect}\r\n      />\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex flex-col h-full\">\r\n      {/* Bulk actions bar */}\r\n      {showSelection && selectedTrackIds.length > 0 && (\r\n        <div className=\"flex items-center justify-between px-6 py-3 bg-blue-600 text-white\">\r\n          <span className=\"text-sm font-medium\">\r\n            {selectedTrackIds.length} track{selectedTrackIds.length !== 1 ? 's' : ''} selected\r\n          </span>\r\n          <div className=\"flex items-center gap-2\">\r\n            <button\r\n              onClick={() => onBulkEdit?.(selectedTrackIds)}\r\n              className=\"px-3 py-1 bg-blue-700 hover:bg-blue-800 rounded text-sm transition-colors\"\r\n            >\r\n              Edit Selected\r\n            </button>\r\n            {context === 'library' && onBulkAddToPlaylist && (\r\n              <button\r\n                onClick={() => onBulkAddToPlaylist(selectedTrackIds)}\r\n                className=\"px-3 py-1 bg-green-700 hover:bg-green-800 rounded text-sm transition-colors\"\r\n              >\r\n                Add to Playlist\r\n              </button>\r\n            )}\r\n            <button\r\n              onClick={() => onSelectionChange?.([])}\r\n              className=\"px-3 py-1 bg-blue-700 hover:bg-blue-800 rounded text-sm transition-colors\"\r\n            >\r\n              Clear Selection\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Header */}\r\n      <div className=\"flex items-center px-6 py-3 border-b border-gray-700 bg-gray-800\">\r\n        {showSelection && (\r\n          <input\r\n            type=\"checkbox\"\r\n            checked={selectedTrackIds.length === tracks.length && tracks.length > 0}\r\n            onChange={handleSelectAll}\r\n            className=\"mr-4 rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500\"\r\n          />\r\n        )}\r\n        <div className=\"flex-1 grid grid-cols-24 gap-2 text-xs font-medium text-gray-400 uppercase tracking-wider\">\r\n          <div className=\"col-span-4\">Title</div>\r\n          <div className=\"col-span-3\">Artist</div>\r\n          <div className=\"col-span-3\">Album</div>\r\n          <div className=\"col-span-2\">Genre</div>\r\n          <div className=\"col-span-1\">Year</div>\r\n          <div className=\"col-span-1\">Track</div>\r\n          <div className=\"col-span-1\">Disc</div>\r\n          <div className=\"col-span-2\">Duration</div>\r\n          <div className=\"col-span-2\">Bitrate</div>\r\n          <div className=\"col-span-1\">Format</div>\r\n          <div className=\"col-span-1\">Plays</div>\r\n          <div className=\"col-span-2\">Rating</div>\r\n          <div className=\"col-span-1\">Actions</div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Track List */}\r\n      <div className=\"flex-1 overflow-auto\">\r\n        {tracks.map((track, index) => (\r\n          <TrackRow\r\n            key={track.id}\r\n            track={track}\r\n            index={index}\r\n            isSelected={selectedTrackIds.includes(track.id)}\r\n            onSelect={showSelection ? (isSelected) => handleTrackSelect(track.id, isSelected) : undefined}\r\n            onDelete={onDelete}\r\n            onEdit={onEdit}\r\n            onAddToPlaylist={onAddToPlaylist}\r\n            context={context}\r\n          />\r\n        ))}\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":";;;;;AAGA;AACA;AAJA;;;;AAoBO,SAAS,UAAU,EACxB,MAAM,EACN,QAAQ,EACR,mBAAmB,EAAE,EACrB,iBAAiB,EACjB,QAAQ,EACR,MAAM,EACN,eAAe,EACf,UAAU,EACV,mBAAmB,EACnB,gBAAgB,KAAK,EACrB,UAAU,SAAS,EACJ;IACf,MAAM,oBAAoB,CAAC,SAAiB;QAC1C,IAAI,CAAC,mBAAmB;QAExB,IAAI,YAAY;YACd,kBAAkB;mBAAI;gBAAkB;aAAQ;QAClD,OAAO;YACL,kBAAkB,iBAAiB,MAAM,CAAC,CAAA,KAAM,OAAO;QACzD;IACF;IAEA,MAAM,kBAAkB;QACtB,IAAI,CAAC,mBAAmB;QAExB,IAAI,iBAAiB,MAAM,KAAK,OAAO,MAAM,EAAE;YAC7C,kBAAkB,EAAE;QACtB,OAAO;YACL,kBAAkB,OAAO,GAAG,CAAC,CAAA,IAAK,EAAE,EAAE;QACxC;IACF;IACA,IAAI,aAAa,QAAQ;QACvB,qBACE,6LAAC,qJAAS;YACR,QAAQ;YACR,kBAAkB;YAClB,eAAe;;;;;;IAGrB;IAEA,qBACE,6LAAC;QAAI,WAAU;;YAEZ,iBAAiB,iBAAiB,MAAM,GAAG,mBAC1C,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAK,WAAU;;4BACb,iBAAiB,MAAM;4BAAC;4BAAO,iBAAiB,MAAM,KAAK,IAAI,MAAM;4BAAG;;;;;;;kCAE3E,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCACC,SAAS,IAAM,aAAa;gCAC5B,WAAU;0CACX;;;;;;4BAGA,YAAY,aAAa,qCACxB,6LAAC;gCACC,SAAS,IAAM,oBAAoB;gCACnC,WAAU;0CACX;;;;;;0CAIH,6LAAC;gCACC,SAAS,IAAM,oBAAoB,EAAE;gCACrC,WAAU;0CACX;;;;;;;;;;;;;;;;;;0BAQP,6LAAC;gBAAI,WAAU;;oBACZ,+BACC,6LAAC;wBACC,MAAK;wBACL,SAAS,iBAAiB,MAAM,KAAK,OAAO,MAAM,IAAI,OAAO,MAAM,GAAG;wBACtE,UAAU;wBACV,WAAU;;;;;;kCAGd,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;0CAAa;;;;;;0CAC5B,6LAAC;gCAAI,WAAU;0CAAa;;;;;;0CAC5B,6LAAC;gCAAI,WAAU;0CAAa;;;;;;0CAC5B,6LAAC;gCAAI,WAAU;0CAAa;;;;;;0CAC5B,6LAAC;gCAAI,WAAU;0CAAa;;;;;;0CAC5B,6LAAC;gCAAI,WAAU;0CAAa;;;;;;0CAC5B,6LAAC;gCAAI,WAAU;0CAAa;;;;;;0CAC5B,6LAAC;gCAAI,WAAU;0CAAa;;;;;;0CAC5B,6LAAC;gCAAI,WAAU;0CAAa;;;;;;0CAC5B,6LAAC;gCAAI,WAAU;0CAAa;;;;;;0CAC5B,6LAAC;gCAAI,WAAU;0CAAa;;;;;;0CAC5B,6LAAC;gCAAI,WAAU;0CAAa;;;;;;0CAC5B,6LAAC;gCAAI,WAAU;0CAAa;;;;;;;;;;;;;;;;;;0BAKhC,6LAAC;gBAAI,WAAU;0BACZ,OAAO,GAAG,CAAC,CAAC,OAAO,sBAClB,6LAAC,mJAAQ;wBAEP,OAAO;wBACP,OAAO;wBACP,YAAY,iBAAiB,QAAQ,CAAC,MAAM,EAAE;wBAC9C,UAAU,gBAAgB,CAAC,aAAe,kBAAkB,MAAM,EAAE,EAAE,cAAc;wBACpF,UAAU;wBACV,QAAQ;wBACR,iBAAiB;wBACjB,SAAS;uBARJ,MAAM,EAAE;;;;;;;;;;;;;;;;AAczB;KAxHgB"}},
    {"offset": {"line": 4115, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/components/ui/ViewControls.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { TrackMetadata } from '@/lib/types/music'\r\nimport { List, Grid, ArrowUpDown } from 'lucide-react'\r\n\r\ninterface ViewControlsProps {\r\n  viewMode: 'list' | 'grid'\r\n  onViewModeChange: (mode: 'list' | 'grid') => void\r\n  sortBy: keyof TrackMetadata\r\n  sortOrder: 'asc' | 'desc'\r\n  onSortChange: (sortBy: keyof TrackMetadata, sortOrder: 'asc' | 'desc') => void\r\n}\r\n\r\nconst sortOptions = [\r\n  { key: 'title', label: 'Title' },\r\n  { key: 'artist', label: 'Artist' },\r\n  { key: 'album', label: 'Album' },\r\n  { key: 'genre', label: 'Genre' },\r\n  { key: 'year', label: 'Year' },\r\n  { key: 'trackNumber', label: 'Track Number' },\r\n  { key: 'discNumber', label: 'Disc Number' },\r\n  { key: 'duration', label: 'Duration' },\r\n  { key: 'bitrate', label: 'Bitrate' },\r\n  { key: 'fileFormat', label: 'File Format' },\r\n  { key: 'dateAdded', label: 'Date Added' },\r\n  { key: 'playCount', label: 'Play Count' },\r\n  { key: 'rating', label: 'Rating' },\r\n] as const\r\n\r\nexport function ViewControls({\r\n  viewMode,\r\n  onViewModeChange,\r\n  sortBy,\r\n  sortOrder,\r\n  onSortChange,\r\n}: ViewControlsProps) {\r\n  return (\r\n    <div className=\"flex items-center gap-4\">\r\n      {/* Sort Controls */}\r\n      <div className=\"flex items-center gap-2\">\r\n        <select\r\n          value={sortBy}\r\n          onChange={(e) => onSortChange(e.target.value as keyof TrackMetadata, sortOrder)}\r\n          className=\"px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white text-sm\"\r\n        >\r\n          {sortOptions.map(option => (\r\n            <option key={option.key} value={option.key}>\r\n              {option.label}\r\n            </option>\r\n          ))}\r\n        </select>\r\n        \r\n        <button\r\n          onClick={() => onSortChange(sortBy, sortOrder === 'asc' ? 'desc' : 'asc')}\r\n          className=\"p-2 bg-gray-800 border border-gray-600 rounded-lg text-white hover:bg-gray-700 transition-colors\"\r\n          title={`Sort ${sortOrder === 'asc' ? 'descending' : 'ascending'}`}\r\n        >\r\n          <ArrowUpDown className={`w-4 h-4 ${sortOrder === 'desc' ? 'rotate-180' : ''}`} />\r\n        </button>\r\n      </div>\r\n\r\n      {/* View Mode Toggle */}\r\n      <div className=\"flex bg-gray-800 border border-gray-600 rounded-lg\">\r\n        <button\r\n          onClick={() => onViewModeChange('list')}\r\n          className={`p-2 rounded-l-lg transition-colors ${\r\n            viewMode === 'list'\r\n              ? 'bg-blue-600 text-white'\r\n              : 'text-gray-400 hover:text-white hover:bg-gray-700'\r\n          }`}\r\n          title=\"List view\"\r\n        >\r\n          <List className=\"w-4 h-4\" />\r\n        </button>\r\n        <button\r\n          onClick={() => onViewModeChange('grid')}\r\n          className={`p-2 rounded-r-lg transition-colors ${\r\n            viewMode === 'grid'\r\n              ? 'bg-blue-600 text-white'\r\n              : 'text-gray-400 hover:text-white hover:bg-gray-700'\r\n          }`}\r\n          title=\"Grid view\"\r\n        >\r\n          <Grid className=\"w-4 h-4\" />\r\n        </button>\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":";;;;;AAGA;AAAA;AAAA;AAHA;;;AAaA,MAAM,cAAc;IAClB;QAAE,KAAK;QAAS,OAAO;IAAQ;IAC/B;QAAE,KAAK;QAAU,OAAO;IAAS;IACjC;QAAE,KAAK;QAAS,OAAO;IAAQ;IAC/B;QAAE,KAAK;QAAS,OAAO;IAAQ;IAC/B;QAAE,KAAK;QAAQ,OAAO;IAAO;IAC7B;QAAE,KAAK;QAAe,OAAO;IAAe;IAC5C;QAAE,KAAK;QAAc,OAAO;IAAc;IAC1C;QAAE,KAAK;QAAY,OAAO;IAAW;IACrC;QAAE,KAAK;QAAW,OAAO;IAAU;IACnC;QAAE,KAAK;QAAc,OAAO;IAAc;IAC1C;QAAE,KAAK;QAAa,OAAO;IAAa;IACxC;QAAE,KAAK;QAAa,OAAO;IAAa;IACxC;QAAE,KAAK;QAAU,OAAO;IAAS;CAClC;AAEM,SAAS,aAAa,EAC3B,QAAQ,EACR,gBAAgB,EAChB,MAAM,EACN,SAAS,EACT,YAAY,EACM;IAClB,qBACE,6LAAC;QAAI,WAAU;;0BAEb,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBACC,OAAO;wBACP,UAAU,CAAC,IAAM,aAAa,EAAE,MAAM,CAAC,KAAK,EAAyB;wBACrE,WAAU;kCAET,YAAY,GAAG,CAAC,CAAA,uBACf,6LAAC;gCAAwB,OAAO,OAAO,GAAG;0CACvC,OAAO,KAAK;+BADF,OAAO,GAAG;;;;;;;;;;kCAM3B,6LAAC;wBACC,SAAS,IAAM,aAAa,QAAQ,cAAc,QAAQ,SAAS;wBACnE,WAAU;wBACV,OAAO,CAAC,KAAK,EAAE,cAAc,QAAQ,eAAe,aAAa;kCAEjE,cAAA,6LAAC,0OAAW;4BAAC,WAAW,CAAC,QAAQ,EAAE,cAAc,SAAS,eAAe,IAAI;;;;;;;;;;;;;;;;;0BAKjF,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBACC,SAAS,IAAM,iBAAiB;wBAChC,WAAW,CAAC,mCAAmC,EAC7C,aAAa,SACT,2BACA,oDACJ;wBACF,OAAM;kCAEN,cAAA,6LAAC,6MAAI;4BAAC,WAAU;;;;;;;;;;;kCAElB,6LAAC;wBACC,SAAS,IAAM,iBAAiB;wBAChC,WAAW,CAAC,mCAAmC,EAC7C,aAAa,SACT,2BACA,oDACJ;wBACF,OAAM;kCAEN,cAAA,6LAAC,oNAAI;4BAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;AAK1B;KA3DgB"}},
    {"offset": {"line": 4284, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/components/ui/EmptyState.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { LucideIcon } from 'lucide-react'\r\n\r\ninterface EmptyStateProps {\r\n  icon: LucideIcon\r\n  title: string\r\n  description: string\r\n  actionLabel?: string\r\n  onAction?: () => void\r\n}\r\n\r\nexport function EmptyState({ \r\n  icon: Icon, \r\n  title, \r\n  description, \r\n  actionLabel, \r\n  onAction \r\n}: EmptyStateProps) {\r\n  return (\r\n    <div className=\"text-center py-12\">\r\n      <Icon className=\"w-16 h-16 mx-auto text-gray-500 mb-4\" />\r\n      <h3 className=\"text-lg font-semibold text-white mb-2\">{title}</h3>\r\n      <p className=\"text-gray-400 mb-6 max-w-md mx-auto\">{description}</p>\r\n      \r\n      {actionLabel && onAction && (\r\n        <button\r\n          onClick={onAction}\r\n          className=\"px-6 py-3 bg-blue-600 hover:bg-blue-700 rounded-lg text-white font-medium transition-colors\"\r\n        >\r\n          {actionLabel}\r\n        </button>\r\n      )}\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":";;;;;AAAA;;AAYO,SAAS,WAAW,EACzB,MAAM,IAAI,EACV,KAAK,EACL,WAAW,EACX,WAAW,EACX,QAAQ,EACQ;IAChB,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAK,WAAU;;;;;;0BAChB,6LAAC;gBAAG,WAAU;0BAAyC;;;;;;0BACvD,6LAAC;gBAAE,WAAU;0BAAuC;;;;;;YAEnD,eAAe,0BACd,6LAAC;gBACC,SAAS;gBACT,WAAU;0BAET;;;;;;;;;;;;AAKX;KAvBgB"}},
    {"offset": {"line": 4344, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/components/modals/EditTrackModal.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport { TrackMetadata } from '@/lib/types/music'\r\nimport { useMusicStore } from '@/lib/store/music-store'\r\nimport { tagService } from '@/lib/services/tag-service'\r\nimport { X, Plus, Trash2, Star } from 'lucide-react'\r\n\r\ninterface EditTrackModalProps {\r\n  isOpen: boolean\r\n  onClose: () => void\r\n  track: TrackMetadata | null\r\n  tracks?: TrackMetadata[] // For bulk editing\r\n  isBulkEdit?: boolean\r\n}\r\n\r\nexport function EditTrackModal({ \r\n  isOpen, \r\n  onClose, \r\n  track, \r\n  tracks = [], \r\n  isBulkEdit = false \r\n}: EditTrackModalProps) {\r\n  const { updateTrack, tracks: allTracks } = useMusicStore()\r\n  \r\n  // Form state\r\n  const [title, setTitle] = useState('')\r\n  const [artist, setArtist] = useState('')\r\n  const [album, setAlbum] = useState('')\r\n  const [genre, setGenre] = useState('')\r\n  const [year, setYear] = useState<number | ''>('')\r\n  const [trackNumber, setTrackNumber] = useState<number | ''>('')\r\n  const [discNumber, setDiscNumber] = useState<number | ''>('')\r\n  const [rating, setRating] = useState<number>(0)\r\n  const [mood, setMood] = useState('')\r\n  const [customTags, setCustomTags] = useState<string[]>([])\r\n  const [newTag, setNewTag] = useState('')\r\n  const [showTagSuggestions, setShowTagSuggestions] = useState(false)\r\n  const [showMoodSuggestions, setShowMoodSuggestions] = useState(false)\r\n  \r\n  // Bulk edit specific state\r\n  const [bulkFields, setBulkFields] = useState({\r\n    genre: false,\r\n    year: false,\r\n    rating: false,\r\n    mood: false,\r\n    customTags: false,\r\n  })\r\n\r\n  // Initialize form with track data\r\n  useEffect(() => {\r\n    if (track && !isBulkEdit) {\r\n      setTitle(track.title)\r\n      setArtist(track.artist)\r\n      setAlbum(track.album)\r\n      setGenre(track.genre || '')\r\n      setYear(track.year || '')\r\n      setTrackNumber(track.trackNumber || '')\r\n      setDiscNumber(track.discNumber || '')\r\n      setRating(track.rating || 0)\r\n      setMood(track.mood || '')\r\n      setCustomTags([...(track.customTags || [])])\r\n    } else if (isBulkEdit) {\r\n      // Reset form for bulk edit\r\n      setTitle('')\r\n      setArtist('')\r\n      setAlbum('')\r\n      setGenre('')\r\n      setYear('')\r\n      setTrackNumber('')\r\n      setDiscNumber('')\r\n      setRating(0)\r\n      setMood('')\r\n      setCustomTags([])\r\n      setBulkFields({\r\n        genre: false,\r\n        year: false,\r\n        rating: false,\r\n        mood: false,\r\n        customTags: false,\r\n      })\r\n    }\r\n  }, [track, isBulkEdit, isOpen])\r\n\r\n  const handleAddTag = () => {\r\n    if (newTag.trim() && !customTags.includes(newTag.trim())) {\r\n      const normalizedTags = tagService.normalizeTags([...customTags, newTag.trim()])\r\n      setCustomTags(normalizedTags)\r\n      setNewTag('')\r\n      setShowTagSuggestions(false)\r\n    }\r\n  }\r\n\r\n  const handleAddSuggestedTag = (tag: string) => {\r\n    if (!customTags.includes(tag)) {\r\n      setCustomTags([...customTags, tag])\r\n    }\r\n    setShowTagSuggestions(false)\r\n  }\r\n\r\n  const handleAddSuggestedMood = (mood: string) => {\r\n    setMood(mood)\r\n    setShowMoodSuggestions(false)\r\n  }\r\n\r\n  const handleRemoveTag = (tagToRemove: string) => {\r\n    setCustomTags(customTags.filter(tag => tag !== tagToRemove))\r\n  }\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault()\r\n    \r\n    if (isBulkEdit) {\r\n      // Bulk update selected tracks\r\n      for (const trackToUpdate of tracks) {\r\n        const updatedTrack: TrackMetadata = {\r\n          ...trackToUpdate,\r\n          ...(bulkFields.genre && { genre }),\r\n          ...(bulkFields.year && year && { year: Number(year) }),\r\n          ...(bulkFields.rating && { rating }),\r\n          ...(bulkFields.mood && { mood: mood ? tagService.normalizeMood(mood) : undefined }),\r\n          ...(bulkFields.customTags && { \r\n            customTags: tagService.normalizeTags([...trackToUpdate.customTags, ...customTags])\r\n          }),\r\n        }\r\n        await updateTrack(updatedTrack)\r\n      }\r\n    } else if (track) {\r\n      // Single track update\r\n      const updatedTrack: TrackMetadata = {\r\n        ...track,\r\n        title,\r\n        artist,\r\n        album,\r\n        genre: genre || undefined,\r\n        year: year ? Number(year) : undefined,\r\n        trackNumber: trackNumber ? Number(trackNumber) : undefined,\r\n        discNumber: discNumber ? Number(discNumber) : undefined,\r\n        rating,\r\n        mood: mood ? tagService.normalizeMood(mood) : undefined,\r\n        customTags: tagService.normalizeTags(customTags),\r\n      }\r\n      await updateTrack(updatedTrack)\r\n    }\r\n    \r\n    onClose()\r\n  }\r\n\r\n  const renderStarRating = () => (\r\n    <div className=\"flex items-center gap-1\">\r\n      {[1, 2, 3, 4, 5].map((star) => (\r\n        <button\r\n          key={star}\r\n          type=\"button\"\r\n          onClick={() => setRating(star === rating ? 0 : star)}\r\n          className={`p-1 rounded transition-colors ${\r\n            star <= rating \r\n              ? 'text-yellow-400 hover:text-yellow-300' \r\n              : 'text-gray-400 hover:text-gray-300'\r\n          }`}\r\n        >\r\n          <Star className={`w-5 h-5 ${star <= rating ? 'fill-current' : ''}`} />\r\n        </button>\r\n      ))}\r\n      <span className=\"ml-2 text-sm text-gray-400\">\r\n        {rating > 0 ? `${rating}/5` : 'No rating'}\r\n      </span>\r\n    </div>\r\n  )\r\n\r\n  if (!isOpen) return null\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-gray-800 rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto\">\r\n        <div className=\"flex items-center justify-between mb-6\">\r\n          <h2 className=\"text-xl font-bold text-white\">\r\n            {isBulkEdit \r\n              ? `Edit ${tracks.length} Tracks` \r\n              : `Edit Track: ${track?.title}`\r\n            }\r\n          </h2>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"text-gray-400 hover:text-white transition-colors\"\r\n          >\r\n            <X className=\"w-6 h-6\" />\r\n          </button>\r\n        </div>\r\n\r\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n          {!isBulkEdit && (\r\n            <>\r\n              {/* Basic metadata fields for single track edit */}\r\n              <div className=\"grid grid-cols-2 gap-4\">\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-300 mb-1\">\r\n                    Title\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={title}\r\n                    onChange={(e) => setTitle(e.target.value)}\r\n                    className=\"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                    required\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-300 mb-1\">\r\n                    Artist\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={artist}\r\n                    onChange={(e) => setArtist(e.target.value)}\r\n                    className=\"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                    required\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"grid grid-cols-2 gap-4\">\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-300 mb-1\">\r\n                    Album\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={album}\r\n                    onChange={(e) => setAlbum(e.target.value)}\r\n                    className=\"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                    required\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-300 mb-1\">\r\n                    Genre\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={genre}\r\n                    onChange={(e) => setGenre(e.target.value)}\r\n                    className=\"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"grid grid-cols-3 gap-4\">\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-300 mb-1\">\r\n                    Year\r\n                  </label>\r\n                  <input\r\n                    type=\"number\"\r\n                    value={year}\r\n                    onChange={(e) => setYear(e.target.value ? Number(e.target.value) : '')}\r\n                    className=\"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                    min=\"1900\"\r\n                    max=\"2100\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-300 mb-1\">\r\n                    Track #\r\n                  </label>\r\n                  <input\r\n                    type=\"number\"\r\n                    value={trackNumber}\r\n                    onChange={(e) => setTrackNumber(e.target.value ? Number(e.target.value) : '')}\r\n                    className=\"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                    min=\"1\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-300 mb-1\">\r\n                    Disc #\r\n                  </label>\r\n                  <input\r\n                    type=\"number\"\r\n                    value={discNumber}\r\n                    onChange={(e) => setDiscNumber(e.target.value ? Number(e.target.value) : '')}\r\n                    className=\"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                    min=\"1\"\r\n                  />\r\n                </div>\r\n              </div>\r\n            </>\r\n          )}\r\n\r\n          {/* Fields available for both single and bulk edit */}\r\n          <div className=\"space-y-4 border-t border-gray-600 pt-4\">\r\n            <h3 className=\"text-lg font-medium text-white\">\r\n              {isBulkEdit ? 'Bulk Edit Fields' : 'Additional Metadata'}\r\n            </h3>\r\n\r\n            {/* Genre for bulk edit */}\r\n            {isBulkEdit && (\r\n              <div className=\"flex items-center gap-3\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  id=\"bulk-genre\"\r\n                  checked={bulkFields.genre}\r\n                  onChange={(e) => setBulkFields(prev => ({ ...prev, genre: e.target.checked }))}\r\n                  className=\"rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500\"\r\n                />\r\n                <label htmlFor=\"bulk-genre\" className=\"text-sm font-medium text-gray-300 flex-1\">\r\n                  Genre\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={genre}\r\n                  onChange={(e) => setGenre(e.target.value)}\r\n                  disabled={!bulkFields.genre}\r\n                  className=\"px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                  placeholder=\"Enter genre\"\r\n                />\r\n              </div>\r\n            )}\r\n\r\n            {/* Year for bulk edit */}\r\n            {isBulkEdit && (\r\n              <div className=\"flex items-center gap-3\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  id=\"bulk-year\"\r\n                  checked={bulkFields.year}\r\n                  onChange={(e) => setBulkFields(prev => ({ ...prev, year: e.target.checked }))}\r\n                  className=\"rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500\"\r\n                />\r\n                <label htmlFor=\"bulk-year\" className=\"text-sm font-medium text-gray-300 flex-1\">\r\n                  Year\r\n                </label>\r\n                <input\r\n                  type=\"number\"\r\n                  value={year}\r\n                  onChange={(e) => setYear(e.target.value ? Number(e.target.value) : '')}\r\n                  disabled={!bulkFields.year}\r\n                  className=\"px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                  placeholder=\"Enter year\"\r\n                  min=\"1900\"\r\n                  max=\"2100\"\r\n                />\r\n              </div>\r\n            )}\r\n\r\n            {/* Rating */}\r\n            <div className={isBulkEdit ? \"flex items-center gap-3\" : \"\"}>\r\n              {isBulkEdit && (\r\n                <>\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    id=\"bulk-rating\"\r\n                    checked={bulkFields.rating}\r\n                    onChange={(e) => setBulkFields(prev => ({ ...prev, rating: e.target.checked }))}\r\n                    className=\"rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500\"\r\n                  />\r\n                  <label htmlFor=\"bulk-rating\" className=\"text-sm font-medium text-gray-300 flex-1\">\r\n                    Rating\r\n                  </label>\r\n                </>\r\n              )}\r\n              {!isBulkEdit && (\r\n                <label className=\"block text-sm font-medium text-gray-300 mb-2\">\r\n                  Rating\r\n                </label>\r\n              )}\r\n              <div className={isBulkEdit && !bulkFields.rating ? \"opacity-50 pointer-events-none\" : \"\"}>\r\n                {renderStarRating()}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Mood */}\r\n            <div className={isBulkEdit ? \"flex items-center gap-3\" : \"\"}>\r\n              {isBulkEdit && (\r\n                <>\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    id=\"bulk-mood\"\r\n                    checked={bulkFields.mood}\r\n                    onChange={(e) => setBulkFields(prev => ({ ...prev, mood: e.target.checked }))}\r\n                    className=\"rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500\"\r\n                  />\r\n                  <label htmlFor=\"bulk-mood\" className=\"text-sm font-medium text-gray-300 w-20\">\r\n                    Mood\r\n                  </label>\r\n                </>\r\n              )}\r\n              {!isBulkEdit && (\r\n                <label className=\"block text-sm font-medium text-gray-300 mb-1\">\r\n                  Mood\r\n                </label>\r\n              )}\r\n              <div className={`relative ${isBulkEdit ? 'flex-1' : 'w-full'}`}>\r\n                <input\r\n                  type=\"text\"\r\n                  value={mood}\r\n                  onChange={(e) => setMood(e.target.value)}\r\n                  onFocus={() => setShowMoodSuggestions(true)}\r\n                  onBlur={() => setTimeout(() => setShowMoodSuggestions(false), 200)}\r\n                  disabled={isBulkEdit && !bulkFields.mood}\r\n                  className=\"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                  placeholder=\"e.g., Happy, Melancholic, Energetic\"\r\n                />\r\n                \r\n                {/* Mood Suggestions */}\r\n                {showMoodSuggestions && (\r\n                  <div className=\"absolute top-full left-0 right-0 mt-1 bg-gray-800 border border-gray-600 rounded-md shadow-lg z-20 max-h-40 overflow-y-auto\">\r\n                    {/* Predefined moods */}\r\n                    <div className=\"p-2 border-b border-gray-600\">\r\n                      <div className=\"text-xs text-gray-400 mb-1\">Suggested</div>\r\n                      <div className=\"flex flex-wrap gap-1\">\r\n                        {tagService.getPredefinedMoods().slice(0, 10).map((suggestedMood) => (\r\n                          <button\r\n                            key={suggestedMood}\r\n                            type=\"button\"\r\n                            onClick={() => handleAddSuggestedMood(suggestedMood)}\r\n                            className=\"px-2 py-1 text-xs bg-gray-700 hover:bg-gray-600 text-gray-300 rounded transition-colors\"\r\n                          >\r\n                            {suggestedMood}\r\n                          </button>\r\n                        ))}\r\n                      </div>\r\n                    </div>\r\n                    \r\n                    {/* Existing moods from library */}\r\n                    {tagService.getMoodSuggestions(allTracks, mood, 5).length > 0 && (\r\n                      <div className=\"p-2\">\r\n                        <div className=\"text-xs text-gray-400 mb-1\">From your library</div>\r\n                        {tagService.getMoodSuggestions(allTracks, mood, 5).map(({ mood: existingMood, count }) => (\r\n                          <button\r\n                            key={existingMood}\r\n                            type=\"button\"\r\n                            onClick={() => handleAddSuggestedMood(existingMood)}\r\n                            className=\"block w-full text-left px-2 py-1 text-sm text-gray-300 hover:bg-gray-700 rounded transition-colors\"\r\n                          >\r\n                            {existingMood} <span className=\"text-gray-500\">({count})</span>\r\n                          </button>\r\n                        ))}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Custom Tags */}\r\n            <div className={isBulkEdit ? \"flex items-start gap-3\" : \"\"}>\r\n              {isBulkEdit && (\r\n                <>\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    id=\"bulk-tags\"\r\n                    checked={bulkFields.customTags}\r\n                    onChange={(e) => setBulkFields(prev => ({ ...prev, customTags: e.target.checked }))}\r\n                    className=\"rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500 mt-2\"\r\n                  />\r\n                  <label htmlFor=\"bulk-tags\" className=\"text-sm font-medium text-gray-300 w-20 mt-2\">\r\n                    Add Tags\r\n                  </label>\r\n                </>\r\n              )}\r\n              <div className={`${isBulkEdit ? 'flex-1' : 'w-full'} ${isBulkEdit && !bulkFields.customTags ? \"opacity-50 pointer-events-none\" : \"\"}`}>\r\n                {!isBulkEdit && (\r\n                  <label className=\"block text-sm font-medium text-gray-300 mb-2\">\r\n                    Custom Tags\r\n                  </label>\r\n                )}\r\n                \r\n                {/* Add new tag */}\r\n                <div className=\"relative\">\r\n                  <div className=\"flex gap-2 mb-3\">\r\n                    <input\r\n                      type=\"text\"\r\n                      value={newTag}\r\n                      onChange={(e) => setNewTag(e.target.value)}\r\n                      onFocus={() => setShowTagSuggestions(true)}\r\n                      onBlur={() => setTimeout(() => setShowTagSuggestions(false), 200)}\r\n                      onKeyPress={(e) => e.key === 'Enter' && (e.preventDefault(), handleAddTag())}\r\n                      className=\"flex-1 px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                      placeholder=\"Add a tag...\"\r\n                    />\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={handleAddTag}\r\n                      className=\"px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors\"\r\n                    >\r\n                      <Plus className=\"w-4 h-4\" />\r\n                    </button>\r\n                  </div>\r\n\r\n                  {/* Tag Suggestions */}\r\n                  {showTagSuggestions && (\r\n                    <div className=\"absolute top-full left-0 right-0 mt-1 bg-gray-800 border border-gray-600 rounded-md shadow-lg z-20 max-h-40 overflow-y-auto\">\r\n                      {/* Predefined tags */}\r\n                      <div className=\"p-2 border-b border-gray-600\">\r\n                        <div className=\"text-xs text-gray-400 mb-1\">Suggested</div>\r\n                        <div className=\"flex flex-wrap gap-1\">\r\n                          {tagService.getPredefinedTags().slice(0, 10).map((suggestedTag) => (\r\n                            <button\r\n                              key={suggestedTag}\r\n                              type=\"button\"\r\n                              onClick={() => handleAddSuggestedTag(suggestedTag)}\r\n                              className=\"px-2 py-1 text-xs bg-gray-700 hover:bg-gray-600 text-gray-300 rounded transition-colors\"\r\n                            >\r\n                              {suggestedTag}\r\n                            </button>\r\n                          ))}\r\n                        </div>\r\n                      </div>\r\n                      \r\n                      {/* Existing tags from library */}\r\n                      {tagService.getTagSuggestions(allTracks, newTag, 5).length > 0 && (\r\n                        <div className=\"p-2\">\r\n                          <div className=\"text-xs text-gray-400 mb-1\">From your library</div>\r\n                          {tagService.getTagSuggestions(allTracks, newTag, 5).map(({ tag, count }) => (\r\n                            <button\r\n                              key={tag}\r\n                              type=\"button\"\r\n                              onClick={() => handleAddSuggestedTag(tag)}\r\n                              className=\"block w-full text-left px-2 py-1 text-sm text-gray-300 hover:bg-gray-700 rounded transition-colors\"\r\n                            >\r\n                              {tag} <span className=\"text-gray-500\">({count})</span>\r\n                            </button>\r\n                          ))}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n\r\n                {/* Existing tags */}\r\n                <div className=\"flex flex-wrap gap-2\">\r\n                  {customTags.map((tag, index) => (\r\n                    <span\r\n                      key={index}\r\n                      className=\"inline-flex items-center gap-1 px-2 py-1 bg-blue-600 text-white text-sm rounded-full\"\r\n                    >\r\n                      {tag}\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={() => handleRemoveTag(tag)}\r\n                        className=\"text-blue-200 hover:text-white transition-colors\"\r\n                      >\r\n                        <X className=\"w-3 h-3\" />\r\n                      </button>\r\n                    </span>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Action buttons */}\r\n          <div className=\"flex justify-end gap-3 pt-4 border-t border-gray-600\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={onClose}\r\n              className=\"px-4 py-2 text-gray-300 hover:text-white transition-colors\"\r\n            >\r\n              Cancel\r\n            </button>\r\n            <button\r\n              type=\"submit\"\r\n              className=\"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors\"\r\n            >\r\n              {isBulkEdit ? `Update ${tracks.length} Tracks` : 'Save Changes'}\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5395, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/components/modals/TagManagementModal.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport { useMusicStore } from '@/lib/store/music-store'\r\nimport { tagService, TagSuggestion, MoodSuggestion } from '@/lib/services/tag-service'\r\nimport { X, Trash2, Edit, Merge } from 'lucide-react'\r\n\r\ninterface TagManagementModalProps {\r\n  isOpen: boolean\r\n  onClose: () => void\r\n}\r\n\r\nexport function TagManagementModal({ isOpen, onClose }: TagManagementModalProps) {\r\n  const { tracks, updateTrack } = useMusicStore()\r\n  const [activeTab, setActiveTab] = useState<'tags' | 'moods' | 'cleanup'>('tags')\r\n  const [allTags, setAllTags] = useState<TagSuggestion[]>([])\r\n  const [allMoods, setAllMoods] = useState<MoodSuggestion[]>([])\r\n  const [similarTags, setSimilarTags] = useState<Array<{ original: string; similar: string[]; count: number }>>([])\r\n  const [selectedTags, setSelectedTags] = useState<string[]>([])\r\n  const [editingTag, setEditingTag] = useState<string | null>(null)\r\n  const [newTagName, setNewTagName] = useState('')\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      setAllTags(tagService.getAllTags(tracks))\r\n      setAllMoods(tagService.getAllMoods(tracks))\r\n      setSimilarTags(tagService.findSimilarTags(tracks))\r\n    }\r\n  }, [isOpen, tracks])\r\n\r\n  const handleDeleteTag = async (tagToDelete: string) => {\r\n    if (!confirm(`Are you sure you want to delete the tag \"${tagToDelete}\" from all tracks?`)) {\r\n      return\r\n    }\r\n\r\n    const tracksWithTag = tracks.filter(track => track.customTags.includes(tagToDelete))\r\n    \r\n    for (const track of tracksWithTag) {\r\n      const updatedTrack = {\r\n        ...track,\r\n        customTags: track.customTags.filter(tag => tag !== tagToDelete)\r\n      }\r\n      await updateTrack(updatedTrack)\r\n    }\r\n\r\n    // Refresh data\r\n    setAllTags(tagService.getAllTags(tracks))\r\n  }\r\n\r\n  const handleRenameTag = async (oldTag: string, newTag: string) => {\r\n    if (!newTag.trim() || oldTag === newTag) return\r\n\r\n    const normalizedNewTag = tagService.normalizeTags([newTag])[0]\r\n    const tracksWithTag = tracks.filter(track => track.customTags.includes(oldTag))\r\n    \r\n    for (const track of tracksWithTag) {\r\n      const updatedTags = track.customTags.map(tag => tag === oldTag ? normalizedNewTag : tag)\r\n      const updatedTrack = {\r\n        ...track,\r\n        customTags: tagService.normalizeTags(updatedTags)\r\n      }\r\n      await updateTrack(updatedTrack)\r\n    }\r\n\r\n    setEditingTag(null)\r\n    setNewTagName('')\r\n    setAllTags(tagService.getAllTags(tracks))\r\n  }\r\n\r\n  const handleMergeTags = async (originalTag: string, tagsToMerge: string[]) => {\r\n    if (!confirm(`Merge ${tagsToMerge.length} similar tags into \"${originalTag}\"?`)) {\r\n      return\r\n    }\r\n\r\n    const allTagsToMerge = [originalTag, ...tagsToMerge]\r\n    const tracksToUpdate = tracks.filter(track => \r\n      track.customTags.some(tag => allTagsToMerge.includes(tag))\r\n    )\r\n\r\n    for (const track of tracksToUpdate) {\r\n      const updatedTags = track.customTags.filter(tag => !allTagsToMerge.includes(tag))\r\n      updatedTags.push(originalTag)\r\n      \r\n      const updatedTrack = {\r\n        ...track,\r\n        customTags: tagService.normalizeTags(updatedTags)\r\n      }\r\n      await updateTrack(updatedTrack)\r\n    }\r\n\r\n    // Refresh data\r\n    setAllTags(tagService.getAllTags(tracks))\r\n    setSimilarTags(tagService.findSimilarTags(tracks))\r\n  }\r\n\r\n  const handleBulkDeleteTags = async () => {\r\n    if (selectedTags.length === 0) return\r\n    \r\n    if (!confirm(`Delete ${selectedTags.length} selected tags from all tracks?`)) {\r\n      return\r\n    }\r\n\r\n    const tracksToUpdate = tracks.filter(track => \r\n      track.customTags.some(tag => selectedTags.includes(tag))\r\n    )\r\n\r\n    for (const track of tracksToUpdate) {\r\n      const updatedTrack = {\r\n        ...track,\r\n        customTags: track.customTags.filter(tag => !selectedTags.includes(tag))\r\n      }\r\n      await updateTrack(updatedTrack)\r\n    }\r\n\r\n    setSelectedTags([])\r\n    setAllTags(tagService.getAllTags(tracks))\r\n  }\r\n\r\n  if (!isOpen) return null\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-gray-800 rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto\">\r\n        <div className=\"flex items-center justify-between mb-6\">\r\n          <h2 className=\"text-xl font-bold text-white\">Tag Management</h2>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"text-gray-400 hover:text-white transition-colors\"\r\n          >\r\n            <X className=\"w-6 h-6\" />\r\n          </button>\r\n        </div>\r\n\r\n        {/* Tabs */}\r\n        <div className=\"flex border-b border-gray-600 mb-6\">\r\n          <button\r\n            onClick={() => setActiveTab('tags')}\r\n            className={`px-4 py-2 font-medium transition-colors ${\r\n              activeTab === 'tags'\r\n                ? 'text-blue-400 border-b-2 border-blue-400'\r\n                : 'text-gray-400 hover:text-white'\r\n            }`}\r\n          >\r\n            Tags ({allTags.length})\r\n          </button>\r\n          <button\r\n            onClick={() => setActiveTab('moods')}\r\n            className={`px-4 py-2 font-medium transition-colors ${\r\n              activeTab === 'moods'\r\n                ? 'text-blue-400 border-b-2 border-blue-400'\r\n                : 'text-gray-400 hover:text-white'\r\n            }`}\r\n          >\r\n            Moods ({allMoods.length})\r\n          </button>\r\n          <button\r\n            onClick={() => setActiveTab('cleanup')}\r\n            className={`px-4 py-2 font-medium transition-colors ${\r\n              activeTab === 'cleanup'\r\n                ? 'text-blue-400 border-b-2 border-blue-400'\r\n                : 'text-gray-400 hover:text-white'\r\n            }`}\r\n          >\r\n            Cleanup ({similarTags.length})\r\n          </button>\r\n        </div>\r\n\r\n        {/* Tags Tab */}\r\n        {activeTab === 'tags' && (\r\n          <div className=\"space-y-4\">\r\n            {selectedTags.length > 0 && (\r\n              <div className=\"flex items-center justify-between p-3 bg-blue-600 rounded-lg\">\r\n                <span className=\"text-white\">\r\n                  {selectedTags.length} tag{selectedTags.length !== 1 ? 's' : ''} selected\r\n                </span>\r\n                <button\r\n                  onClick={handleBulkDeleteTags}\r\n                  className=\"px-3 py-1 bg-red-600 hover:bg-red-700 text-white rounded text-sm transition-colors\"\r\n                >\r\n                  Delete Selected\r\n                </button>\r\n              </div>\r\n            )}\r\n\r\n            <div className=\"grid gap-2 max-h-96 overflow-y-auto\">\r\n              {allTags.map(({ tag, count }) => (\r\n                <div\r\n                  key={tag}\r\n                  className=\"flex items-center justify-between p-3 bg-gray-700 rounded-lg\"\r\n                >\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={selectedTags.includes(tag)}\r\n                      onChange={(e) => {\r\n                        if (e.target.checked) {\r\n                          setSelectedTags([...selectedTags, tag])\r\n                        } else {\r\n                          setSelectedTags(selectedTags.filter(t => t !== tag))\r\n                        }\r\n                      }}\r\n                      className=\"rounded border-gray-600 bg-gray-600 text-blue-600 focus:ring-blue-500\"\r\n                    />\r\n                    {editingTag === tag ? (\r\n                      <input\r\n                        type=\"text\"\r\n                        value={newTagName}\r\n                        onChange={(e) => setNewTagName(e.target.value)}\r\n                        onKeyPress={(e) => {\r\n                          if (e.key === 'Enter') {\r\n                            handleRenameTag(tag, newTagName)\r\n                          } else if (e.key === 'Escape') {\r\n                            setEditingTag(null)\r\n                            setNewTagName('')\r\n                          }\r\n                        }}\r\n                        onBlur={() => handleRenameTag(tag, newTagName)}\r\n                        className=\"px-2 py-1 bg-gray-600 border border-gray-500 rounded text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                        autoFocus\r\n                      />\r\n                    ) : (\r\n                      <span className=\"text-white font-medium\">{tag}</span>\r\n                    )}\r\n                    <span className=\"text-gray-400 text-sm\">({count} tracks)</span>\r\n                  </div>\r\n                  \r\n                  <div className=\"flex items-center gap-2\">\r\n                    <button\r\n                      onClick={() => {\r\n                        setEditingTag(tag)\r\n                        setNewTagName(tag)\r\n                      }}\r\n                      className=\"p-1 text-gray-400 hover:text-blue-400 transition-colors\"\r\n                      title=\"Rename tag\"\r\n                    >\r\n                      <Edit className=\"w-4 h-4\" />\r\n                    </button>\r\n                    <button\r\n                      onClick={() => handleDeleteTag(tag)}\r\n                      className=\"p-1 text-gray-400 hover:text-red-400 transition-colors\"\r\n                      title=\"Delete tag\"\r\n                    >\r\n                      <Trash2 className=\"w-4 h-4\" />\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Moods Tab */}\r\n        {activeTab === 'moods' && (\r\n          <div className=\"space-y-4\">\r\n            <div className=\"grid gap-2 max-h-96 overflow-y-auto\">\r\n              {allMoods.map(({ mood, count }) => (\r\n                <div\r\n                  key={mood}\r\n                  className=\"flex items-center justify-between p-3 bg-gray-700 rounded-lg\"\r\n                >\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <span className=\"text-white font-medium\">{mood}</span>\r\n                    <span className=\"text-gray-400 text-sm\">({count} tracks)</span>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Cleanup Tab */}\r\n        {activeTab === 'cleanup' && (\r\n          <div className=\"space-y-4\">\r\n            <p className=\"text-gray-400 text-sm\">\r\n              Similar tags that might be duplicates or variations of the same concept.\r\n            </p>\r\n            \r\n            <div className=\"grid gap-4 max-h-96 overflow-y-auto\">\r\n              {similarTags.map(({ original, similar, count }) => (\r\n                <div\r\n                  key={original}\r\n                  className=\"p-4 bg-gray-700 rounded-lg\"\r\n                >\r\n                  <div className=\"flex items-center justify-between mb-3\">\r\n                    <div>\r\n                      <span className=\"text-white font-medium\">{original}</span>\r\n                      <span className=\"text-gray-400 text-sm ml-2\">({count} tracks)</span>\r\n                    </div>\r\n                    <button\r\n                      onClick={() => handleMergeTags(original, similar)}\r\n                      className=\"px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded text-sm transition-colors flex items-center gap-1\"\r\n                    >\r\n                      <Merge className=\"w-3 h-3\" />\r\n                      Merge All\r\n                    </button>\r\n                  </div>\r\n                  \r\n                  <div className=\"text-sm text-gray-300\">\r\n                    <span className=\"text-gray-400\">Similar tags:</span>\r\n                    <div className=\"flex flex-wrap gap-2 mt-1\">\r\n                      {similar.map((tag) => (\r\n                        <span\r\n                          key={tag}\r\n                          className=\"px-2 py-1 bg-gray-600 rounded text-xs\"\r\n                        >\r\n                          {tag}\r\n                        </span>\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n              \r\n              {similarTags.length === 0 && (\r\n                <div className=\"text-center py-8 text-gray-400\">\r\n                  No similar tags found. Your tags are well organized!\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Close button */}\r\n        <div className=\"flex justify-end pt-4 border-t border-gray-600 mt-6\">\r\n          <button\r\n            onClick={onClose}\r\n            className=\"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-md transition-colors\"\r\n          >\r\n            Close\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5983, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/components/modals/AddToPlaylistModal.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState } from 'react'\r\nimport { useMusicStore } from '@/lib/store/music-store'\r\nimport { playlistService } from '@/lib/services/playlist-service'\r\nimport { Playlist } from '@/lib/types/music'\r\nimport { X, Plus, ListMusic, Tag, ChevronDown } from 'lucide-react'\r\n\r\ninterface AddToPlaylistModalProps {\r\n  isOpen: boolean\r\n  onClose: () => void\r\n  trackIds: string[]\r\n}\r\n\r\nexport function AddToPlaylistModal({ isOpen, onClose, trackIds }: AddToPlaylistModalProps) {\r\n  const { playlists, tracks, updatePlaylist, createPlaylist } = useMusicStore()\r\n  const [showCreateNew, setShowCreateNew] = useState(false)\r\n  const [newPlaylistName, setNewPlaylistName] = useState('')\r\n  const [selectedPlaylistId, setSelectedPlaylistId] = useState<string>('')\r\n  const [isAdding, setIsAdding] = useState(false)\r\n\r\n  const trackTitles = trackIds.map(id => tracks.find(t => t.id === id)?.title).filter(Boolean)\r\n  \r\n  // Get only manual playlists (not tag-based)\r\n  const manualPlaylists = playlists.filter(p => p.type === 'manual' && !playlistService.isTagBasedPlaylist(p))\r\n\r\n  const handleAddToSelectedPlaylist = async () => {\r\n    if (!selectedPlaylistId) return\r\n\r\n    const playlist = playlists.find(p => p.id === selectedPlaylistId)\r\n    if (!playlist) return\r\n\r\n    setIsAdding(true)\r\n    try {\r\n      // Add tracks to playlist, avoiding duplicates\r\n      const existingTrackIds = new Set(playlist.trackIds)\r\n      const newTrackIds = trackIds.filter(id => !existingTrackIds.has(id))\r\n      \r\n      if (newTrackIds.length === 0) {\r\n        alert('All selected tracks are already in this playlist.')\r\n        return\r\n      }\r\n\r\n      const updatedPlaylist: Playlist = {\r\n        ...playlist,\r\n        trackIds: [...playlist.trackIds, ...newTrackIds],\r\n        dateModified: new Date(),\r\n      }\r\n\r\n      await updatePlaylist(updatedPlaylist)\r\n      onClose()\r\n    } catch (error) {\r\n      console.error('Failed to add tracks to playlist:', error)\r\n      alert('Failed to add tracks to playlist. Please try again.')\r\n    } finally {\r\n      setIsAdding(false)\r\n    }\r\n  }\r\n\r\n  const handleCreateNewPlaylist = async () => {\r\n    if (!newPlaylistName.trim()) return\r\n\r\n    setIsAdding(true)\r\n    try {\r\n      await createPlaylist({\r\n        name: newPlaylistName.trim(),\r\n        type: 'manual',\r\n        rules: [],\r\n        trackIds: [...trackIds],\r\n        sortBy: 'dateAdded',\r\n        sortOrder: 'desc',\r\n      })\r\n\r\n      setNewPlaylistName('')\r\n      setShowCreateNew(false)\r\n      onClose()\r\n    } catch (error) {\r\n      console.error('Failed to create playlist:', error)\r\n      alert('Failed to create playlist. Please try again.')\r\n    } finally {\r\n      setIsAdding(false)\r\n    }\r\n  }\r\n\r\n  const getPlaylistInfo = (playlistId: string) => {\r\n    const playlist = playlists.find(p => p.id === playlistId)\r\n    if (!playlist) return { tracksInPlaylist: 0, newTracks: trackIds.length }\r\n    \r\n    const tracksInPlaylist = trackIds.filter(id => playlist.trackIds.includes(id)).length\r\n    const newTracks = trackIds.length - tracksInPlaylist\r\n    \r\n    return { tracksInPlaylist, newTracks }\r\n  }\r\n\r\n  if (!isOpen) return null\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-gray-800 rounded-lg p-6 w-full max-w-md max-h-[80vh] overflow-y-auto\">\r\n        <div className=\"flex items-center justify-between mb-6\">\r\n          <h2 className=\"text-xl font-bold text-white\">\r\n            Add to Playlist\r\n          </h2>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"text-gray-400 hover:text-white transition-colors\"\r\n          >\r\n            <X className=\"w-6 h-6\" />\r\n          </button>\r\n        </div>\r\n\r\n        {/* Selected tracks info */}\r\n        <div className=\"mb-6 p-3 bg-gray-700 rounded-lg\">\r\n          <p className=\"text-sm text-gray-300 mb-2\">\r\n            Adding {trackIds.length} track{trackIds.length !== 1 ? 's' : ''}:\r\n          </p>\r\n          <div className=\"max-h-20 overflow-y-auto\">\r\n            {trackTitles.slice(0, 3).map((title, index) => (\r\n              <p key={index} className=\"text-sm text-white truncate\">\r\n                 {title}\r\n              </p>\r\n            ))}\r\n            {trackTitles.length > 3 && (\r\n              <p className=\"text-sm text-gray-400\">\r\n                ... and {trackTitles.length - 3} more\r\n              </p>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Create new playlist option */}\r\n        <div className=\"mb-4\">\r\n          {!showCreateNew ? (\r\n            <button\r\n              onClick={() => setShowCreateNew(true)}\r\n              className=\"w-full flex items-center gap-3 p-3 bg-blue-600 hover:bg-blue-700 rounded-lg text-white transition-colors\"\r\n            >\r\n              <Plus className=\"w-5 h-5\" />\r\n              <span>Create New Playlist</span>\r\n            </button>\r\n          ) : (\r\n            <div className=\"space-y-3\">\r\n              <input\r\n                type=\"text\"\r\n                value={newPlaylistName}\r\n                onChange={(e) => setNewPlaylistName(e.target.value)}\r\n                onKeyDown={(e) => e.key === 'Enter' && handleCreateNewPlaylist()}\r\n                placeholder=\"Enter playlist name\"\r\n                className=\"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                autoFocus\r\n              />\r\n              <div className=\"flex gap-2\">\r\n                <button\r\n                  onClick={handleCreateNewPlaylist}\r\n                  disabled={!newPlaylistName.trim() || isAdding}\r\n                  className=\"flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg transition-colors\"\r\n                >\r\n                  {isAdding ? 'Creating...' : 'Create'}\r\n                </button>\r\n                <button\r\n                  onClick={() => {\r\n                    setShowCreateNew(false)\r\n                    setNewPlaylistName('')\r\n                  }}\r\n                  disabled={isAdding}\r\n                  className=\"flex-1 px-3 py-2 bg-gray-600 hover:bg-gray-700 disabled:bg-gray-500 text-white rounded-lg transition-colors\"\r\n                >\r\n                  Cancel\r\n                </button>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Existing playlists dropdown */}\r\n        {manualPlaylists.length > 0 && (\r\n          <div className=\"mb-4\">\r\n            <h3 className=\"text-sm font-medium text-gray-300 mb-3\">\r\n              Add to Existing Playlist\r\n            </h3>\r\n            \r\n            {/* Playlist Select Dropdown */}\r\n            <div className=\"relative mb-3\">\r\n              <select\r\n                value={selectedPlaylistId}\r\n                onChange={(e) => setSelectedPlaylistId(e.target.value)}\r\n                className=\"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500 appearance-none cursor-pointer\"\r\n              >\r\n                <option value=\"\" className=\"text-gray-400\">\r\n                  Select a playlist...\r\n                </option>\r\n                {manualPlaylists.map((playlist) => {\r\n                  console.log(\"ManualPlaylist: \", playlist);\r\n                  const { tracksInPlaylist, newTracks } = getPlaylistInfo(playlist.id)\r\n                  return (\r\n                    <option key={playlist.id} value={playlist.id} className=\"text-white\">\r\n                      {playlist.name} ({playlist.trackIds.length} tracks)\r\n                      {tracksInPlaylist > 0 ? `  ${tracksInPlaylist} already added` : ''}\r\n                    </option>\r\n                  )\r\n                })}\r\n              </select>\r\n              <ChevronDown className=\"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none\" />\r\n            </div>\r\n\r\n            {/* Selected playlist info */}\r\n            {selectedPlaylistId && (\r\n              <div className=\"mb-3 p-3 bg-gray-700/50 border border-gray-600 rounded-lg\">\r\n                {(() => {\r\n                  const playlist = playlists.find(p => p.id === selectedPlaylistId)\r\n                  const { tracksInPlaylist, newTracks } = getPlaylistInfo(selectedPlaylistId)\r\n                  \r\n                  if (!playlist) return null\r\n                  \r\n                  return (\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <ListMusic className=\"w-5 h-5 text-blue-400 flex-shrink-0\" />\r\n                      <div className=\"flex-1 min-w-0\">\r\n                        <p className=\"text-white font-medium truncate\">\r\n                          {playlist.name}\r\n                        </p>\r\n                        <p className=\"text-gray-400 text-sm\">\r\n                          {playlist.trackIds.length} tracks\r\n                          {tracksInPlaylist > 0 && (\r\n                            <span className=\"text-yellow-400\">\r\n                              {' '} {tracksInPlaylist} already added\r\n                            </span>\r\n                          )}\r\n                        </p>\r\n                      </div>\r\n                      {(() => {\r\n                        const { newTracks } = getPlaylistInfo(selectedPlaylistId)\r\n                        return newTracks > 0 && (\r\n                          <div className=\"bg-blue-600 text-white text-xs px-2 py-1 rounded-full\">\r\n                            +{newTracks}\r\n                          </div>\r\n                        )\r\n                      })()}\r\n                    </div>\r\n                  )\r\n                })()}\r\n              </div>\r\n            )}\r\n\r\n            {/* Add to selected playlist button */}\r\n            <button\r\n              onClick={handleAddToSelectedPlaylist}\r\n              disabled={!selectedPlaylistId || isAdding}\r\n              className=\"w-full px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors\"\r\n            >\r\n              {isAdding ? 'Adding...' : 'Add to Selected Playlist'}\r\n            </button>\r\n          </div>\r\n        )}\r\n\r\n        {/* Tag-based playlists info */}\r\n        {playlists.some(p => playlistService.isTagBasedPlaylist(p)) && (\r\n          <div className=\"mb-4 p-3 bg-gray-700/50 border border-gray-600 rounded-lg\">\r\n            <div className=\"flex items-center gap-2 mb-2\">\r\n              <Tag className=\"w-4 h-4 text-blue-400\" />\r\n              <p className=\"text-sm font-medium text-gray-300\">Tag-Based Playlists</p>\r\n            </div>\r\n            <p className=\"text-xs text-gray-400\">\r\n              Tracks are automatically added to tag-based playlists when you assign matching tags. \r\n              Use the \"Edit Metadata\" option to add tags to tracks.\r\n            </p>\r\n          </div>\r\n        )}\r\n\r\n        {/* Empty state */}\r\n        {manualPlaylists.length === 0 && !showCreateNew && (\r\n          <div className=\"text-center py-8\">\r\n            <ListMusic className=\"w-12 h-12 text-gray-500 mx-auto mb-3\" />\r\n            <p className=\"text-gray-400 text-sm\">\r\n              No manual playlists available.\r\n              <br />\r\n              Create a new playlist to add tracks.\r\n            </p>\r\n          </div>\r\n        )}\r\n\r\n        {/* Close button */}\r\n        <div className=\"flex justify-end pt-4 border-t border-gray-600 mt-6\">\r\n          <button\r\n            onClick={onClose}\r\n            disabled={isAdding}\r\n            className=\"px-4 py-2 text-gray-300 hover:text-white disabled:text-gray-500 transition-colors\"\r\n          >\r\n            Cancel\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6539, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/components/views/LibraryView.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useMemo } from 'react'\r\nimport { useMusicStore } from '@/lib/store/music-store'\r\nimport { SearchBar } from '@/components/ui/SearchBar'\r\nimport { FilterBar } from '@/components/ui/FilterBar'\r\nimport { TrackList } from '@/components/ui/TrackList'\r\nimport { ViewControls } from '@/components/ui/ViewControls'\r\nimport { EmptyState } from '@/components/ui/EmptyState'\r\nimport { EditTrackModal } from '@/components/modals/EditTrackModal'\r\nimport { TagManagementModal } from '@/components/modals/TagManagementModal'\r\nimport { AddToPlaylistModal } from '@/components/modals/AddToPlaylistModal'\r\nimport { Music, Edit, Tags } from 'lucide-react'\r\n\r\nexport function LibraryView() {\r\n  const { \r\n    tracks, \r\n    viewState, \r\n    searchTracks, \r\n    setFilters, \r\n    setSorting,\r\n    setSelectedTracks,\r\n    deleteTrack\r\n  } = useMusicStore()\r\n  \r\n  const [searchQuery, setSearchQuery] = useState('')\r\n  const [viewMode, setViewMode] = useState<'list' | 'grid'>('list')\r\n  const [showSelection, setShowSelection] = useState(false)\r\n  const [editModalOpen, setEditModalOpen] = useState(false)\r\n  const [editingTrack, setEditingTrack] = useState<string | null>(null)\r\n  const [bulkEditTracks, setBulkEditTracks] = useState<string[]>([])\r\n  const [tagManagementOpen, setTagManagementOpen] = useState(false)\r\n  const [addToPlaylistOpen, setAddToPlaylistOpen] = useState(false)\r\n  const [tracksToAddToPlaylist, setTracksToAddToPlaylist] = useState<string[]>([])\r\n\r\n  const handleDeleteTrack = async (trackId: string) => {\r\n    try {\r\n      await deleteTrack(trackId)\r\n    } catch (error) {\r\n      console.error('Failed to delete track:', error)\r\n      // TODO: Show error toast\r\n    }\r\n  }\r\n\r\n  const handleEditTrack = (trackId: string) => {\r\n    setEditingTrack(trackId)\r\n    setEditModalOpen(true)\r\n  }\r\n\r\n  const handleBulkEdit = (trackIds: string[]) => {\r\n    setBulkEditTracks(trackIds)\r\n    setEditModalOpen(true)\r\n  }\r\n\r\n  const handleCloseEditModal = () => {\r\n    setEditModalOpen(false)\r\n    setEditingTrack(null)\r\n    setBulkEditTracks([])\r\n  }\r\n\r\n  const handleAddToPlaylist = (trackId: string) => {\r\n    setTracksToAddToPlaylist([trackId])\r\n    setAddToPlaylistOpen(true)\r\n  }\r\n\r\n  const handleBulkAddToPlaylist = (trackIds: string[]) => {\r\n    setTracksToAddToPlaylist(trackIds)\r\n    setAddToPlaylistOpen(true)\r\n  }\r\n\r\n  const handleCloseAddToPlaylistModal = () => {\r\n    setAddToPlaylistOpen(false)\r\n    setTracksToAddToPlaylist([])\r\n  }\r\n\r\n  const toggleSelection = () => {\r\n    setShowSelection(!showSelection)\r\n    if (showSelection) {\r\n      setSelectedTracks([])\r\n    }\r\n  }\r\n\r\n  // Filter and search tracks\r\n  const filteredTracks = useMemo(() => {\r\n    let result = tracks\r\n\r\n    // Apply search\r\n    if (searchQuery.trim()) {\r\n      result = searchTracks(searchQuery)\r\n    }\r\n\r\n    // Apply filters\r\n    if (viewState.filters.genre) {\r\n      result = result.filter(track => track.genre === viewState.filters.genre)\r\n    }\r\n    if (viewState.filters.artist) {\r\n      result = result.filter(track => track.artist === viewState.filters.artist)\r\n    }\r\n    if (viewState.filters.album) {\r\n      result = result.filter(track => track.album === viewState.filters.album)\r\n    }\r\n    if (viewState.filters.year) {\r\n      result = result.filter(track => track.year === viewState.filters.year)\r\n    }\r\n    if (viewState.filters.rating) {\r\n      result = result.filter(track => track.rating && track.rating >= viewState.filters.rating!)\r\n    }\r\n    if (viewState.filters.fileFormat) {\r\n      result = result.filter(track => track.fileFormat === viewState.filters.fileFormat)\r\n    }\r\n    if (viewState.filters.customTag) {\r\n      result = result.filter(track => track.customTags.includes(viewState.filters.customTag!))\r\n    }\r\n    if (viewState.filters.mood) {\r\n      result = result.filter(track => track.mood === viewState.filters.mood)\r\n    }\r\n\r\n    // Apply sorting\r\n    result = [...result].sort((a, b) => {\r\n      const aValue = a[viewState.sortBy]\r\n      const bValue = b[viewState.sortBy]\r\n      \r\n      if (aValue === undefined && bValue === undefined) return 0\r\n      if (aValue === undefined) return 1\r\n      if (bValue === undefined) return -1\r\n      \r\n      let comparison = 0\r\n      if (typeof aValue === 'string' && typeof bValue === 'string') {\r\n        comparison = aValue.localeCompare(bValue)\r\n      } else if (typeof aValue === 'number' && typeof bValue === 'number') {\r\n        comparison = aValue - bValue\r\n      } else if (aValue instanceof Date && bValue instanceof Date) {\r\n        comparison = aValue.getTime() - bValue.getTime()\r\n      }\r\n      \r\n      return viewState.sortOrder === 'asc' ? comparison : -comparison\r\n    })\r\n\r\n    return result\r\n  }, [tracks, searchQuery, viewState, searchTracks])\r\n\r\n  if (tracks.length === 0) {\r\n    return (\r\n      <div className=\"flex-1 flex items-center justify-center\">\r\n        <EmptyState\r\n          icon={Music}\r\n          title=\"No music in your library\"\r\n          description=\"Import your music files to get started\"\r\n          actionLabel=\"Import Music\"\r\n          onAction={() => {\r\n            // TODO: Open import modal\r\n          }}\r\n        />\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex-1 flex flex-col\">\r\n      {/* Header */}\r\n      <div className=\"p-6 border-b border-gray-700\">\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <div>\r\n            <h1 className=\"text-2xl font-bold text-white\">Music Library</h1>\r\n            <p className=\"text-gray-400\">\r\n              {filteredTracks.length} of {tracks.length} tracks\r\n              {viewState.selectedTrackIds.length > 0 && (\r\n                <span className=\"ml-2 text-blue-400\">\r\n                   {viewState.selectedTrackIds.length} selected\r\n                </span>\r\n              )}\r\n            </p>\r\n          </div>\r\n          \r\n          <div className=\"flex items-center gap-3\">\r\n            <button\r\n              onClick={() => setTagManagementOpen(true)}\r\n              className=\"px-3 py-2 bg-gray-700 text-gray-300 hover:bg-gray-600 rounded-md text-sm font-medium transition-colors\"\r\n            >\r\n              <Tags className=\"w-4 h-4 mr-2 inline\" />\r\n              Manage Tags\r\n            </button>\r\n            \r\n            <button\r\n              onClick={toggleSelection}\r\n              className={`px-3 py-2 rounded-md text-sm font-medium transition-colors ${\r\n                showSelection\r\n                  ? 'bg-blue-600 text-white hover:bg-blue-700'\r\n                  : 'bg-gray-700 text-gray-300 hover:bg-gray-600'\r\n              }`}\r\n            >\r\n              <Edit className=\"w-4 h-4 mr-2 inline\" />\r\n              {showSelection ? 'Exit Selection' : 'Select Tracks'}\r\n            </button>\r\n            \r\n            <ViewControls\r\n              viewMode={viewMode}\r\n              onViewModeChange={setViewMode}\r\n              sortBy={viewState.sortBy}\r\n              sortOrder={viewState.sortOrder}\r\n              onSortChange={setSorting}\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex gap-4\">\r\n          <div className=\"flex-1\">\r\n            <SearchBar\r\n              value={searchQuery}\r\n              onChange={setSearchQuery}\r\n              placeholder=\"Search tracks, artists, albums...\"\r\n            />\r\n          </div>\r\n          \r\n          <FilterBar\r\n            tracks={tracks}\r\n            filters={viewState.filters}\r\n            onFiltersChange={setFilters}\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Content */}\r\n      <div className=\"flex-1 overflow-hidden\">\r\n        {filteredTracks.length === 0 ? (\r\n          <div className=\"flex-1 flex items-center justify-center\">\r\n            <EmptyState\r\n              icon={Music}\r\n              title=\"No tracks found\"\r\n              description=\"Try adjusting your search or filters\"\r\n            />\r\n          </div>\r\n        ) : (\r\n          <TrackList\r\n            tracks={filteredTracks}\r\n            viewMode={viewMode}\r\n            selectedTrackIds={viewState.selectedTrackIds}\r\n            onSelectionChange={setSelectedTracks}\r\n            onDelete={handleDeleteTrack}\r\n            onEdit={handleEditTrack}\r\n            onAddToPlaylist={handleAddToPlaylist}\r\n            onBulkEdit={handleBulkEdit}\r\n            onBulkAddToPlaylist={handleBulkAddToPlaylist}\r\n            showSelection={showSelection}\r\n          />\r\n        )}\r\n      </div>\r\n\r\n      {/* Edit Track Modal */}\r\n      <EditTrackModal\r\n        isOpen={editModalOpen}\r\n        onClose={handleCloseEditModal}\r\n        track={editingTrack ? tracks.find(t => t.id === editingTrack) || null : null}\r\n        tracks={bulkEditTracks.map(id => tracks.find(t => t.id === id)!).filter(Boolean)}\r\n        isBulkEdit={bulkEditTracks.length > 0}\r\n      />\r\n      {/* Tag Management Modal */}\r\n      <TagManagementModal\r\n        isOpen={tagManagementOpen}\r\n        onClose={() => setTagManagementOpen(false)}\r\n      />\r\n\r\n      {/* Add to Playlist Modal */}\r\n      <AddToPlaylistModal\r\n        isOpen={addToPlaylistOpen}\r\n        onClose={handleCloseAddToPlaylistModal}\r\n        trackIds={tracksToAddToPlaylist}\r\n      />\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6964, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/components/ui/PlaylistCard.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { Playlist } from '@/lib/types/music'\r\nimport { formatRelativeDate } from '@/lib/utils/format'\r\nimport { ListMusic, Music, Zap } from 'lucide-react'\r\nimport { cn } from '@/lib/utils/cn'\r\n\r\ninterface PlaylistCardProps {\r\n  playlist: Playlist\r\n  isSelected: boolean\r\n  onClick: () => void\r\n}\r\n\r\nexport function PlaylistCard({ playlist, isSelected, onClick }: PlaylistCardProps) {\r\n  const Icon = playlist.type === 'smart' ? Zap : ListMusic\r\n\r\n  return (\r\n    <div\r\n      onClick={onClick}\r\n      className={cn(\r\n        'bg-gray-800 rounded-lg p-6 hover:bg-gray-700 transition-colors cursor-pointer',\r\n        isSelected && 'ring-2 ring-blue-500'\r\n      )}\r\n    >\r\n      <div className=\"flex items-center gap-3 mb-4\">\r\n        <div className=\"w-12 h-12 bg-gray-700 rounded-lg flex items-center justify-center\">\r\n          <Icon className=\"w-6 h-6 text-blue-400\" />\r\n        </div>\r\n        <div className=\"flex-1 min-w-0\">\r\n          <h3 className=\"text-white font-medium truncate\">{playlist.name}</h3>\r\n          <p className=\"text-gray-400 text-sm\">\r\n            {playlist.type === 'smart' ? 'Smart Playlist' : 'Manual Playlist'}\r\n          </p>\r\n        </div>\r\n      </div>\r\n\r\n      {playlist.description && (\r\n        <p className=\"text-gray-400 text-sm mb-4 line-clamp-2\">\r\n          {playlist.description}\r\n        </p>\r\n      )}\r\n\r\n      <div className=\"flex items-center justify-between text-sm\">\r\n        <span className=\"text-gray-400\">\r\n          {playlist.trackIds.length} tracks\r\n        </span>\r\n        <span className=\"text-gray-500\">\r\n          {formatRelativeDate(playlist.dateModified)}\r\n        </span>\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":";;;;;AAGA;AACA;AAAA;AACA;AALA;;;;;AAaO,SAAS,aAAa,EAAE,QAAQ,EAAE,UAAU,EAAE,OAAO,EAAqB;IAC/E,MAAM,OAAO,SAAS,IAAI,KAAK,UAAU,0MAAG,GAAG,gOAAS;IAExD,qBACE,6LAAC;QACC,SAAS;QACT,WAAW,IAAA,kIAAE,EACX,iFACA,cAAc;;0BAGhB,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC;4BAAK,WAAU;;;;;;;;;;;kCAElB,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAG,WAAU;0CAAmC,SAAS,IAAI;;;;;;0CAC9D,6LAAC;gCAAE,WAAU;0CACV,SAAS,IAAI,KAAK,UAAU,mBAAmB;;;;;;;;;;;;;;;;;;YAKrD,SAAS,WAAW,kBACnB,6LAAC;gBAAE,WAAU;0BACV,SAAS,WAAW;;;;;;0BAIzB,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAK,WAAU;;4BACb,SAAS,QAAQ,CAAC,MAAM;4BAAC;;;;;;;kCAE5B,6LAAC;wBAAK,WAAU;kCACb,IAAA,sJAAkB,EAAC,SAAS,YAAY;;;;;;;;;;;;;;;;;;AAKnD;KAvCgB"}},
    {"offset": {"line": 7085, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/components/modals/CreatePlaylistModal.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState } from 'react'\r\nimport { useMusicStore } from '@/lib/store/music-store'\r\nimport { X } from 'lucide-react'\r\n\r\ninterface CreatePlaylistModalProps {\r\n  isOpen: boolean\r\n  onClose: () => void\r\n}\r\n\r\nexport function CreatePlaylistModal({ isOpen, onClose }: CreatePlaylistModalProps) {\r\n  const { createPlaylist } = useMusicStore()\r\n  const [name, setName] = useState('')\r\n  const [description, setDescription] = useState('')\r\n  const [type, setType] = useState<'manual' | 'smart'>('manual')\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault()\r\n    \r\n    if (!name.trim()) return\r\n\r\n    try {\r\n      await createPlaylist({\r\n        name: name.trim(),\r\n        description: description.trim() || undefined,\r\n        type,\r\n        rules: [],\r\n        trackIds: [],\r\n        sortBy: 'dateAdded',\r\n        sortOrder: 'desc',\r\n      })\r\n      \r\n      // Reset form and close modal\r\n      setName('')\r\n      setDescription('')\r\n      setType('manual')\r\n      onClose()\r\n    } catch (error) {\r\n      console.error('Failed to create playlist:', error)\r\n    }\r\n  }\r\n\r\n  if (!isOpen) return null\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between mb-6\">\r\n          <h2 className=\"text-xl font-semibold text-white\">Create Playlist</h2>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"text-gray-400 hover:text-white\"\r\n          >\r\n            <X className=\"w-6 h-6\" />\r\n          </button>\r\n        </div>\r\n\r\n        {/* Form */}\r\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-300 mb-2\">\r\n              Playlist Name\r\n            </label>\r\n            <input\r\n              type=\"text\"\r\n              value={name}\r\n              onChange={(e) => setName(e.target.value)}\r\n              placeholder=\"Enter playlist name\"\r\n              className=\"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n              required\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-300 mb-2\">\r\n              Description (Optional)\r\n            </label>\r\n            <textarea\r\n              value={description}\r\n              onChange={(e) => setDescription(e.target.value)}\r\n              placeholder=\"Enter playlist description\"\r\n              rows={3}\r\n              className=\"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-300 mb-2\">\r\n              Playlist Type\r\n            </label>\r\n            <div className=\"space-y-2\">\r\n              <label className=\"flex items-center\">\r\n                <input\r\n                  type=\"radio\"\r\n                  name=\"type\"\r\n                  value=\"manual\"\r\n                  checked={type === 'manual'}\r\n                  onChange={(e) => setType(e.target.value as 'manual')}\r\n                  className=\"text-blue-600 focus:ring-blue-500\"\r\n                />\r\n                <span className=\"ml-2 text-white\">Manual Playlist</span>\r\n              </label>\r\n              <label className=\"flex items-center\">\r\n                <input\r\n                  type=\"radio\"\r\n                  name=\"type\"\r\n                  value=\"smart\"\r\n                  checked={type === 'smart'}\r\n                  onChange={(e) => setType(e.target.value as 'smart')}\r\n                  className=\"text-blue-600 focus:ring-blue-500\"\r\n                />\r\n                <span className=\"ml-2 text-white\">Smart Playlist</span>\r\n              </label>\r\n            </div>\r\n            <p className=\"text-xs text-gray-400 mt-1\">\r\n              {type === 'smart' \r\n                ? 'Automatically updates based on rules you define'\r\n                : 'Manually add and remove tracks'\r\n              }\r\n            </p>\r\n          </div>\r\n\r\n          {/* Actions */}\r\n          <div className=\"flex gap-3 pt-4\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={onClose}\r\n              className=\"flex-1 px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-white font-medium transition-colors\"\r\n            >\r\n              Cancel\r\n            </button>\r\n            <button\r\n              type=\"submit\"\r\n              className=\"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-white font-medium transition-colors\"\r\n            >\r\n              Create Playlist\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;;;AAJA;;;;AAWO,SAAS,oBAAoB,EAAE,MAAM,EAAE,OAAO,EAA4B;;IAC/E,MAAM,EAAE,cAAc,EAAE,GAAG,IAAA,yJAAa;IACxC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAC;IACjC,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAC;IAC/C,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAqB;IAErD,MAAM,eAAe,OAAO;QAC1B,EAAE,cAAc;QAEhB,IAAI,CAAC,KAAK,IAAI,IAAI;QAElB,IAAI;YACF,MAAM,eAAe;gBACnB,MAAM,KAAK,IAAI;gBACf,aAAa,YAAY,IAAI,MAAM;gBACnC;gBACA,OAAO,EAAE;gBACT,UAAU,EAAE;gBACZ,QAAQ;gBACR,WAAW;YACb;YAEA,6BAA6B;YAC7B,QAAQ;YACR,eAAe;YACf,QAAQ;YACR;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,8BAA8B;QAC9C;IACF;IAEA,IAAI,CAAC,QAAQ,OAAO;IAEpB,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;;8BAEb,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAG,WAAU;sCAAmC;;;;;;sCACjD,6LAAC;4BACC,SAAS;4BACT,WAAU;sCAEV,cAAA,6LAAC,oMAAC;gCAAC,WAAU;;;;;;;;;;;;;;;;;8BAKjB,6LAAC;oBAAK,UAAU;oBAAc,WAAU;;sCACtC,6LAAC;;8CACC,6LAAC;oCAAM,WAAU;8CAA+C;;;;;;8CAGhE,6LAAC;oCACC,MAAK;oCACL,OAAO;oCACP,UAAU,CAAC,IAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;oCACvC,aAAY;oCACZ,WAAU;oCACV,QAAQ;;;;;;;;;;;;sCAIZ,6LAAC;;8CACC,6LAAC;oCAAM,WAAU;8CAA+C;;;;;;8CAGhE,6LAAC;oCACC,OAAO;oCACP,UAAU,CAAC,IAAM,eAAe,EAAE,MAAM,CAAC,KAAK;oCAC9C,aAAY;oCACZ,MAAM;oCACN,WAAU;;;;;;;;;;;;sCAId,6LAAC;;8CACC,6LAAC;oCAAM,WAAU;8CAA+C;;;;;;8CAGhE,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAM,WAAU;;8DACf,6LAAC;oDACC,MAAK;oDACL,MAAK;oDACL,OAAM;oDACN,SAAS,SAAS;oDAClB,UAAU,CAAC,IAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;oDACvC,WAAU;;;;;;8DAEZ,6LAAC;oDAAK,WAAU;8DAAkB;;;;;;;;;;;;sDAEpC,6LAAC;4CAAM,WAAU;;8DACf,6LAAC;oDACC,MAAK;oDACL,MAAK;oDACL,OAAM;oDACN,SAAS,SAAS;oDAClB,UAAU,CAAC,IAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;oDACvC,WAAU;;;;;;8DAEZ,6LAAC;oDAAK,WAAU;8DAAkB;;;;;;;;;;;;;;;;;;8CAGtC,6LAAC;oCAAE,WAAU;8CACV,SAAS,UACN,oDACA;;;;;;;;;;;;sCAMR,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCACC,MAAK;oCACL,SAAS;oCACT,WAAU;8CACX;;;;;;8CAGD,6LAAC;oCACC,MAAK;oCACL,WAAU;8CACX;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQb;GArIgB;;QACa,yJAAa;;;KAD1B"}},
    {"offset": {"line": 7376, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/components/views/PlaylistsView.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState } from 'react'\r\nimport { useMusicStore } from '@/lib/store/music-store'\r\nimport { playlistService } from '@/lib/services/playlist-service'\r\nimport { EmptyState } from '@/components/ui/EmptyState'\r\nimport { PlaylistCard } from '@/components/ui/PlaylistCard'\r\nimport { CreatePlaylistModal } from '@/components/modals/CreatePlaylistModal'\r\nimport { ListMusic, Plus, Tag, RefreshCw } from 'lucide-react'\r\n\r\nexport function PlaylistsView() {\r\n  const { playlists, selectedPlaylistId, setSelectedPlaylist, syncTagBasedPlaylists } = useMusicStore()\r\n  const [showCreateModal, setShowCreateModal] = useState(false)\r\n  const [filter, setFilter] = useState<'all' | 'manual' | 'tag-based'>('all')\r\n  const [isSyncing, setIsSyncing] = useState(false)\r\n\r\n  const handleSyncTagPlaylists = async () => {\r\n    setIsSyncing(true)\r\n    try {\r\n      await syncTagBasedPlaylists()\r\n    } finally {\r\n      setIsSyncing(false)\r\n    }\r\n  }\r\n\r\n  // Filter playlists based on type\r\n  const filteredPlaylists = playlists.filter(playlist => {\r\n    if (filter === 'manual') {\r\n      return playlist.type === 'manual' || !playlistService.isTagBasedPlaylist(playlist)\r\n    }\r\n    if (filter === 'tag-based') {\r\n      return playlistService.isTagBasedPlaylist(playlist)\r\n    }\r\n    return true // 'all'\r\n  })\r\n\r\n  // Separate manual and tag-based playlists for display\r\n  const manualPlaylists = filteredPlaylists.filter(p => \r\n    p.type === 'manual' || !playlistService.isTagBasedPlaylist(p)\r\n  )\r\n  const tagBasedPlaylists = filteredPlaylists.filter(p => \r\n    playlistService.isTagBasedPlaylist(p)\r\n  )\r\n\r\n  if (playlists.length === 0) {\r\n    return (\r\n      <div className=\"flex-1 flex items-center justify-center\">\r\n        <EmptyState\r\n          icon={ListMusic}\r\n          title=\"No playlists yet\"\r\n          description=\"Create your first playlist or add tags to tracks to generate automatic playlists\"\r\n          actionLabel=\"Create Playlist\"\r\n          onAction={() => setShowCreateModal(true)}\r\n        />\r\n        <CreatePlaylistModal\r\n          isOpen={showCreateModal}\r\n          onClose={() => setShowCreateModal(false)}\r\n        />\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex-1 flex flex-col\">\r\n      {/* Header */}\r\n      <div className=\"p-6 border-b border-gray-700\">\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <div>\r\n            <h1 className=\"text-2xl font-bold text-white\">Playlists</h1>\r\n            <p className=\"text-gray-400\">\r\n              {playlists.length} playlists \r\n              ({manualPlaylists.length} manual, {tagBasedPlaylists.length} tag-based)\r\n            </p>\r\n          </div>\r\n          \r\n          <div className=\"flex items-center gap-3\">\r\n            <button\r\n              onClick={handleSyncTagPlaylists}\r\n              disabled={isSyncing}\r\n              className=\"flex items-center gap-2 px-3 py-2 bg-gray-700 hover:bg-gray-600 disabled:bg-gray-600 rounded-lg text-gray-300 text-sm font-medium transition-colors\"\r\n            >\r\n              <RefreshCw className={`w-4 h-4 ${isSyncing ? 'animate-spin' : ''}`} />\r\n              {isSyncing ? 'Syncing...' : 'Sync Tags'}\r\n            </button>\r\n            \r\n            <button\r\n              onClick={() => setShowCreateModal(true)}\r\n              className=\"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-white font-medium transition-colors\"\r\n            >\r\n              <Plus className=\"w-4 h-4\" />\r\n              Create Playlist\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Filter Tabs */}\r\n        <div className=\"flex gap-1 bg-gray-800 rounded-lg p-1\">\r\n          {[\r\n            { key: 'all', label: 'All', count: playlists.length },\r\n            { key: 'manual', label: 'Manual', count: manualPlaylists.length },\r\n            { key: 'tag-based', label: 'Tag-Based', count: tagBasedPlaylists.length },\r\n          ].map((tab) => (\r\n            <button\r\n              key={tab.key}\r\n              onClick={() => setFilter(tab.key as any)}\r\n              className={`flex-1 px-4 py-2 rounded-md text-sm font-medium transition-colors ${\r\n                filter === tab.key\r\n                  ? 'bg-blue-600 text-white'\r\n                  : 'text-gray-300 hover:text-white hover:bg-gray-700'\r\n              }`}\r\n            >\r\n              {tab.label} ({tab.count})\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Content */}\r\n      <div className=\"flex-1 p-6\">\r\n        {filteredPlaylists.length === 0 ? (\r\n          <div className=\"flex-1 flex items-center justify-center\">\r\n            <EmptyState\r\n              icon={filter === 'tag-based' ? Tag : ListMusic}\r\n              title={\r\n                filter === 'manual' \r\n                  ? \"No manual playlists\" \r\n                  : filter === 'tag-based'\r\n                  ? \"No tag-based playlists\"\r\n                  : \"No playlists found\"\r\n              }\r\n              description={\r\n                filter === 'manual'\r\n                  ? \"Create a manual playlist to organize your music\"\r\n                  : filter === 'tag-based'\r\n                  ? \"Add tags to your tracks to automatically generate playlists\"\r\n                  : \"Switch tabs to see other playlists\"\r\n              }\r\n              actionLabel={filter === 'manual' ? \"Create Playlist\" : undefined}\r\n              onAction={filter === 'manual' ? () => setShowCreateModal(true) : undefined}\r\n            />\r\n          </div>\r\n        ) : (\r\n          <div className=\"space-y-8\">\r\n            {/* Manual Playlists */}\r\n            {(filter === 'all' || filter === 'manual') && manualPlaylists.length > 0 && (\r\n              <div>\r\n                {filter === 'all' && (\r\n                  <h2 className=\"text-lg font-semibold text-white mb-4 flex items-center gap-2\">\r\n                    <ListMusic className=\"w-5 h-5\" />\r\n                    Manual Playlists\r\n                  </h2>\r\n                )}\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\r\n                  {manualPlaylists.map((playlist) => (\r\n                    <PlaylistCard\r\n                      key={playlist.id}\r\n                      playlist={playlist}\r\n                      isSelected={selectedPlaylistId === playlist.id}\r\n                      onClick={() => setSelectedPlaylist(playlist.id)}\r\n                    />\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Tag-Based Playlists */}\r\n            {(filter === 'all' || filter === 'tag-based') && tagBasedPlaylists.length > 0 && (\r\n              <div>\r\n                {filter === 'all' && (\r\n                  <h2 className=\"text-lg font-semibold text-white mb-4 flex items-center gap-2\">\r\n                    <Tag className=\"w-5 h-5\" />\r\n                    Tag-Based Playlists\r\n                  </h2>\r\n                )}\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\r\n                  {tagBasedPlaylists.map((playlist) => (\r\n                    <PlaylistCard\r\n                      key={playlist.id}\r\n                      playlist={playlist}\r\n                      isSelected={selectedPlaylistId === playlist.id}\r\n                      onClick={() => setSelectedPlaylist(playlist.id)}\r\n                    />\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      <CreatePlaylistModal\r\n        isOpen={showCreateModal}\r\n        onClose={() => setShowCreateModal(false)}\r\n      />\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 7739, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/components/ui/StatsCard.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { LucideIcon } from 'lucide-react'\r\n\r\ninterface StatsCardProps {\r\n  title: string\r\n  value: string\r\n  icon: LucideIcon\r\n  trend?: string\r\n}\r\n\r\nexport function StatsCard({ title, value, icon: Icon, trend }: StatsCardProps) {\r\n  return (\r\n    <div className=\"bg-gray-800 rounded-lg p-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <p className=\"text-gray-400 text-sm font-medium\">{title}</p>\r\n          <p className=\"text-2xl font-bold text-white mt-1\">{value}</p>\r\n          {trend && (\r\n            <p className=\"text-green-400 text-sm mt-1\">{trend}</p>\r\n          )}\r\n        </div>\r\n        <Icon className=\"w-8 h-8 text-blue-400\" />\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":";;;;;AAAA;;AAWO,SAAS,UAAU,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,IAAI,EAAE,KAAK,EAAkB;IAC3E,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC;;sCACC,6LAAC;4BAAE,WAAU;sCAAqC;;;;;;sCAClD,6LAAC;4BAAE,WAAU;sCAAsC;;;;;;wBAClD,uBACC,6LAAC;4BAAE,WAAU;sCAA+B;;;;;;;;;;;;8BAGhD,6LAAC;oBAAK,WAAU;;;;;;;;;;;;;;;;;AAIxB;KAfgB"}},
    {"offset": {"line": 7813, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/components/charts/GenreChart.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { PieChart, Pie, Cell, ResponsiveContainer, Tooltip, Legend } from 'recharts'\r\nimport { GenreDistribution } from '@/lib/services/analytics-service'\r\n\r\ninterface GenreChartProps {\r\n  data: GenreDistribution[]\r\n}\r\n\r\nconst COLORS = [\r\n  '#3B82F6', '#EF4444', '#10B981', '#F59E0B', '#8B5CF6',\r\n  '#EC4899', '#06B6D4', '#84CC16', '#F97316', '#6366F1'\r\n]\r\n\r\nexport function GenreChart({ data }: GenreChartProps) {\r\n  const chartData = data.slice(0, 10) // Show top 10 genres\r\n\r\n  return (\r\n    <div className=\"h-64\">\r\n      <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n        <PieChart>\r\n          <Pie\r\n            data={chartData}\r\n            cx=\"50%\"\r\n            cy=\"50%\"\r\n            outerRadius={80}\r\n            dataKey=\"count\"\r\n            nameKey=\"genre\"\r\n          >\r\n            {chartData.map((entry, index) => (\r\n              <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\r\n            ))}\r\n          </Pie>\r\n          <Tooltip\r\n            contentStyle={{\r\n              backgroundColor: '#1F2937',\r\n              border: '1px solid #374151',\r\n              borderRadius: '8px',\r\n              color: '#F9FAFB'\r\n            }}\r\n            formatter={(value: number, name: string) => [\r\n              `${value} tracks (${((value / data.reduce((sum, item) => sum + item.count, 0)) * 100).toFixed(1)}%)`,\r\n              name\r\n            ]}\r\n          />\r\n          <Legend\r\n            wrapperStyle={{ color: '#9CA3AF' }}\r\n          />\r\n        </PieChart>\r\n      </ResponsiveContainer>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":";;;;;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAFA;;;AASA,MAAM,SAAS;IACb;IAAW;IAAW;IAAW;IAAW;IAC5C;IAAW;IAAW;IAAW;IAAW;CAC7C;AAEM,SAAS,WAAW,EAAE,IAAI,EAAmB;IAClD,MAAM,YAAY,KAAK,KAAK,CAAC,GAAG,IAAI,qBAAqB;;IAEzD,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC,6LAAmB;YAAC,OAAM;YAAO,QAAO;sBACvC,cAAA,6LAAC,mKAAQ;;kCACP,6LAAC,yJAAG;wBACF,MAAM;wBACN,IAAG;wBACH,IAAG;wBACH,aAAa;wBACb,SAAQ;wBACR,SAAQ;kCAEP,UAAU,GAAG,CAAC,CAAC,OAAO,sBACrB,6LAAC,+JAAI;gCAAuB,MAAM,MAAM,CAAC,QAAQ,OAAO,MAAM,CAAC;+BAApD,CAAC,KAAK,EAAE,OAAO;;;;;;;;;;kCAG9B,6LAAC,qKAAO;wBACN,cAAc;4BACZ,iBAAiB;4BACjB,QAAQ;4BACR,cAAc;4BACd,OAAO;wBACT;wBACA,WAAW,CAAC,OAAe,OAAiB;gCAC1C,GAAG,MAAM,SAAS,EAAE,CAAC,AAAC,QAAQ,KAAK,MAAM,CAAC,CAAC,KAAK,OAAS,MAAM,KAAK,KAAK,EAAE,KAAM,GAAG,EAAE,OAAO,CAAC,GAAG,EAAE,CAAC;gCACpG;6BACD;;;;;;kCAEH,6LAAC,mKAAM;wBACL,cAAc;4BAAE,OAAO;wBAAU;;;;;;;;;;;;;;;;;;;;;;AAM7C;KAtCgB"}},
    {"offset": {"line": 7920, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/components/charts/ListeningPatternsChart.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } from 'recharts'\r\nimport { ListeningPattern } from '@/lib/services/analytics-service'\r\nimport { formatTimeOfDay } from '@/lib/utils/format'\r\n\r\ninterface ListeningPatternsChartProps {\r\n  data: ListeningPattern[]\r\n}\r\n\r\nexport function ListeningPatternsChart({ data }: ListeningPatternsChartProps) {\r\n  const chartData = data.map(item => ({\r\n    ...item,\r\n    hourLabel: formatTimeOfDay(item.hour)\r\n  }))\r\n\r\n  return (\r\n    <div className=\"h-64\">\r\n      <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n        <BarChart data={chartData}>\r\n          <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#374151\" />\r\n          <XAxis \r\n            dataKey=\"hourLabel\" \r\n            stroke=\"#9CA3AF\"\r\n            fontSize={12}\r\n            interval={1}\r\n          />\r\n          <YAxis stroke=\"#9CA3AF\" fontSize={12} />\r\n          <Tooltip\r\n            contentStyle={{\r\n              backgroundColor: '#1F2937',\r\n              border: '1px solid #374151',\r\n              borderRadius: '8px',\r\n              color: '#F9FAFB'\r\n            }}\r\n            formatter={(value: number) => [`${value} plays`, 'Play Count']}\r\n            labelFormatter={(label: string) => `Time: ${label}`}\r\n          />\r\n          <Bar dataKey=\"playCount\" fill=\"#3B82F6\" radius={[2, 2, 0, 0]} />\r\n        </BarChart>\r\n      </ResponsiveContainer>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":";;;;;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAJA;;;;AAUO,SAAS,uBAAuB,EAAE,IAAI,EAA+B;IAC1E,MAAM,YAAY,KAAK,GAAG,CAAC,CAAA,OAAQ,CAAC;YAClC,GAAG,IAAI;YACP,WAAW,IAAA,mJAAe,EAAC,KAAK,IAAI;QACtC,CAAC;IAED,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC,6LAAmB;YAAC,OAAM;YAAO,QAAO;sBACvC,cAAA,6LAAC,mKAAQ;gBAAC,MAAM;;kCACd,6LAAC,iLAAa;wBAAC,iBAAgB;wBAAM,QAAO;;;;;;kCAC5C,6LAAC,iKAAK;wBACJ,SAAQ;wBACR,QAAO;wBACP,UAAU;wBACV,UAAU;;;;;;kCAEZ,6LAAC,iKAAK;wBAAC,QAAO;wBAAU,UAAU;;;;;;kCAClC,6LAAC,qKAAO;wBACN,cAAc;4BACZ,iBAAiB;4BACjB,QAAQ;4BACR,cAAc;4BACd,OAAO;wBACT;wBACA,WAAW,CAAC,QAAkB;gCAAC,GAAG,MAAM,MAAM,CAAC;gCAAE;6BAAa;wBAC9D,gBAAgB,CAAC,QAAkB,CAAC,MAAM,EAAE,OAAO;;;;;;kCAErD,6LAAC,6JAAG;wBAAC,SAAQ;wBAAY,MAAK;wBAAU,QAAQ;4BAAC;4BAAG;4BAAG;4BAAG;yBAAE;;;;;;;;;;;;;;;;;;;;;;AAKtE;KAjCgB"}},
    {"offset": {"line": 8034, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/components/charts/LibraryGrowthChart.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } from 'recharts'\r\nimport { LibraryGrowth } from '@/lib/services/analytics-service'\r\n\r\ninterface LibraryGrowthChartProps {\r\n  data: LibraryGrowth[]\r\n}\r\n\r\nexport function LibraryGrowthChart({ data }: LibraryGrowthChartProps) {\r\n  return (\r\n    <div className=\"h-64\">\r\n      <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n        <LineChart data={data}>\r\n          <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#374151\" />\r\n          <XAxis \r\n            dataKey=\"date\" \r\n            stroke=\"#9CA3AF\"\r\n            fontSize={12}\r\n            tickFormatter={(value) => new Date(value).toLocaleDateString()}\r\n          />\r\n          <YAxis stroke=\"#9CA3AF\" fontSize={12} />\r\n          <Tooltip\r\n            contentStyle={{\r\n              backgroundColor: '#1F2937',\r\n              border: '1px solid #374151',\r\n              borderRadius: '8px',\r\n              color: '#F9FAFB'\r\n            }}\r\n            labelFormatter={(value) => `Date: ${new Date(value).toLocaleDateString()}`}\r\n            formatter={(value: number, name: string) => [\r\n              value,\r\n              name === 'totalTracks' ? 'Total Tracks' : 'Tracks Added'\r\n            ]}\r\n          />\r\n          <Line \r\n            type=\"monotone\" \r\n            dataKey=\"totalTracks\" \r\n            stroke=\"#3B82F6\" \r\n            strokeWidth={2}\r\n            dot={{ fill: '#3B82F6', strokeWidth: 2, r: 4 }}\r\n          />\r\n          <Line \r\n            type=\"monotone\" \r\n            dataKey=\"tracksAdded\" \r\n            stroke=\"#10B981\" \r\n            strokeWidth={2}\r\n            dot={{ fill: '#10B981', strokeWidth: 2, r: 4 }}\r\n          />\r\n        </LineChart>\r\n      </ResponsiveContainer>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":";;;;;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAFA;;;AASO,SAAS,mBAAmB,EAAE,IAAI,EAA2B;IAClE,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC,6LAAmB;YAAC,OAAM;YAAO,QAAO;sBACvC,cAAA,6LAAC,qKAAS;gBAAC,MAAM;;kCACf,6LAAC,iLAAa;wBAAC,iBAAgB;wBAAM,QAAO;;;;;;kCAC5C,6LAAC,iKAAK;wBACJ,SAAQ;wBACR,QAAO;wBACP,UAAU;wBACV,eAAe,CAAC,QAAU,IAAI,KAAK,OAAO,kBAAkB;;;;;;kCAE9D,6LAAC,iKAAK;wBAAC,QAAO;wBAAU,UAAU;;;;;;kCAClC,6LAAC,qKAAO;wBACN,cAAc;4BACZ,iBAAiB;4BACjB,QAAQ;4BACR,cAAc;4BACd,OAAO;wBACT;wBACA,gBAAgB,CAAC,QAAU,CAAC,MAAM,EAAE,IAAI,KAAK,OAAO,kBAAkB,IAAI;wBAC1E,WAAW,CAAC,OAAe,OAAiB;gCAC1C;gCACA,SAAS,gBAAgB,iBAAiB;6BAC3C;;;;;;kCAEH,6LAAC,+JAAI;wBACH,MAAK;wBACL,SAAQ;wBACR,QAAO;wBACP,aAAa;wBACb,KAAK;4BAAE,MAAM;4BAAW,aAAa;4BAAG,GAAG;wBAAE;;;;;;kCAE/C,6LAAC,+JAAI;wBACH,MAAK;wBACL,SAAQ;wBACR,QAAO;wBACP,aAAa;wBACb,KAAK;4BAAE,MAAM;4BAAW,aAAa;4BAAG,GAAG;wBAAE;;;;;;;;;;;;;;;;;;;;;;AAMzD;KA5CgB"}},
    {"offset": {"line": 8158, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/components/ui/TopTracksTable.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { TrackMetadata } from '@/lib/types/music'\r\nimport { formatDuration, formatPlayCount, formatRating, formatRelativeDate } from '@/lib/utils/format'\r\n\r\ninterface TopTracksTableProps {\r\n  tracks: TrackMetadata[]\r\n  metric: 'playCount' | 'rating' | 'lastPlayed'\r\n}\r\n\r\nexport function TopTracksTable({ tracks, metric }: TopTracksTableProps) {\r\n  const formatMetricValue = (track: TrackMetadata) => {\r\n    switch (metric) {\r\n      case 'playCount':\r\n        return formatPlayCount(track.playCount)\r\n      case 'rating':\r\n        return formatRating(track.rating)\r\n      case 'lastPlayed':\r\n        return track.lastPlayed ? formatRelativeDate(track.lastPlayed) : 'Never'\r\n      default:\r\n        return ''\r\n    }\r\n  }\r\n\r\n  if (tracks.length === 0) {\r\n    return (\r\n      <div className=\"text-center py-8 text-gray-400\">\r\n        No tracks available\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-2\">\r\n      {tracks.slice(0, 10).map((track, index) => (\r\n        <div key={track.id} className=\"flex items-center gap-3 p-2 hover:bg-gray-700 rounded-lg transition-colors\">\r\n          <div className=\"w-6 text-center text-gray-400 text-sm font-medium\">\r\n            {index + 1}\r\n          </div>\r\n          <div className=\"flex-1 min-w-0\">\r\n            <div className=\"text-white text-sm font-medium truncate\">\r\n              {track.title}\r\n            </div>\r\n            <div className=\"text-gray-400 text-xs truncate\">\r\n              {track.artist}\r\n            </div>\r\n          </div>\r\n          <div className=\"text-gray-400 text-xs\">\r\n            {formatMetricValue(track)}\r\n          </div>\r\n        </div>\r\n      ))}\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":";;;;;AAGA;AAHA;;;AAUO,SAAS,eAAe,EAAE,MAAM,EAAE,MAAM,EAAuB;IACpE,MAAM,oBAAoB,CAAC;QACzB,OAAQ;YACN,KAAK;gBACH,OAAO,IAAA,mJAAe,EAAC,MAAM,SAAS;YACxC,KAAK;gBACH,OAAO,IAAA,gJAAY,EAAC,MAAM,MAAM;YAClC,KAAK;gBACH,OAAO,MAAM,UAAU,GAAG,IAAA,sJAAkB,EAAC,MAAM,UAAU,IAAI;YACnE;gBACE,OAAO;QACX;IACF;IAEA,IAAI,OAAO,MAAM,KAAK,GAAG;QACvB,qBACE,6LAAC;YAAI,WAAU;sBAAiC;;;;;;IAIpD;IAEA,qBACE,6LAAC;QAAI,WAAU;kBACZ,OAAO,KAAK,CAAC,GAAG,IAAI,GAAG,CAAC,CAAC,OAAO,sBAC/B,6LAAC;gBAAmB,WAAU;;kCAC5B,6LAAC;wBAAI,WAAU;kCACZ,QAAQ;;;;;;kCAEX,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;0CACZ,MAAM,KAAK;;;;;;0CAEd,6LAAC;gCAAI,WAAU;0CACZ,MAAM,MAAM;;;;;;;;;;;;kCAGjB,6LAAC;wBAAI,WAAU;kCACZ,kBAAkB;;;;;;;eAbb,MAAM,EAAE;;;;;;;;;;AAmB1B;KA5CgB"}},
    {"offset": {"line": 8258, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/components/views/AnalyticsView.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useMemo } from 'react'\r\nimport { useMusicStore } from '@/lib/store/music-store'\r\nimport { analyticsService } from '@/lib/services/analytics-service'\r\nimport { StatsCard } from '@/components/ui/StatsCard'\r\nimport { GenreChart } from '@/components/charts/GenreChart'\r\nimport { ListeningPatternsChart } from '@/components/charts/ListeningPatternsChart'\r\nimport { LibraryGrowthChart } from '@/components/charts/LibraryGrowthChart'\r\nimport { TopTracksTable } from '@/components/ui/TopTracksTable'\r\nimport { EmptyState } from '@/components/ui/EmptyState'\r\nimport { BarChart3, Music, Users, Clock, Star } from 'lucide-react'\r\nimport { formatDuration, formatFileSize } from '@/lib/utils/format'\r\n\r\nexport function AnalyticsView() {\r\n  const { tracks, listeningEvents, libraryStats } = useMusicStore()\r\n\r\n  const analytics = useMemo(() => {\r\n    if (tracks.length === 0) return null\r\n    \r\n    return {\r\n      genreDistribution: analyticsService.calculateGenreDistribution(tracks),\r\n      artistStats: analyticsService.calculateArtistStats(tracks),\r\n      listeningPatterns: analyticsService.analyzeListeningPatterns(listeningEvents),\r\n      libraryGrowth: analyticsService.calculateLibraryGrowth(tracks),\r\n      playbackStats: analyticsService.calculatePlaybackStats(listeningEvents),\r\n      topTracks: {\r\n        mostPlayed: analyticsService.getTopTracks(tracks, 'playCount'),\r\n        highestRated: analyticsService.getTopTracks(tracks, 'rating'),\r\n        recent: analyticsService.getTopTracks(tracks, 'recent'),\r\n      }\r\n    }\r\n  }, [tracks, listeningEvents])\r\n\r\n  if (!analytics || tracks.length === 0) {\r\n    return (\r\n      <div className=\"flex-1 flex items-center justify-center\">\r\n        <EmptyState\r\n          icon={BarChart3}\r\n          title=\"No analytics available\"\r\n          description=\"Import music and start listening to see your analytics\"\r\n        />\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex-1 overflow-auto\">\r\n      <div className=\"p-6\">\r\n        {/* Header */}\r\n        <div className=\"mb-8\">\r\n          <h1 className=\"text-2xl font-bold text-white mb-2\">Analytics</h1>\r\n          <p className=\"text-gray-400\">Insights into your music library and listening habits</p>\r\n        </div>\r\n\r\n        {/* Stats Cards */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8\">\r\n          <StatsCard\r\n            title=\"Total Tracks\"\r\n            value={libraryStats?.totalTracks.toLocaleString() || '0'}\r\n            icon={Music}\r\n            trend={libraryStats?.recentlyAdded ? `+${libraryStats.recentlyAdded} this week` : undefined}\r\n          />\r\n          <StatsCard\r\n            title=\"Artists\"\r\n            value={libraryStats?.totalArtists.toLocaleString() || '0'}\r\n            icon={Users}\r\n          />\r\n          <StatsCard\r\n            title=\"Total Duration\"\r\n            value={formatDuration(libraryStats?.totalDuration || 0)}\r\n            icon={Clock}\r\n          />\r\n          <StatsCard\r\n            title=\"Library Size\"\r\n            value={formatFileSize(libraryStats?.totalSize || 0)}\r\n            icon={BarChart3}\r\n          />\r\n        </div>\r\n\r\n        {/* Charts Grid */}\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8\">\r\n          {/* Genre Distribution */}\r\n          <div className=\"bg-gray-800 rounded-lg p-6\">\r\n            <h3 className=\"text-lg font-semibold text-white mb-4\">Genre Distribution</h3>\r\n            <GenreChart data={analytics.genreDistribution} />\r\n          </div>\r\n\r\n          {/* Listening Patterns */}\r\n          <div className=\"bg-gray-800 rounded-lg p-6\">\r\n            <h3 className=\"text-lg font-semibold text-white mb-4\">Listening Patterns</h3>\r\n            <ListeningPatternsChart data={analytics.listeningPatterns} />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Library Growth */}\r\n        <div className=\"bg-gray-800 rounded-lg p-6 mb-8\">\r\n          <h3 className=\"text-lg font-semibold text-white mb-4\">Library Growth</h3>\r\n          <LibraryGrowthChart data={analytics.libraryGrowth} />\r\n        </div>\r\n\r\n        {/* Top Tracks Tables */}\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\r\n          <div className=\"bg-gray-800 rounded-lg p-6\">\r\n            <h3 className=\"text-lg font-semibold text-white mb-4\">Most Played</h3>\r\n            <TopTracksTable tracks={analytics.topTracks.mostPlayed} metric=\"playCount\" />\r\n          </div>\r\n\r\n          <div className=\"bg-gray-800 rounded-lg p-6\">\r\n            <h3 className=\"text-lg font-semibold text-white mb-4\">Highest Rated</h3>\r\n            <TopTracksTable tracks={analytics.topTracks.highestRated} metric=\"rating\" />\r\n          </div>\r\n\r\n          <div className=\"bg-gray-800 rounded-lg p-6\">\r\n            <h3 className=\"text-lg font-semibold text-white mb-4\">Recently Played</h3>\r\n            <TopTracksTable tracks={analytics.topTracks.recent} metric=\"lastPlayed\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8600, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/components/ui/DuplicateGroupCard.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState } from 'react'\r\nimport { DuplicateGroup, TrackMetadata } from '@/lib/types/music'\r\nimport { duplicateDetectionService } from '@/lib/services/duplicate-detection-service'\r\nimport { formatFileSize, formatBitrate, formatSimilarity } from '@/lib/utils/format'\r\nimport { Check, X, AlertTriangle } from 'lucide-react'\r\n\r\ninterface DuplicateGroupCardProps {\r\n  group: DuplicateGroup\r\n  tracks: TrackMetadata[]\r\n  onResolve: (preferredTrackId: string) => void\r\n}\r\n\r\nexport function DuplicateGroupCard({ group, tracks, onResolve }: DuplicateGroupCardProps) {\r\n  const [selectedTrackId, setSelectedTrackId] = useState<string | null>(null)\r\n  \r\n  // Safety checks\r\n  if (!group || !tracks || tracks.length === 0) {\r\n    return null\r\n  }\r\n  \r\n  const recommendation = duplicateDetectionService.getRecommendedAction(group, tracks)\r\n\r\n  const handleResolve = () => {\r\n    const trackId = selectedTrackId || recommendation.recommendedTrackId\r\n    if (trackId) {\r\n      onResolve(trackId)\r\n    }\r\n  }\r\n\r\n  if (group.resolved) {\r\n    const preferredTrack = tracks.find(t => t.id === group.preferredTrackId)\r\n    return (\r\n      <div className=\"bg-gray-800 rounded-lg p-6 border border-green-700\">\r\n        <div className=\"flex items-center gap-2 mb-4\">\r\n          <Check className=\"w-5 h-5 text-green-400\" />\r\n          <h3 className=\"text-white font-medium\">Resolved Duplicate Group</h3>\r\n          <span className=\"text-xs bg-green-900 text-green-300 px-2 py-1 rounded\">\r\n            {formatSimilarity(group.similarityScore)} similar\r\n          </span>\r\n        </div>\r\n        \r\n        {preferredTrack && (\r\n          <div className=\"text-gray-300\">\r\n            <p className=\"font-medium\">{preferredTrack.title}</p>\r\n            <p className=\"text-sm text-gray-400\">{preferredTrack.artist} - {preferredTrack.album}</p>\r\n          </div>\r\n        )}\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"bg-gray-800 rounded-lg p-6 border border-yellow-700\">\r\n      <div className=\"flex items-center justify-between mb-4\">\r\n        <div className=\"flex items-center gap-2\">\r\n          <AlertTriangle className=\"w-5 h-5 text-yellow-400\" />\r\n          <h3 className=\"text-white font-medium\">Duplicate Group</h3>\r\n          <span className=\"text-xs bg-yellow-900 text-yellow-300 px-2 py-1 rounded\">\r\n            {formatSimilarity(group.similarityScore)} similar\r\n          </span>\r\n          <span className=\"text-xs bg-gray-700 text-gray-300 px-2 py-1 rounded\">\r\n            {group.duplicateType}\r\n          </span>\r\n        </div>\r\n        \r\n        <button\r\n          onClick={handleResolve}\r\n          disabled={!selectedTrackId && !recommendation.recommendedTrackId}\r\n          className=\"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 rounded-lg text-white text-sm font-medium transition-colors\"\r\n        >\r\n          Resolve\r\n        </button>\r\n      </div>\r\n\r\n      {/* Recommendation */}\r\n      {recommendation.recommendedTrackId && (\r\n        <div className=\"mb-4 p-3 bg-blue-900/20 border border-blue-700 rounded-lg\">\r\n          <p className=\"text-blue-300 text-sm\">\r\n            <strong>Recommendation:</strong> {recommendation.reason}\r\n          </p>\r\n        </div>\r\n      )}\r\n\r\n      {/* Track List */}\r\n      <div className=\"space-y-3\">\r\n        {tracks.map((track) => (\r\n          <div\r\n            key={track.id}\r\n            className={`p-3 border rounded-lg cursor-pointer transition-colors ${\r\n              selectedTrackId === track.id\r\n                ? 'border-blue-500 bg-blue-900/20'\r\n                : recommendation.recommendedTrackId === track.id\r\n                ? 'border-green-500 bg-green-900/20'\r\n                : 'border-gray-600 hover:border-gray-500'\r\n            }`}\r\n            onClick={() => setSelectedTrackId(track.id)}\r\n          >\r\n            <div className=\"flex items-center justify-between\">\r\n              <div className=\"flex-1\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <input\r\n                    type=\"radio\"\r\n                    name={`duplicate-${group.id}`}\r\n                    checked={selectedTrackId === track.id}\r\n                    onChange={() => setSelectedTrackId(track.id)}\r\n                    className=\"text-blue-600 focus:ring-blue-500\"\r\n                  />\r\n                  <div>\r\n                    <p className=\"text-white font-medium\">{track.title}</p>\r\n                    <p className=\"text-gray-400 text-sm\">{track.artist} - {track.album}</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"text-right text-sm text-gray-400\">\r\n                <div>{formatFileSize(track.fileSize)}</div>\r\n                <div>{formatBitrate(track.bitrate)}</div>\r\n                <div>{track.playCount} plays</div>\r\n              </div>\r\n            </div>\r\n            \r\n            {recommendation.recommendedTrackId === track.id && (\r\n              <div className=\"mt-2 text-xs text-green-400\">\r\n                 Recommended\r\n              </div>\r\n            )}\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8937, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/components/ui/LoadingSpinner.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { cn } from '@/lib/utils/cn'\r\n\r\ninterface LoadingSpinnerProps {\r\n  className?: string\r\n}\r\n\r\nexport function LoadingSpinner({ className }: LoadingSpinnerProps) {\r\n  return (\r\n    <div\r\n      className={cn(\r\n        'animate-spin rounded-full border-2 border-gray-300 border-t-blue-600',\r\n        className\r\n      )}\r\n    />\r\n  )\r\n}"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAQO,SAAS,eAAe,EAAE,SAAS,EAAuB;IAC/D,qBACE,6LAAC;QACC,WAAW,IAAA,kIAAE,EACX,wEACA;;;;;;AAIR;KATgB"}},
    {"offset": {"line": 8965, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/components/views/DuplicatesView.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport { useMusicStore } from '@/lib/store/music-store'\r\nimport { duplicateDetectionService } from '@/lib/services/duplicate-detection-service'\r\nimport { DuplicateGroupCard } from '@/components/ui/DuplicateGroupCard'\r\nimport { EmptyState } from '@/components/ui/EmptyState'\r\nimport { LoadingSpinner } from '@/components/ui/LoadingSpinner'\r\nimport { Copy, Search, RefreshCw } from 'lucide-react'\r\n\r\nexport function DuplicatesView() {\r\n  const { \r\n    tracks, \r\n    duplicateGroups, \r\n    detectDuplicates, \r\n    resolveDuplicateGroup \r\n  } = useMusicStore()\r\n  \r\n  const [isScanning, setIsScanning] = useState(false)\r\n  const [filter, setFilter] = useState<'all' | 'unresolved' | 'resolved'>('unresolved')\r\n\r\n  const filteredGroups = duplicateGroups.filter(group => {\r\n    if (!group) return false\r\n    if (filter === 'unresolved') return !group.resolved\r\n    if (filter === 'resolved') return group.resolved\r\n    return true\r\n  })\r\n\r\n  const handleScanForDuplicates = async () => {\r\n    setIsScanning(true)\r\n    try {\r\n      await detectDuplicates()\r\n    } finally {\r\n      setIsScanning(false)\r\n    }\r\n  }\r\n\r\n  const handleResolveGroup = async (groupId: string, preferredTrackId: string) => {\r\n    await resolveDuplicateGroup(groupId, preferredTrackId)\r\n  }\r\n\r\n  if (tracks.length === 0) {\r\n    return (\r\n      <div className=\"flex-1 flex items-center justify-center\">\r\n        <EmptyState\r\n          icon={Copy}\r\n          title=\"No music to scan\"\r\n          description=\"Import music files first to detect duplicates\"\r\n        />\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex-1 flex flex-col\">\r\n      {/* Header */}\r\n      <div className=\"p-6 border-b border-gray-700\">\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <div>\r\n            <h1 className=\"text-2xl font-bold text-white\">Duplicate Detection</h1>\r\n            <p className=\"text-gray-400\">\r\n              {duplicateGroups.length} duplicate groups found\r\n            </p>\r\n          </div>\r\n          \r\n          <button\r\n            onClick={handleScanForDuplicates}\r\n            disabled={isScanning}\r\n            className=\"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 rounded-lg text-white font-medium transition-colors\"\r\n          >\r\n            {isScanning ? (\r\n              <LoadingSpinner className=\"w-4 h-4\" />\r\n            ) : (\r\n              <Search className=\"w-4 h-4\" />\r\n            )}\r\n            {isScanning ? 'Scanning...' : 'Scan for Duplicates'}\r\n          </button>\r\n        </div>\r\n\r\n        {/* Filter Tabs */}\r\n        <div className=\"flex gap-1 bg-gray-800 rounded-lg p-1\">\r\n          {[\r\n            { key: 'unresolved', label: 'Unresolved', count: duplicateGroups.filter(g => g && !g.resolved).length },\r\n            { key: 'resolved', label: 'Resolved', count: duplicateGroups.filter(g => g && g.resolved).length },\r\n            { key: 'all', label: 'All', count: duplicateGroups.length },\r\n          ].map((tab) => (\r\n            <button\r\n              key={tab.key}\r\n              onClick={() => setFilter(tab.key as any)}\r\n              className={`flex-1 px-4 py-2 rounded-md text-sm font-medium transition-colors ${\r\n                filter === tab.key\r\n                  ? 'bg-blue-600 text-white'\r\n                  : 'text-gray-300 hover:text-white hover:bg-gray-700'\r\n              }`}\r\n            >\r\n              {tab.label} ({tab.count})\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Content */}\r\n      <div className=\"flex-1 overflow-auto\">\r\n        {isScanning ? (\r\n          <div className=\"flex-1 flex items-center justify-center\">\r\n            <div className=\"text-center\">\r\n              <LoadingSpinner className=\"w-8 h-8 mx-auto mb-4\" />\r\n              <p className=\"text-gray-400\">Scanning for duplicates...</p>\r\n            </div>\r\n          </div>\r\n        ) : filteredGroups.length === 0 ? (\r\n          <div className=\"flex-1 flex items-center justify-center\">\r\n            <EmptyState\r\n              icon={Copy}\r\n              title={\r\n                filter === 'unresolved' \r\n                  ? \"No unresolved duplicates\" \r\n                  : filter === 'resolved'\r\n                  ? \"No resolved duplicates\"\r\n                  : \"No duplicates found\"\r\n              }\r\n              description={\r\n                duplicateGroups.length === 0\r\n                  ? \"Your library looks clean! No duplicate tracks detected.\"\r\n                  : \"Switch tabs to see other duplicate groups.\"\r\n              }\r\n              actionLabel={duplicateGroups.length === 0 ? \"Scan Again\" : undefined}\r\n              onAction={duplicateGroups.length === 0 ? handleScanForDuplicates : undefined}\r\n            />\r\n          </div>\r\n        ) : (\r\n          <div className=\"p-6 space-y-6\">\r\n            {filteredGroups.map((group) => {\r\n              if (!group || !group.trackIds) return null\r\n              \r\n              const groupTracks = tracks.filter(t => t && group.trackIds.includes(t.id))\r\n              if (groupTracks.length === 0) return null\r\n              \r\n              return (\r\n                <DuplicateGroupCard\r\n                  key={group.id}\r\n                  group={group}\r\n                  tracks={groupTracks}\r\n                  onResolve={(preferredTrackId) => handleResolveGroup(group.id, preferredTrackId)}\r\n                />\r\n              )\r\n            })}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 9233, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/components/views/SettingsView.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState } from 'react'\r\nimport { useMusicStore } from '@/lib/store/music-store'\r\nimport { analyticsService } from '@/lib/services/analytics-service'\r\nimport { Settings, Download, Trash2, RefreshCw, Database } from 'lucide-react'\r\n\r\nexport function SettingsView() {\r\n  const { tracks, listeningEvents, refreshStats } = useMusicStore()\r\n  const [isExporting, setIsExporting] = useState(false)\r\n\r\n  const handleExportData = async () => {\r\n    setIsExporting(true)\r\n    try {\r\n      const analyticsData = analyticsService.exportAnalyticsData(tracks, listeningEvents)\r\n      \r\n      const dataToExport = {\r\n        exportDate: new Date().toISOString(),\r\n        tracks: tracks.length,\r\n        listeningEvents: listeningEvents.length,\r\n        analytics: analyticsData,\r\n      }\r\n      \r\n      const blob = new Blob([JSON.stringify(dataToExport, null, 2)], {\r\n        type: 'application/json'\r\n      })\r\n      \r\n      const url = URL.createObjectURL(blob)\r\n      const a = document.createElement('a')\r\n      a.href = url\r\n      a.download = `music-library-export-${new Date().toISOString().split('T')[0]}.json`\r\n      document.body.appendChild(a)\r\n      a.click()\r\n      document.body.removeChild(a)\r\n      URL.revokeObjectURL(url)\r\n    } finally {\r\n      setIsExporting(false)\r\n    }\r\n  }\r\n\r\n  const handleClearData = async () => {\r\n    if (confirm('Are you sure you want to clear all data? This cannot be undone.')) {\r\n      // TODO: Implement clear data functionality\r\n      console.log('Clear data requested')\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex-1 overflow-auto\">\r\n      <div className=\"p-6\">\r\n        {/* Header */}\r\n        <div className=\"mb-8\">\r\n          <h1 className=\"text-2xl font-bold text-white mb-2\">Settings</h1>\r\n          <p className=\"text-gray-400\">Manage your music library and application preferences</p>\r\n        </div>\r\n\r\n        {/* Settings Sections */}\r\n        <div className=\"space-y-8\">\r\n          {/* Library Management */}\r\n          <div className=\"bg-gray-800 rounded-lg p-6\">\r\n            <h2 className=\"text-lg font-semibold text-white mb-4 flex items-center gap-2\">\r\n              <Database className=\"w-5 h-5\" />\r\n              Library Management\r\n            </h2>\r\n            \r\n            <div className=\"space-y-4\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                  <h3 className=\"text-white font-medium\">Refresh Library Stats</h3>\r\n                  <p className=\"text-gray-400 text-sm\">Recalculate library statistics and analytics</p>\r\n                </div>\r\n                <button\r\n                  onClick={refreshStats}\r\n                  className=\"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-white font-medium transition-colors\"\r\n                >\r\n                  <RefreshCw className=\"w-4 h-4\" />\r\n                  Refresh\r\n                </button>\r\n              </div>\r\n\r\n              <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                  <h3 className=\"text-white font-medium\">Export Library Data</h3>\r\n                  <p className=\"text-gray-400 text-sm\">Download your library metadata and analytics</p>\r\n                </div>\r\n                <button\r\n                  onClick={handleExportData}\r\n                  disabled={isExporting}\r\n                  className=\"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 rounded-lg text-white font-medium transition-colors\"\r\n                >\r\n                  <Download className=\"w-4 h-4\" />\r\n                  {isExporting ? 'Exporting...' : 'Export'}\r\n                </button>\r\n              </div>\r\n\r\n              <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                  <h3 className=\"text-white font-medium\">Clear All Data</h3>\r\n                  <p className=\"text-gray-400 text-sm\">Remove all tracks, playlists, and listening history</p>\r\n                </div>\r\n                <button\r\n                  onClick={handleClearData}\r\n                  className=\"flex items-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg text-white font-medium transition-colors\"\r\n                >\r\n                  <Trash2 className=\"w-4 h-4\" />\r\n                  Clear Data\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Import Settings */}\r\n          <div className=\"bg-gray-800 rounded-lg p-6\">\r\n            <h2 className=\"text-lg font-semibold text-white mb-4\">Import Settings</h2>\r\n            \r\n            <div className=\"space-y-4\">\r\n              <div>\r\n                <label className=\"block text-white font-medium mb-2\">\r\n                  Supported File Formats\r\n                </label>\r\n                <div className=\"text-gray-400 text-sm\">\r\n                  MP3, FLAC, WAV, M4A, AAC, OGG, WMA\r\n                </div>\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"flex items-center gap-2\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    defaultChecked\r\n                    className=\"rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500\"\r\n                  />\r\n                  <span className=\"text-white\">Auto-detect duplicates during import</span>\r\n                </label>\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"flex items-center gap-2\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    defaultChecked\r\n                    className=\"rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500\"\r\n                  />\r\n                  <span className=\"text-white\">Extract metadata from file tags</span>\r\n                </label>\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"flex items-center gap-2\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    className=\"rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500\"\r\n                  />\r\n                  <span className=\"text-white\">Use folder structure for metadata</span>\r\n                </label>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Performance Settings */}\r\n          <div className=\"bg-gray-800 rounded-lg p-6\">\r\n            <h2 className=\"text-lg font-semibold text-white mb-4\">Performance</h2>\r\n            \r\n            <div className=\"space-y-4\">\r\n              <div>\r\n                <label className=\"block text-white font-medium mb-2\">\r\n                  Virtual List Item Height\r\n                </label>\r\n                <select className=\"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white\">\r\n                  <option value=\"compact\">Compact (48px)</option>\r\n                  <option value=\"normal\" selected>Normal (64px)</option>\r\n                  <option value=\"comfortable\">Comfortable (80px)</option>\r\n                </select>\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"flex items-center gap-2\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    defaultChecked\r\n                    className=\"rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500\"\r\n                  />\r\n                  <span className=\"text-white\">Enable virtualized scrolling</span>\r\n                </label>\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"flex items-center gap-2\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    defaultChecked\r\n                    className=\"rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500\"\r\n                  />\r\n                  <span className=\"text-white\">Use Web Workers for background processing</span>\r\n                </label>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* About */}\r\n          <div className=\"bg-gray-800 rounded-lg p-6\">\r\n            <h2 className=\"text-lg font-semibold text-white mb-4\">About</h2>\r\n            \r\n            <div className=\"space-y-2 text-gray-400\">\r\n              <p><strong className=\"text-white\">Music Library Intelligence</strong></p>\r\n              <p>Version 1.0.0</p>\r\n              <p>A fully offline music library management application</p>\r\n              <p>Built with Next.js, TailwindCSS, and Zustand</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 9890, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/components/layout/MainContent.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useMusicStore } from '@/lib/store/music-store'\r\nimport { LibraryView } from '@/components/views/LibraryView'\r\nimport { PlaylistsView } from '@/components/views/PlaylistsView'\r\nimport { AnalyticsView } from '@/components/views/AnalyticsView'\r\nimport { DuplicatesView } from '@/components/views/DuplicatesView'\r\nimport { SettingsView } from '@/components/views/SettingsView'\r\n\r\nexport function MainContent() {\r\n  const { viewState } = useMusicStore()\r\n\r\n  const renderView = () => {\r\n    switch (viewState.currentView) {\r\n      case 'library':\r\n        return <LibraryView />\r\n      case 'playlists':\r\n        return <PlaylistsView />\r\n      case 'analytics':\r\n        return <AnalyticsView />\r\n      case 'duplicates':\r\n        return <DuplicatesView />\r\n      case 'settings':\r\n        return <SettingsView />\r\n      default:\r\n        return <LibraryView />\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex-1 flex flex-col bg-gray-900\">\r\n      {renderView()}\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAPA;;;;;;;AASO,SAAS;;IACd,MAAM,EAAE,SAAS,EAAE,GAAG,IAAA,yJAAa;IAEnC,MAAM,aAAa;QACjB,OAAQ,UAAU,WAAW;YAC3B,KAAK;gBACH,qBAAO,6LAAC,4JAAW;;;;;YACrB,KAAK;gBACH,qBAAO,6LAAC,gKAAa;;;;;YACvB,KAAK;gBACH,qBAAO,6LAAC,gKAAa;;;;;YACvB,KAAK;gBACH,qBAAO,6LAAC,kKAAc;;;;;YACxB,KAAK;gBACH,qBAAO,6LAAC,8JAAY;;;;;YACtB;gBACE,qBAAO,6LAAC,4JAAW;;;;;QACvB;IACF;IAEA,qBACE,6LAAC;QAAI,WAAU;kBACZ;;;;;;AAGP;GAzBgB;;QACQ,yJAAa;;;KADrB"}},
    {"offset": {"line": 9977, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/lib/services/metadata-service.ts"],"sourcesContent":["import { TrackMetadata } from '@/lib/types/music'\r\nimport { parseBlob } from 'music-metadata-browser'\r\n\r\nclass MetadataService {\r\n  // Extract metadata from audio file using music-metadata-browser\r\n  async extractMetadata(file: File): Promise<Partial<TrackMetadata>> {\r\n    try {\r\n      // Use music-metadata-browser to parse the audio file\r\n      const metadata = await parseBlob(file)\r\n      \r\n      return this.normalizeMetadata(metadata, file)\r\n    } catch (error) {\r\n      console.error('Failed to extract metadata from', file.name, ':', error)\r\n      return await this.createFallbackMetadata(file)\r\n    }\r\n  }\r\n\r\n  // Normalize and clean metadata from music-metadata-browser\r\n  private async normalizeMetadata(metadata: any, file: File): Promise<Partial<TrackMetadata>> {\r\n    const now = new Date()\r\n    const fileExtension = file.name.split('.').pop()?.toLowerCase() || 'unknown'\r\n    \r\n    // Extract common metadata fields\r\n    const common = metadata.common || {}\r\n    const format = metadata.format || {}\r\n    \r\n    return {\r\n      id: crypto.randomUUID(),\r\n      title: this.normalizeString(common.title || this.extractTitleFromFilename(file.name)),\r\n      artist: this.normalizeString(common.artist || common.albumartist || 'Unknown Artist'),\r\n      album: this.normalizeString(common.album || 'Unknown Album'),\r\n      genre: common.genre && common.genre.length > 0 ? this.normalizeString(common.genre[0]) : undefined,\r\n      year: common.year || common.date ? parseInt(String(common.year || common.date)) : undefined,\r\n      trackNumber: common.track?.no || undefined,\r\n      discNumber: common.disk?.no || undefined,\r\n      duration: format.duration ? Math.round(format.duration) : 0,\r\n      bitrate: format.bitrate ? Math.round(format.bitrate / 1000) : undefined, // Convert to kbps\r\n      fileSize: file.size,\r\n      filePath: file.name,\r\n      fileFormat: fileExtension,\r\n      fileHash: await this.calculateFileHash(file),\r\n      dateAdded: now,\r\n      dateModified: new Date(file.lastModified),\r\n      playCount: 0,\r\n      customTags: [],\r\n      // Additional metadata that might be available\r\n      mood: common.mood || undefined,\r\n    }\r\n  }\r\n\r\n  // Create fallback metadata when extraction fails\r\n  private async createFallbackMetadata(file: File): Promise<Partial<TrackMetadata>> {\r\n    const now = new Date()\r\n    const fileExtension = file.name.split('.').pop()?.toLowerCase() || 'unknown'\r\n    \r\n    // Try to extract metadata from filename and path\r\n    const pathMetadata = this.extractMetadataFromPath(file.name)\r\n    \r\n    return {\r\n      id: crypto.randomUUID(),\r\n      title: pathMetadata.title || this.extractTitleFromFilename(file.name),\r\n      artist: pathMetadata.artist || 'Unknown Artist',\r\n      album: pathMetadata.album || 'Unknown Album',\r\n      genre: pathMetadata.genre,\r\n      year: pathMetadata.year,\r\n      duration: 0,\r\n      fileSize: file.size,\r\n      filePath: file.name,\r\n      fileFormat: fileExtension,\r\n      fileHash: await this.calculateFileHash(file),\r\n      dateAdded: now,\r\n      dateModified: new Date(file.lastModified),\r\n      playCount: 0,\r\n      customTags: [],\r\n    }\r\n  }\r\n\r\n  // Normalize string values (trim, fix casing, etc.)\r\n  private normalizeString(value: string): string {\r\n    if (!value) return ''\r\n    \r\n    return value\r\n      .trim()\r\n      .replace(/\\s+/g, ' ') // Normalize whitespace\r\n      .replace(/^\\w/, c => c.toUpperCase()) // Capitalize first letter\r\n  }\r\n\r\n  // Extract title from filename\r\n  private extractTitleFromFilename(filename: string): string {\r\n    // Remove extension\r\n    let title = filename.replace(/\\.[^/.]+$/, '')\r\n    \r\n    // Remove track numbers (e.g., \"01 - Song Title\" -> \"Song Title\")\r\n    title = title.replace(/^\\d+\\s*[-.\\s]\\s*/, '')\r\n    \r\n    // If filename contains \" - \", assume format is \"Artist - Title\"\r\n    const parts = title.split(' - ')\r\n    if (parts.length >= 2) {\r\n      return parts[parts.length - 1].trim() // Take the last part as title\r\n    }\r\n    \r\n    return title\r\n  }\r\n\r\n  // Extract metadata from file path structure\r\n  extractMetadataFromPath(filePath: string): Partial<TrackMetadata> {\r\n    const pathParts = filePath.split(/[/\\\\]/)\r\n    const metadata: Partial<TrackMetadata> = {}\r\n    const filename = pathParts[pathParts.length - 1]\r\n    \r\n    // Try to parse filename patterns\r\n    // Pattern 1: \"Artist - Title.ext\"\r\n    let match = filename.match(/^(.+?)\\s*-\\s*(.+?)\\.[^.]+$/)\r\n    if (match) {\r\n      metadata.artist = this.normalizeString(match[1])\r\n      metadata.title = this.normalizeString(match[2])\r\n      return metadata\r\n    }\r\n    \r\n    // Pattern 2: \"Track# Artist - Title.ext\"\r\n    match = filename.match(/^\\d+\\s*[-.\\s]\\s*(.+?)\\s*-\\s*(.+?)\\.[^.]+$/)\r\n    if (match) {\r\n      metadata.artist = this.normalizeString(match[1])\r\n      metadata.title = this.normalizeString(match[2])\r\n      return metadata\r\n    }\r\n    \r\n    // Pattern 3: \"Track# Title.ext\"\r\n    match = filename.match(/^\\d+\\s*[-.\\s]\\s*(.+?)\\.[^.]+$/)\r\n    if (match) {\r\n      metadata.title = this.normalizeString(match[1])\r\n      return metadata\r\n    }\r\n    \r\n    // Common directory patterns:\r\n    // Artist/Album/Track.ext or Genre/Artist/Album/Track.ext\r\n    if (pathParts.length >= 3) {\r\n      const albumDir = pathParts[pathParts.length - 2]\r\n      const artistDir = pathParts[pathParts.length - 3]\r\n      \r\n      // Check if directory names look like metadata (not years or generic folders)\r\n      if (!albumDir.match(/^\\d{4}$/) && albumDir !== 'Unknown Album' && albumDir.length > 0) {\r\n        metadata.album = this.normalizeString(albumDir)\r\n      }\r\n      \r\n      if (!artistDir.match(/^\\d{4}$/) && artistDir !== 'Unknown Artist' && artistDir.length > 0) {\r\n        metadata.artist = this.normalizeString(artistDir)\r\n      }\r\n    }\r\n    \r\n    return metadata\r\n  }\r\n\r\n  // Calculate file hash for duplicate detection\r\n  private async calculateFileHash(file: File): Promise<string> {\r\n    try {\r\n      // For performance, hash only the first 64KB of the file\r\n      const chunkSize = 64 * 1024 // 64KB\r\n      const chunk = file.slice(0, Math.min(chunkSize, file.size))\r\n      const buffer = await chunk.arrayBuffer()\r\n      const hashBuffer = await crypto.subtle.digest('SHA-256', buffer)\r\n      const hashArray = Array.from(new Uint8Array(hashBuffer))\r\n      return hashArray.map(b => b.toString(16).padStart(2, '0')).join('')\r\n    } catch (error) {\r\n      console.error('Failed to calculate file hash:', error)\r\n      // Fallback: use file size, name, and modification time as pseudo-hash\r\n      return `${file.size}-${file.name.length}-${file.lastModified}`\r\n    }\r\n  }\r\n\r\n  // Batch process multiple files with progress tracking\r\n  async extractMetadataFromFiles(\r\n    files: File[],\r\n    onProgress?: (processed: number, total: number, currentFile: string) => void\r\n  ): Promise<Partial<TrackMetadata>[]> {\r\n    const results: Partial<TrackMetadata>[] = []\r\n    \r\n    for (let i = 0; i < files.length; i++) {\r\n      const file = files[i]\r\n      \r\n      if (onProgress) {\r\n        onProgress(i, files.length, file.name)\r\n      }\r\n      \r\n      try {\r\n        const metadata = await this.extractMetadata(file)\r\n        results.push(metadata)\r\n      } catch (error) {\r\n        console.error(`Failed to process ${file.name}:`, error)\r\n        // Add fallback metadata for failed files\r\n        results.push(await this.createFallbackMetadata(file))\r\n      }\r\n      \r\n      // Add a small delay to prevent blocking the UI\r\n      if (i % 10 === 0) {\r\n        await new Promise(resolve => setTimeout(resolve, 1))\r\n      }\r\n    }\r\n    \r\n    if (onProgress) {\r\n      onProgress(files.length, files.length, '')\r\n    }\r\n    \r\n    return results\r\n  }\r\n\r\n  // Validate and clean existing metadata\r\n  validateAndCleanMetadata(track: TrackMetadata): TrackMetadata {\r\n    return {\r\n      ...track,\r\n      title: this.normalizeString(track.title || 'Unknown Title'),\r\n      artist: this.normalizeString(track.artist || 'Unknown Artist'),\r\n      album: this.normalizeString(track.album || 'Unknown Album'),\r\n      genre: track.genre ? this.normalizeString(track.genre) : undefined,\r\n      year: track.year && track.year > 1900 && track.year <= new Date().getFullYear() ? track.year : undefined,\r\n      trackNumber: track.trackNumber && track.trackNumber > 0 ? track.trackNumber : undefined,\r\n      discNumber: track.discNumber && track.discNumber > 0 ? track.discNumber : undefined,\r\n      rating: track.rating && track.rating >= 0 && track.rating <= 5 ? track.rating : undefined,\r\n      customTags: track.customTags.filter(tag => tag.trim().length > 0),\r\n    }\r\n  }\r\n\r\n  // Merge metadata from multiple sources\r\n  mergeMetadata(primary: Partial<TrackMetadata>, secondary: Partial<TrackMetadata>): Partial<TrackMetadata> {\r\n    return {\r\n      ...secondary,\r\n      ...primary,\r\n      // Special handling for arrays\r\n      customTags: [\r\n        ...(primary.customTags || []),\r\n        ...(secondary.customTags || [])\r\n      ].filter((tag, index, array) => array.indexOf(tag) === index), // Remove duplicates\r\n    }\r\n  }\r\n\r\n  // Get supported audio file extensions\r\n  getSupportedExtensions(): string[] {\r\n    return ['.mp3', '.flac', '.wav', '.m4a', '.aac', '.ogg', '.wma', '.opus', '.webm']\r\n  }\r\n\r\n  // Check if file is supported audio format\r\n  isSupportedAudioFile(file: File): boolean {\r\n    const extension = '.' + file.name.split('.').pop()?.toLowerCase()\r\n    return this.getSupportedExtensions().includes(extension)\r\n  }\r\n\r\n  // Get detailed format information\r\n  async getDetailedFormat(file: File): Promise<any> {\r\n    try {\r\n      const metadata = await parseBlob(file)\r\n      return {\r\n        format: metadata.format,\r\n        quality: metadata.quality,\r\n        native: metadata.native,\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to get detailed format:', error)\r\n      return null\r\n    }\r\n  }\r\n}\r\n\r\nexport const metadataService = new MetadataService()"],"names":[],"mappings":"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"}},
    {"offset": {"line": 10223, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/components/modals/ImportModal.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useRef } from 'react'\r\nimport { useMusicStore } from '@/lib/store/music-store'\r\nimport { metadataService } from '@/lib/services/metadata-service'\r\nimport { X, Upload, FileMusic, AlertCircle } from 'lucide-react'\r\nimport { LoadingSpinner } from '@/components/ui/LoadingSpinner'\r\n\r\nexport function ImportModal() {\r\n  const { \r\n    showImportModal, \r\n    toggleImportModal, \r\n    importProgress, \r\n    startImport, \r\n    updateImportProgress, \r\n    addTracks \r\n  } = useMusicStore()\r\n  \r\n  const [dragActive, setDragActive] = useState(false)\r\n  const fileInputRef = useRef<HTMLInputElement>(null)\r\n\r\n  const handleFiles = async (files: FileList) => {\r\n    const audioFiles = Array.from(files).filter(file => \r\n      metadataService.isSupportedAudioFile(file)\r\n    )\r\n\r\n    if (audioFiles.length === 0) {\r\n      alert('No supported audio files found. Please select MP3, FLAC, WAV, M4A, AAC, OGG, WMA, OPUS, or WEBM files.')\r\n      return\r\n    }\r\n\r\n    startImport()\r\n    updateImportProgress({\r\n      totalFiles: audioFiles.length,\r\n      processedFiles: 0,\r\n      currentFile: '',\r\n      errors: [],\r\n    })\r\n\r\n    try {\r\n      const trackMetadata = await metadataService.extractMetadataFromFiles(\r\n        audioFiles,\r\n        (processed, total, currentFile) => {\r\n          updateImportProgress({\r\n            processedFiles: processed,\r\n            currentFile,\r\n          })\r\n        }\r\n      )\r\n\r\n      // Filter out any failed extractions and validate metadata\r\n      const validTracks = trackMetadata\r\n        .filter(track => track.id)\r\n        .map(track => metadataService.validateAndCleanMetadata(track as any))\r\n      \r\n      if (validTracks.length > 0) {\r\n        await addTracks(validTracks)\r\n      }\r\n\r\n      const failedCount = audioFiles.length - validTracks.length\r\n      if (failedCount > 0) {\r\n        updateImportProgress({\r\n          errors: [`${failedCount} files could not be processed`],\r\n        })\r\n      }\r\n\r\n      updateImportProgress({\r\n        isImporting: false,\r\n        currentFile: '',\r\n      })\r\n\r\n      // Close modal after successful import\r\n      setTimeout(() => {\r\n        toggleImportModal()\r\n      }, 2000)\r\n\r\n    } catch (error) {\r\n      console.error('Import failed:', error)\r\n      updateImportProgress({\r\n        isImporting: false,\r\n        errors: ['Import failed. Please try again.'],\r\n      })\r\n    }\r\n  }\r\n\r\n  const handleDrag = (e: React.DragEvent) => {\r\n    e.preventDefault()\r\n    e.stopPropagation()\r\n    if (e.type === 'dragenter' || e.type === 'dragover') {\r\n      setDragActive(true)\r\n    } else if (e.type === 'dragleave') {\r\n      setDragActive(false)\r\n    }\r\n  }\r\n\r\n  const handleDrop = (e: React.DragEvent) => {\r\n    e.preventDefault()\r\n    e.stopPropagation()\r\n    setDragActive(false)\r\n    \r\n    if (e.dataTransfer.files && e.dataTransfer.files.length > 0) {\r\n      handleFiles(e.dataTransfer.files)\r\n    }\r\n  }\r\n\r\n  const handleFileSelect = () => {\r\n    fileInputRef.current?.click()\r\n  }\r\n\r\n  if (!showImportModal) return null\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between mb-6\">\r\n          <h2 className=\"text-xl font-semibold text-white\">Import Music</h2>\r\n          <button\r\n            onClick={toggleImportModal}\r\n            disabled={importProgress.isImporting}\r\n            className=\"text-gray-400 hover:text-white disabled:opacity-50\"\r\n          >\r\n            <X className=\"w-6 h-6\" />\r\n          </button>\r\n        </div>\r\n\r\n        {/* Content */}\r\n        {importProgress.isImporting ? (\r\n          <div className=\"text-center py-8\">\r\n            <LoadingSpinner className=\"w-8 h-8 mx-auto mb-4\" />\r\n            <p className=\"text-white mb-2\">\r\n              Processing {importProgress.processedFiles} of {importProgress.totalFiles} files\r\n            </p>\r\n            {importProgress.currentFile && (\r\n              <p className=\"text-gray-400 text-sm truncate\">\r\n                {importProgress.currentFile}\r\n              </p>\r\n            )}\r\n            <div className=\"w-full bg-gray-700 rounded-full h-2 mt-4\">\r\n              <div\r\n                className=\"bg-blue-600 h-2 rounded-full transition-all duration-300\"\r\n                style={{\r\n                  width: `${(importProgress.processedFiles / importProgress.totalFiles) * 100}%`\r\n                }}\r\n              />\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          <>\r\n            {/* Drop Zone */}\r\n            <div\r\n              onDragEnter={handleDrag}\r\n              onDragLeave={handleDrag}\r\n              onDragOver={handleDrag}\r\n              onDrop={handleDrop}\r\n              className={`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${\r\n                dragActive\r\n                  ? 'border-blue-500 bg-blue-500/10'\r\n                  : 'border-gray-600 hover:border-gray-500'\r\n              }`}\r\n            >\r\n              <FileMusic className=\"w-12 h-12 mx-auto text-gray-400 mb-4\" />\r\n              <p className=\"text-white mb-2\">\r\n                Drag and drop your music files here\r\n              </p>\r\n              <p className=\"text-gray-400 text-sm mb-4\">\r\n                or click to browse files\r\n              </p>\r\n              <button\r\n                onClick={handleFileSelect}\r\n                className=\"px-6 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-white font-medium transition-colors\"\r\n              >\r\n                <Upload className=\"w-4 h-4 inline mr-2\" />\r\n                Choose Files\r\n              </button>\r\n            </div>\r\n\r\n            {/* Supported Formats */}\r\n            <div className=\"mt-4 text-center\">\r\n              <p className=\"text-gray-400 text-sm\">\r\n                Supported formats: MP3, FLAC, WAV, M4A, AAC, OGG, WMA, OPUS, WEBM\r\n              </p>\r\n            </div>\r\n\r\n            {/* Errors */}\r\n            {importProgress.errors.length > 0 && (\r\n              <div className=\"mt-4 p-3 bg-red-900/20 border border-red-700 rounded-lg\">\r\n                <div className=\"flex items-center gap-2 text-red-400 mb-2\">\r\n                  <AlertCircle className=\"w-4 h-4\" />\r\n                  <span className=\"font-medium\">Import Errors</span>\r\n                </div>\r\n                <ul className=\"text-red-300 text-sm space-y-1\">\r\n                  {importProgress.errors.map((error, index) => (\r\n                    <li key={index}>{error}</li>\r\n                  ))}\r\n                </ul>\r\n              </div>\r\n            )}\r\n          </>\r\n        )}\r\n\r\n        {/* Hidden File Input */}\r\n        <input\r\n          ref={fileInputRef}\r\n          type=\"file\"\r\n          multiple\r\n          accept=\".mp3,.flac,.wav,.m4a,.aac,.ogg,.wma,.opus,.webm\"\r\n          onChange={(e) => e.target.files && handleFiles(e.target.files)}\r\n          className=\"hidden\"\r\n        />\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 10572, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/components/ui/LoadingScreen.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { LoadingSpinner } from './LoadingSpinner'\r\n\r\nexport function LoadingScreen() {\r\n  return (\r\n    <div className=\"h-screen bg-gray-900 flex items-center justify-center\">\r\n      <div className=\"text-center\">\r\n        <LoadingSpinner className=\"w-12 h-12 mx-auto mb-4 text-blue-500\" />\r\n        <h2 className=\"text-xl font-semibold text-white mb-2\">Loading Music Library</h2>\r\n        <p className=\"text-gray-400\">Initializing your music collection...</p>\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAIO,SAAS;IACd,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC,+JAAc;oBAAC,WAAU;;;;;;8BAC1B,6LAAC;oBAAG,WAAU;8BAAwC;;;;;;8BACtD,6LAAC;oBAAE,WAAU;8BAAgB;;;;;;;;;;;;;;;;;AAIrC;KAVgB"}},
    {"offset": {"line": 10632, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows%2010/OneDrive/Desktop/eagle-point/eagle-hell/main/bd_datasets_002/8qvqb3-offline-music-library/repository_after/src/app/page.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useEffect } from 'react'\r\nimport { useMusicStore } from '@/lib/store/music-store'\r\nimport { Sidebar } from '@/components/layout/Sidebar'\r\nimport { MainContent } from '@/components/layout/MainContent'\r\nimport { ImportModal } from '@/components/modals/ImportModal'\r\nimport { LoadingScreen } from '@/components/ui/LoadingScreen'\r\n\r\nexport default function HomePage() {\r\n  const { isInitialized, initialize } = useMusicStore()\r\n\r\n  useEffect(() => {\r\n    initialize()\r\n  }, [initialize])\r\n\r\n  if (!isInitialized) {\r\n    return <LoadingScreen />\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex h-screen bg-gray-900\">\r\n      <Sidebar />\r\n      <MainContent />\r\n      <ImportModal />\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAPA;;;;;;;AASe,SAAS;;IACtB,MAAM,EAAE,aAAa,EAAE,UAAU,EAAE,GAAG,IAAA,yJAAa;IAEnD,IAAA,0KAAS;8BAAC;YACR;QACF;6BAAG;QAAC;KAAW;IAEf,IAAI,CAAC,eAAe;QAClB,qBAAO,6LAAC,6JAAa;;;;;IACvB;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC,qJAAO;;;;;0BACR,6LAAC,6JAAW;;;;;0BACZ,6LAAC,6JAAW;;;;;;;;;;;AAGlB;GAlBwB;;QACgB,yJAAa;;;KAD7B"}}]
}