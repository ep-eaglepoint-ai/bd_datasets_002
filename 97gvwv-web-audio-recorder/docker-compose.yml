
services:
  web:
    build: .
    ports:
      - "8000:8000"
    volumes:
      - ./repository_after:/app/repository_after
      - ./repository_before:/app/repository_before
      - ./tests:/app/tests
      - ./evaluation:/app/evaluation
    command: python repository_after/audio_recorder.py
    environment:
      - PYTHONUNBUFFERED=1

  tests:
    build: .
    volumes:
      - ./tests:/app/tests
      - ./repository_before:/app/repository_before
      - ./repository_after:/app/repository_after
      - ./evaluation:/app/evaluation
    command: python -m pytest tests/ -v
    environment:
      - PYTHONUNBUFFERED=1

  evaluation:
    build: .
    volumes:
      - ./evaluation:/app/evaluation
      - ./tests:/app/tests
      - ./repository_before:/app/repository_before
      - ./repository_after:/app/repository_after
    command: python evaluation/evaluation.py
    environment:
      - PYTHONUNBUFFERED=1