diff --git a/repository_before/queries.sql b/repository_after/queries.sql
index 0554eec..64dbf1a 100644
--- a/repository_before/queries.sql
+++ b/repository_after/queries.sql
@@ -46,6 +46,7 @@ GROUP BY
 ORDER BY cohort, months_since_first;
 
 
+-- Query 4: Inventory Turnover
 SELECT 
     p.product_id,
     p.name,
@@ -66,6 +67,7 @@ ORDER BY turnover_rate DESC
 LIMIT 100;
 
 
+-- Query 5: Customer Lifetime Value
 SELECT 
     customer_id,
     total_spent,
@@ -84,6 +86,7 @@ FROM (
 ORDER BY percentile DESC, total_spent DESC;
 
 
+-- Query 6: Category Performance Comparison
 WITH monthly_revenue AS (
     SELECT 
         p.category_id,
@@ -107,4 +110,3 @@ JOIN monthly_revenue prev ON prev.category_id = curr.category_id
 JOIN categories c ON c.category_id = curr.category_id
 WHERE curr.month >= NOW() - INTERVAL '12 months'
 ORDER BY c.name, curr.month;
-
diff --git a/repository_before/schema.sql b/repository_after/schema.sql
index f5b4957..ab36eed 100644
--- a/repository_before/schema.sql
+++ b/repository_after/schema.sql
@@ -53,3 +53,22 @@ CREATE TABLE order_items (
     discount DECIMAL(10, 2) DEFAULT 0
 );
 
+CREATE INDEX idx_orders_date_status ON orders(order_date, status) 
+INCLUDE (total_amount, customer_id) WHERE status != 'cancelled';
+
+CREATE INDEX idx_order_items_order ON order_items(order_id) 
+INCLUDE (product_id, quantity, unit_price);
+
+CREATE INDEX idx_order_items_product ON order_items(product_id) 
+INCLUDE (order_id, quantity, unit_price);
+
+CREATE INDEX idx_products_category ON products(category_id) 
+INCLUDE (product_id, name);
+
+CREATE INDEX idx_orders_customer ON orders(customer_id, status) 
+INCLUDE (order_id, total_amount, order_date) WHERE status != 'cancelled';
+
+CREATE INDEX idx_inventory_product ON inventory(product_id) INCLUDE (quantity);
+
+CREATE INDEX idx_customers_first_purchase ON customers(first_purchase_date) 
+INCLUDE (customer_id);
diff --git a/repository_before/seed.sql b/repository_after/seed.sql
index 72e2053..af66cc2 100644
--- a/repository_before/seed.sql
+++ b/repository_after/seed.sql
@@ -24,8 +24,8 @@ FROM generate_series(1, 100000) g;
 INSERT INTO customers (email, created_at, first_purchase_date, country, segment)
 SELECT 
     'customer' || g || '@example.com',
-    NOW() - (floor(random() * 1825)::int || ' days')::interval,
-    (NOW() - (floor(random() * 1825)::int || ' days')::interval)::date,
+    NOW() - (random() * 1825 || ' days')::interval,
+    (NOW() - (random() * 1825 || ' days')::interval)::date,
     (ARRAY['US', 'UK', 'DE', 'FR', 'JP', 'AU', 'CA', 'BR', 'IN', 'MX'])[floor(random() * 10 + 1)],
     (ARRAY['retail', 'wholesale', 'vip'])[floor(random() * 3 + 1)]
 FROM generate_series(1, 2000000) g;
@@ -33,7 +33,7 @@ FROM generate_series(1, 2000000) g;
 INSERT INTO orders (customer_id, order_date, status, total_amount, discount_amount, shipping_cost, payment_method)
 SELECT 
     floor(random() * 2000000 + 1)::int,
-    NOW() - (floor(random() * 1825)::int || ' days')::interval,
+    NOW() - (random() * 1825 || ' days')::interval,
     (ARRAY['pending', 'shipped', 'delivered', 'cancelled'])[floor(random() * 4 + 1)],
     (random() * 1000 + 10)::numeric(12,2),
     (random() * 50)::numeric(10,2),
@@ -55,7 +55,6 @@ SELECT
     g,
     floor(random() * 5 + 1)::int,
     floor(random() * 1000)::int,
-    (NOW() - (floor(random() * 90)::int || ' days')::interval)::date,
+    (NOW() - (random() * 90 || ' days')::interval)::date,
     floor(random() * 50 + 5)::int
 FROM generate_series(1, 100000) g;
-
diff --git a/repository_before/seed_test.sql b/repository_before/seed_test.sql
deleted file mode 100644
index 5caa057..0000000
--- a/repository_before/seed_test.sql
+++ /dev/null
@@ -1,46 +0,0 @@
-INSERT INTO categories (name, parent_category_id) VALUES
-('Electronics', NULL),
-('Clothing', NULL),
-('Home & Garden', NULL),
-('Sports', NULL),
-('Books', NULL);
-
-INSERT INTO categories (name, parent_category_id)
-SELECT 'Subcategory ' || g || ' of ' || c.name, c.category_id
-FROM categories c, generate_series(1, 9) g
-WHERE c.parent_category_id IS NULL;
-
-INSERT INTO products (sku, name, category_id, price, cost)
-SELECT 'SKU-' || g, 'Product ' || g, (g % 50) + 1, 
-       (random() * 500 + 10)::numeric(10,2),
-       (random() * 200 + 5)::numeric(10,2)
-FROM generate_series(1, 1000) g;
-
-INSERT INTO customers (email, created_at, first_purchase_date, country, segment)
-SELECT 'customer' || g || '@test.com', 
-       NOW() - (random() * 365 || ' days')::interval,
-       (NOW() - (random() * 365 || ' days')::interval)::date,
-       'US', 'retail'
-FROM generate_series(1, 5000) g;
-
-INSERT INTO orders (customer_id, order_date, status, total_amount, discount_amount, shipping_cost, payment_method)
-SELECT 
-    (random() * 4999 + 1)::int,
-    NOW() - (random() * 365 || ' days')::interval,
-    CASE WHEN random() < 0.25 THEN 'cancelled' ELSE 'delivered' END,
-    (random() * 500 + 10)::numeric(12,2),
-    0, 10, 'credit_card'
-FROM generate_series(1, 100000) g;
-
-INSERT INTO order_items (order_id, product_id, quantity, unit_price, discount)
-SELECT 
-    (random() * 99999 + 1)::int,
-    (random() * 999 + 1)::int,
-    (random() * 3 + 1)::int,
-    (random() * 100 + 10)::numeric(10,2),
-    0
-FROM generate_series(1, 200000) g;
-
-INSERT INTO inventory (product_id, warehouse_id, quantity, last_restock_date, reorder_point)
-SELECT g, 1, (random() * 500)::int, NOW()::date, 10
-FROM generate_series(1, 1000) g;
